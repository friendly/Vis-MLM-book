<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Visualizing Multivariate Data/Models in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="book-outline-rev_files/libs/clipboard/clipboard.min.js"></script>
<script src="book-outline-rev_files/libs/quarto-html/quarto.js"></script>
<script src="book-outline-rev_files/libs/quarto-html/popper.min.js"></script>
<script src="book-outline-rev_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="book-outline-rev_files/libs/quarto-html/anchor.min.js"></script>
<link href="book-outline-rev_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="book-outline-rev_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="book-outline-rev_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="book-outline-rev_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="book-outline-rev_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Visualizing Multivariate Data/Models in R</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>This document is the working outline for the book</p>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Not quite sure what should go here …</p>
<section id="preliminaries" class="level3">
<h3 class="anchored" data-anchor-id="preliminaries">Preliminaries</h3>
<p>Maybe not a separate chapter, but list the main packages used here and datasets for examples.</p>
<ul>
<li>R packages</li>
<li>Datasets</li>
</ul>
</section>
</section>
<section id="getting-started" class="level2">
<h2 class="anchored" data-anchor-id="getting-started">Getting Started</h2>
<p>File: <code>getting_started.qmd</code></p>
<ul>
<li>Why plot your data?
<ul>
<li>Anscombe data</li>
<li>Davis data</li>
</ul></li>
<li>data plots</li>
<li>model plots</li>
<li>diagnostic plots</li>
</ul>
</section>
<section id="plots-of-multivariate-data" class="level2">
<h2 class="anchored" data-anchor-id="plots-of-multivariate-data">Plots of Multivariate Data</h2>
<p>This chapter introduces a toolbox of basic graphical methods for visualizing multivariate datasets. It starts with some some simple techniques to enhance a basic scatterplot with annotations to summarize the relation between two variables. To visualize more than two variables, we can view all pairs of variables in a scatterplot matrix for all pairs, or shift gears entirely to show multiple variables along a set of parallel axes.</p>
<ul>
<li>Bivariate summaries
<ul>
<li>smoothers</li>
<li>data ellipses</li>
</ul></li>
<li>Quantitative data:
<ul>
<li>scatterplot matrices</li>
<li>corrplots</li>
<li>parallel coordinate plots</li>
</ul></li>
<li>Categorical data:
<ul>
<li>mosaic plots</li>
</ul></li>
<li>Generalized pair plots</li>
<li>Heatmaps</li>
</ul>
</section>
<section id="dimension-reduction-techniques-pca-and-biplots" class="level2">
<h2 class="anchored" data-anchor-id="dimension-reduction-techniques-pca-and-biplots">Dimension reduction techniques: PCA and Biplots</h2>
<p>Beyond a few variables, the limitations of 2D (or even 3D) graphs become quickly apparent. In such cases, it is often profitable to view the data in a low-D space that extracts the most “juice” – the important information within the data. This chapter describes the simplest multivariate juicer, principal components analysis and its visualization in the related biplot, which shows the data and the original variables projected into a space of small dimension.</p>
<ul>
<li>PCA, the multivariate juicer</li>
<li>Biplot, a low-dimensional view</li>
</ul>
</section>
<section id="overview-of-linear-models" class="level2">
<h2 class="anchored" data-anchor-id="overview-of-linear-models">Overview of Linear Models</h2>
<p>In this chapter, I review the standard statistical methods for explaining or predicting a quantitative response using a linear model composed of quantitative and/or categorical predictors.</p>
<ul>
<li>Regression</li>
<li>ANOVA</li>
<li>ANCOVA</li>
<li>Discriminant analysis</li>
<li>Regression trees</li>
</ul>
</section>
<section id="plots-for-univariate-response-models" class="level2">
<h2 class="anchored" data-anchor-id="plots-for-univariate-response-models">Plots for univariate response models</h2>
<p>For a univariate linear model fit using <code>lm()</code>, <code>glm()</code> and similar functions, the standard <code>plot()</code> method gives basic versions of <em>diagnostic</em> plots of residuals and other calculated quantities for assessing possible violations of the model assumptions. Some of these can be considerably enhanced using other packages.</p>
<ul>
<li>the “regression quartet”</li>
<li>coefficient plots</li>
<li>marginal (effect) plots</li>
<li>diagnostic plots</li>
</ul>
</section>
<section id="collinearity-ridge-regression" class="level2">
<h2 class="anchored" data-anchor-id="collinearity-ridge-regression">Collinearity &amp; Ridge Regression</h2>
<p>This chapter focuses on the problems associated with high correlations among predictors in linear models, which can lead to numerical instability and paradoxical findings that, while a linear model can be highly predictive, few or none of the independent variables appear to be significant.</p>
<ul>
<li>visualizing multicollinearity
<ul>
<li>collinearity diagnostics</li>
<li>tableplots</li>
<li>collinearity biplots</li>
</ul></li>
<li>ridge regression – generalized ridge trace plots</li>
</ul>
</section>
<section id="hotellings-t2" class="level2">
<h2 class="anchored" data-anchor-id="hotellings-t2">Hotelling’s T^2</h2>
<p>Just as the one- and two- sample univariate <span class="math inline">\(t\)</span>-test is the gateway drug for understanding analysis of variance, so too Hotelling’s <span class="math inline">\(T^2\)</span> test provides an entry point to multivariate analysis of variance. This simple case provides an entry point to understanding the collection of methods I call the <strong>HE plot framework</strong> for visualizing effects in multivariate linear models, which are a main focus of this book.</p>
<ul>
<li><span class="math inline">\(T^2\)</span> as a generalized <span class="math inline">\(t\)</span>-test</li>
<li><span class="math inline">\(T^2\)</span> properties</li>
<li>HE plot and discriminant axis</li>
</ul>
</section>
<section id="brief-review-of-the-mlm" class="level2">
<h2 class="anchored" data-anchor-id="brief-review-of-the-mlm">Brief review of the MLM</h2>
<p>The general multivariate linear model (MLM) can be understood as a simple extension of the univariate linear model, with the main difference being that there are multiple response variables instead of just one.</p>
<ul>
<li>ANOVA -&gt; MANOVA</li>
<li>MRA -&gt; MMRA</li>
<li>ANCOVA -&gt; MANCOVA</li>
<li>Repeated measures designs</li>
</ul>
</section>
<section id="visualizing-multivariate-models" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-multivariate-models">Visualizing Multivariate Models</h2>
<ul>
<li>HEplot framework</li>
<li>Toy example</li>
<li>HE plot details
<ul>
<li>evidence vs.&nbsp;effect scaling</li>
</ul></li>
<li>Canonical discriminant analysis</li>
</ul>
</section>
<section id="case-studies" class="level2">
<h2 class="anchored" data-anchor-id="case-studies">Case studies</h2>
<ul>
<li>NeuroCog and SocialCog</li>
</ul>
<section id="manova-examples" class="level3">
<h3 class="anchored" data-anchor-id="manova-examples">MANOVA Examples</h3>
<p>This is a collection of examples of multivariate analysis of variance (MANOVA), listed here with the sources from other publications I may draw on as case studies or use in earlier chapters</p>
<ul>
<li>iris data [maybe use this earlier?]</li>
<li>parenting data [from TQMP tutorial]</li>
<li>diabetes data [from candisc vignette]</li>
<li>Neuro-Cog &amp; Social-Cog [from TQMP tutorial]</li>
</ul>
</section>
<section id="mmra-examples" class="level3">
<h3 class="anchored" data-anchor-id="mmra-examples">MMRA Examples</h3>
<ul>
<li>Rohwer data from [HE-plot-examples vignette &amp; TQMP tutorial]</li>
<li></li>
</ul>
</section>
</section>
<section id="multivariate-influence" class="level2">
<h2 class="anchored" data-anchor-id="multivariate-influence">Multivariate influence</h2>
<p>This material should go earlier …</p>
<ul>
<li>univariate influence</li>
<li>multivariate influence</li>
</ul>
</section>
<section id="visualizing-equality-of-covariance-matrices" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-equality-of-covariance-matrices">Visualizing equality of covariance matrices</h2>
<ul>
<li>Homogeneity of Variance in Univariate ANOVA</li>
<li>Homogeneity of variance in MANOVA</li>
<li>Box’s M test</li>
</ul>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>