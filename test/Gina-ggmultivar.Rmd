---
title: "another experiment"
author: "Evangeline Reynolds"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: TRUE
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(tidyverse.quiet = TRUE)
library(dplyr)
library(tidyr)
library(ggplot2)
```




## Intro Thoughts


## Status Quo

```{r}
data(peng, package = "heplots")

ggmultivar <- function(data, vars){
  
  prepped <- data |> 
    pivot_longer(cols = {{vars}})

  ggplot(data = prepped) +
     facet_wrap(~ name, scales = "free")
  
}
```

```{r}
ggmultivar(peng, 
           vars = c(bill_length, bill_depth,
                    flipper_length, body_mass)) 

last_plot() +   
  aes(x = value) + 
  geom_histogram(position = "identity") + 
  geom_rug(aes(color = species)) + 
  aes(fill = species) +
  aes(alpha = species == "Chinstrap") + 
  scale_alpha_discrete(range = c(.3, .95)) 
  
# last_plot() +
#   facetrid(sex ~ name, scales = "free")

ggmultivar(peng, 
           vars = c(bill_length, bill_depth,
                    flipper_length, body_mass)) +
  aes(y = value, x = sex) + 
  geom_boxplot()

last_plot() + 
  aes(color = species)
```


```{r}
peng |>
  select(c(1, 3:6)) |> 
  pivot_longer(cols = 2:5) |> 
  ggplot() + 
  aes(x = value) + 
  geom_histogram(alpha = .8) + 
  facet_wrap(~name, scales = "free_x") + 
  aes(fill = species)

```



