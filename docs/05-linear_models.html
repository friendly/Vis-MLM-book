<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Visualizing Multivariate Data and Models in R - 5&nbsp; Overview of Linear models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./06-linear_models-plots.html" rel="next">
<link href="./04-pca-biplot.html" rel="prev">
<link href="./images/favicon/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./05-linear_models.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Overview of Linear models</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title"><span id="sec-linear-models" class="quarto-section-identifier"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Overview of Linear models</span></span></h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Visualizing Multivariate Data and Models in R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/friendly/vis-MLM-book" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-getting_started.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Started</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-multivariate_plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Plots of Multivariate Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-pca-biplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Dimension Reduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-linear_models.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Overview of Linear models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-linear_models-plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Plots for univariate response models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-lin-mod-topics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Topics in Linear Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-collinearity-ridge.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Collinearity &amp; Ridge Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hotelling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Hotelling’s <span class="math inline">\(T^2\)</span></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm-review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Multivariate Linear Model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm-viz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Visualizing Multivariate Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./case-studies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Case studies</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eqcov.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Visualizing Tests for Equality of Covariance Matrices</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./90-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./91-colophon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Colophon</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#linear-combinations" id="toc-linear-combinations" class="nav-link active" data-scroll-target="#linear-combinations"><span class="header-section-number">5.1</span> Linear combinations</a>
  <ul class="collapse">
<li><a href="#multiple-regression" id="toc-multiple-regression" class="nav-link" data-scroll-target="#multiple-regression"><span class="header-section-number">5.1.1</span> Multiple regression</a></li>
  <li><a href="#multivariate-regression" id="toc-multivariate-regression" class="nav-link" data-scroll-target="#multivariate-regression"><span class="header-section-number">5.1.2</span> Multivariate regression</a></li>
  <li><a href="#canonical-correlation-analysis" id="toc-canonical-correlation-analysis" class="nav-link" data-scroll-target="#canonical-correlation-analysis"><span class="header-section-number">5.1.3</span> Canonical correlation analysis</a></li>
  <li><a href="#the-general-linear-model" id="toc-the-general-linear-model" class="nav-link" data-scroll-target="#the-general-linear-model"><span class="header-section-number">5.1.4</span> The General Linear Model</a></li>
  <li><a href="#model-formulas" id="toc-model-formulas" class="nav-link" data-scroll-target="#model-formulas"><span class="header-section-number">5.1.5</span> Model formulas</a></li>
  </ul>
</li>
  <li><a href="#regression" id="toc-regression" class="nav-link" data-scroll-target="#regression"><span class="header-section-number">5.2</span> Regression</a></li>
  <li><a href="#anova" id="toc-anova" class="nav-link" data-scroll-target="#anova"><span class="header-section-number">5.3</span> ANOVA</a></li>
  <li><a href="#ancova" id="toc-ancova" class="nav-link" data-scroll-target="#ancova"><span class="header-section-number">5.4</span> ANCOVA</a></li>
  <li><a href="#regression-trees" id="toc-regression-trees" class="nav-link" data-scroll-target="#regression-trees"><span class="header-section-number">5.5</span> Regression trees</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/friendly/vis-MLM-book/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content"><!--- For HTML Only ---><!-- %\renewcommand*{\det}[1]{\mathrm{det} (#1)} --><!-- %\renewcommand*{\det}[1]{|#1|} --><!-- % R stuff --><p>Although this book is primarily about multivariate models, it is useful to have an overview of the range of available techniques to see their relations and to appreciate how easily univariate response models generalize to multivariate ones. Hence, this chapter reviews the characteristics of the standard univariate methods for explaining or predicting a single outcome variable from a set of predictors.</p>
<p>The key ideas are:</p>
<ul>
<li><p>For a single quantitative outcome variable <span class="math inline">\(\mathbf{y}\)</span>, methods of linear regression and analysis of variance (ANOVA) are comprised within a single framework of the <strong>general linear model</strong> (GLM). Regression and ANOVA differ only in that the predictors in the former are quantitative, while those in the latter are discrete factors. They can all be fit using <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>.</p></li>
<li><p>These models extend directly to the multivariate case of <span class="math inline">\(q &gt; 1\)</span> outcomes, <span class="math inline">\(\mathbf{Y} = (\mathbf{y}_1, \mathbf{y}_2, \dots \mathbf{y}_q)\)</span>, and are also fit using <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>.</p></li>
<li><p>A binary outcome <span class="math inline">\(y = (0, 1)\)</span> and categorical outcomes like marital status (“never married”, “married”, “separated”, “divorced”) can be handled within a different extension, the <strong>generalized</strong> linear model as logistic regression or multinomial regression, fit using <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code>.</p></li>
<li><p>All of these models involve linear combinations of predictors (weighted sums) fit to optimize some criterion, for example minimizing some function of the residuals or maximizing some measure of fit.</p></li>
<li><p>Models and data can be more easily understood with graphics, and many statistical ideas have a visual representation in geometry.</p></li>
</ul>
<p><a href="#fig-techniques">Figure&nbsp;<span>5.1</span></a> summarizes a variety of methods for linear models, classified by number of predictors and number of response variables, and whether these are quantitative vs.&nbsp;discrete. For the present purposes, the key columns are the first two, for the case of one or more quantitative outcome variables.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-techniques" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/techniques-table.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;5.1: Techniques for linear models classified by number of predictors and number of response variables, and whether these are quantitative vs.&nbsp;discrete</figcaption></figure>
</div>
</div>
</div>
<p>when the predictors are also quantitative, simple regression (<span class="math inline">\(p=1\)</span>) generalizes to multivariate regression with two or more outcomes, for example predicting weight and body mass index jointly from a person’s height. The situation is more interesting when there are <span class="math inline">\(p&gt;1\)</span> predictors. The most common multivariate generalization is multivariate multiple regression (MMRA), where each outcome is regressed on the predictors, as if done separately for each outcome, but using multivariate tests that take correlations among the predictors into account. Other methods for this case include canonical correlation analysis, which tries to explain all relations between <span class="math inline">\(\mathbf{Y}\)</span> and a set of <span class="math inline">\(\mathbf{x}\)</span>s through maximally correlated linear combinations of each.</p>
<p>When the predictor variables are all categorical, like gender or level of education, methods like the simple <span class="math inline">\(t\)</span>-test, one-way ANOVA and factorial ANOVA with <span class="math inline">\(q=1\)</span> outcome measures all have simple extensions to the case of <span class="math inline">\(q&gt;1\)</span> outcomes.</p>
<p>Not shown in <a href="#fig-techniques">Figure&nbsp;<span>5.1</span></a> are rows for cases where predictor variables include a mixture quantitative and discrete factors.</p>
<ul>
<li><p>**Analysis of covariance* (ANCOVA) is the term for models where the main emphasis on on comparing means of different groups, but where there are one or more quantitative predictors (for example a pre-test score on the outcome variable) that need to be taken into account, so we can assess the differences among groups <em>controlling</em> or <em>adjusting</em> for those predictors, which are called <em>covariates</em>.</p></li>
<li><p><strong>Homogeneity of regression</strong> treats the same type of data, but the main interest is on the regression relation between <span class="math inline">\(\mathbf{y}\)</span> and a set of quantitative <span class="math inline">\(\mathbf{x}\)</span>s, but there is also one or more grouping factors. In this case, we want to determine if the same regression relation applies in all groups or whether the groups differ in their intercepts and/or slopes. Another term for this class of questions is <strong>moderator</strong> effects, which refers to interactions between the quantitative predictors and group factors.</p></li>
</ul>
<p>:::{.callout-note title = “History Corner”}</p>
<p>Why are there so many different names for regression vs.&nbsp;ANOVA concepts, statistics and techniques? In regression, we use notation like <span class="math inline">\(x_1, x_2, ...\)</span> to refer to <em>predictors</em> in a model, while in ANOVA, factors <span class="math inline">\(A, B, ...\)</span> are called <em>main effects</em>. In regression applications, we often test <em>linear hypotheses</em>, are interested in <em>coefficients</em> and evaluate a model with and <span class="math inline">\(R^2\)</span> statistic, while in ANOVA we may test <em>contrasts</em> among factor levels, and use <span class="math inline">\(F\)</span>-tests to evaluate models.</p>
<p>Well, like twins separated at birth, they grew up in homes in different places and with different parents.</p>
<p>Methods of regression began with Francis Galton’s <span class="citation" data-cites="Galton:1886 Galton:1889">(<a href="90-references.html#ref-Galton:1886" role="doc-biblioref">1886</a>, <a href="90-references.html#ref-Galton:1889" role="doc-biblioref">1889</a>)</span> studies of heritability of traits, trying to understand how strongly the physical characteristics of one generation of living things resembled those in the next generation. From a study of the diameters of sweet peas in parent plants and their size in the next generation, and another on the relationship between heights of human parents and their offspring, he developed the fundamental ideas of regression. Karl Pearson <span class="citation" data-cites="Pearson:1896">(<a href="90-references.html#ref-Pearson:1896" role="doc-biblioref">1896</a>)</span></p>
<p>Analysis of variance methods were raised on farms, notably the Rothamsted Experimental Station, where R. A. Fisher analyzed vast amounts of data on crop experiments designed to determine the conditions (soil condition, fertilizer treatments) that gave the greatest yields, while controlling for extraneous determiners (plots of planting). With multiple factors determining the outcome, Fisher <span class="citation" data-cites="Fisher1923">(<a href="90-references.html#ref-Fisher1923" role="doc-biblioref">1923</a>)</span>, in an experiment on yields of different varieties of potatoes given various manure treatments, devised the method of breaking down the total variance into portions attributable to each factor and presented the first ANOVA table. The method became well-known after Fisher’s <span class="citation" data-cites="Fisher:25">(<a href="90-references.html#ref-Fisher:25" role="doc-biblioref">1925</a>)</span> <em>Statistical Methods for Research Workers</em>.</p>
<p>The great synthesis of regression and ANOVA did not take place until the 1960s … Graybill, Winer, Bock … -&gt; Symposium 1967</p>
<p>Birth of the general linear models : https://files.eric.ed.gov/fulltext/ED026737.pdf</p>
<p>:::</p>
<section id="linear-combinations" class="level2" data-number="5.1"><h2 data-number="5.1" class="anchored" data-anchor-id="linear-combinations">
<span class="header-section-number">5.1</span> Linear combinations</h2>
<p>All methods of multivariate statistics involve a simple idea: Finding weighted sums—<em>linear combinations</em>— of observed variables to optimize some criterion—maximizing a measure of goodness-of-fit, like <span class="math inline">\(R^2\)</span> or minimizing a measure of badness-of-fit like sums of squares of residuals. Methods differ according to whether:</p>
<ul>
<li><p>All variables belong to <strong>one set</strong> (say, <span class="math inline">\(\mathbf{X}\)</span>), not distinguished as to whether they are responses or predictors, as in PCA and factor analysis, vs.&nbsp;<strong>two sets</strong> where one set is considered outcome, dependent variables, to be explained by predictors, independent variables (<span class="math inline">\(\mathbf{X}\)</span>), as in multiple regression, multivariate analysis of variance, discriminant analysis and canonical correlation analysis.</p></li>
<li><p>The variables in <span class="math inline">\(\mathbf{X}\)</span> and <span class="math inline">\(\mathbf{Y}\)</span> are discrete, <strong>categorical factors</strong> like sex and level of education or <strong>quantitative</strong> variables like salary and number of years of experience.</p></li>
</ul>
<p>For example, <a href="#fig-lin-comb-pca">Figure&nbsp;<span>5.2</span></a> illustrates PCA (as we saw in <a href="04-pca-biplot.html"><span>Chapter&nbsp;4</span></a>) as finding weights to maximize the variance of linear combinations, <span class="math inline">\(v_1, v_2, ...\)</span>, <span class="math display">\[\begin{eqnarray*}
\mathbf{v}_1 &amp; = &amp; a_1 \mathbf{x}_1 + a_2 \mathbf{x}_2 + a_3 \mathbf{x}_3 + a_4 \mathbf{x}_4 \\
\mathbf{v}_2 &amp; = &amp; b_1 \mathbf{x}_1 + b_2 \mathbf{x}_2 + b_3 \mathbf{x}_3 + b_4 \mathbf{x}_4 \\
\dots &amp; \dots \; , \\
\end{eqnarray*}\]</span></p>
<p>subject to all <span class="math inline">\(\mathbf{v}_i, \mathbf{v}_j\)</span> being uncorrelated, <span class="math inline">\(\mathbf{v}_i \;\perp\; \mathbf{v}_j\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-lin-comb-pca" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/lin-comb-pca.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;5.2: Principal components analysis as linear combinations to maximize variance accounted for. Left: diagram of PCA showing two uncorrelated linear combinations, v1 and v2. Right: Geometry of PCA.</figcaption></figure>
</div>
</div>
</div>
<section id="multiple-regression" class="level3" data-number="5.1.1"><h3 data-number="5.1.1" class="anchored" data-anchor-id="multiple-regression">
<span class="header-section-number">5.1.1</span> Multiple regression</h3>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-lin-comb2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/lin-comb2.png" class="img-fluid figure-img" style="width:40.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;5.3: Multiple regression as linear combinations to maximize R squared. … <strong>TODO</strong> Add vector diagram</figcaption></figure>
</div>
</div>
</div>
</section><section id="multivariate-regression" class="level3" data-number="5.1.2"><h3 data-number="5.1.2" class="anchored" data-anchor-id="multivariate-regression">
<span class="header-section-number">5.1.2</span> Multivariate regression</h3>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-lin-comb3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/lin-comb3.png" class="img-fluid figure-img" style="width:40.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;5.4: Multivariate multiple regression as linear combinations to maximize R squared. … <strong>TODO</strong> Add vector diagram</figcaption></figure>
</div>
</div>
</div>
</section><section id="canonical-correlation-analysis" class="level3" data-number="5.1.3"><h3 data-number="5.1.3" class="anchored" data-anchor-id="canonical-correlation-analysis">
<span class="header-section-number">5.1.3</span> Canonical correlation analysis</h3>
</section><section id="the-general-linear-model" class="level3" data-number="5.1.4"><h3 data-number="5.1.4" class="anchored" data-anchor-id="the-general-linear-model">
<span class="header-section-number">5.1.4</span> The General Linear Model</h3>
<p>To establish notation and terminology, it is worthwhile to state the the general linear model formally. For convenience, I use vector and matrix notation. This expresses a response variable, <span class="math inline">\(\mathbf{y} = (y_1, y_2, \dots , y_n)^\textsf{T}\)</span> for <span class="math inline">\(n\)</span> observations, as a sum of terms involving <span class="math inline">\(p\)</span> <em>regressors</em>, <span class="math inline">\(\mathbf{x}_1, \mathbf{x}_2, \dots , \mathbf{x}_p\)</span>, each of length <span class="math inline">\(n\)</span>.</p>
<p><span class="math display">\[
\begin{align*}
\mathbf{y} &amp; = \beta_0 + \beta_1 \mathbf{x}_1 + \beta_2 \mathbf{x}_2 + \cdots + \beta_p \mathbf{x}_p + \mathbf{\epsilon} \\
           &amp; = \left[ \mathbf{1},\; \mathbf{x}_1,\; \mathbf{x}_2,\; \dots ,\; \mathbf{x}_p \right] \; \boldsymbol{\beta} + \boldsymbol{\epsilon} \\
           &amp; = \mathbf{X}_{n \times (p+1)}\; \boldsymbol{\beta}_{(p+1) \times 1} + \boldsymbol{\epsilon}
\end{align*}
\]</span></p>
<p><span class="math display">\[
\begin{align*}
\mathbf{y} &amp; = \beta_0 + \beta_1 \mathbf{x}_1 + \beta_2 \mathbf{x}_2 + \cdots + \beta_p \mathbf{x}_p + \mathbf{\epsilon} \\
           &amp; = \left[ \mathbf{1},\; \mathbf{x}_1,\; \mathbf{x}_2,\; \dots ,\; \mathbf{x}_p \right] \; \boldsymbol{\beta} + \boldsymbol{\epsilon} \\
           &amp; = \mathord{\mathop{\mathbf{X}}\limits_{(n \times (p+1))}}
\; \mathord{\mathop{\mathbf{\boldsymbol{\beta}}}\limits_{((p+1) \times 1)}}
+ \boldsymbol{\epsilon}
\end{align*}
\]</span></p>
<p>The matrix <span class="math inline">\(\mathbf{X}\)</span> is called the <em>model matrix</em> and contains the numerical representations of the <em>predictor</em> variables. The essential thing about a linear model is that it is linear in the <strong>parameters</strong> <span class="math inline">\(\beta_i\)</span>. That is, the predicted value of <span class="math inline">\(\mathbf{y}\)</span> is a linear combination of some <span class="math inline">\(\mathbf{x}_i\)</span> with weights <span class="math inline">\(\beta_i\)</span>. An example of a nonlinear model is the exponential growth model, <span class="math inline">\(y = \beta_0 + e^{\beta_1 x}\)</span>. …</p>
<ul>
<li><p>These can be quantitative variables like <code>age</code>, <code>salary</code> or <code>years</code> of education. But they can also be transformed versions, like <code>sqrt(age)</code> or <code>log(salary)</code>.</p></li>
<li><p>A quantitative variable can be represented by more than one model regressor, for example if it is expressed as a polynomial like <code>poly(age, degree=2)</code> or a natural spline like <code>ns(salary, df=5)</code>. The model matrix portion for such terms contains one column for each degree of freedom (<code>df</code>) and there are <code>df</code> coefficients in <span class="math inline">\(\boldsymbol{\beta}\)</span>.</p></li>
<li><p>A categorical or discrete predictor– a factor variable in R– with <span class="math inline">\(d\)</span> levels is expressed as <span class="math inline">\(d - 1\)</span> columns in <span class="math inline">\(\mathbf{X}\)</span>. Typically these are contrasts or comparisons between a baseline or reference level and each of the remaining ones, but any set of <span class="math inline">\(d - 1\)</span> linearly independent contrasts can be used by assigning to <code>contrasts(factor)</code>. For example, <code>contrasts(factor) &lt;- contr.sum(4)</code> …</p></li>
<li><p>Interactions between predictors are represented as the direct products of the corresponding columns of <span class="math inline">\(\mathbf{X}\)</span>. This allows the effect of one predictor on the response to depend on values of other predictors. For example, the interaction of two quantitative variables, <span class="math inline">\(\mathbf{x}_1, \mathbf{x}_2\)</span> is represented by the product <span class="math inline">\(\mathbf{x}_1 \times \mathbf{x}_2\)</span>. More generally, for variables or factors <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> with degrees of freedom <span class="math inline">\(df_A\)</span> and <span class="math inline">\(df_B\)</span> the regressors in <span class="math inline">\(\mathbf{X}\)</span> are the <span class="math inline">\(df_A \times df_B\)</span> products of each column for <span class="math inline">\(A\)</span> with each column for <span class="math inline">\(B\)</span>.</p></li>
</ul></section><section id="model-formulas" class="level3" data-number="5.1.5"><h3 data-number="5.1.5" class="anchored" data-anchor-id="model-formulas">
<span class="header-section-number">5.1.5</span> Model formulas</h3>
<p>Statistical models in R, such as those fit by <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>, <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> and many other modelling function in R are expressed in a simple notation that was developed by <span class="citation" data-cites="WilkinsonRogers1973">Wilkinson &amp; Rogers (<a href="90-references.html#ref-WilkinsonRogers1973" role="doc-biblioref">1973</a>)</span> for the GENSTAT software system at the Rothamsted Research Station. It solves the problem of having a compact way to specify any model consisting of any combinations of quantitative and discrete factor variables, interactions of these and arbitrary transformations of these.</p>
<p>In this, a <strong>model formula</strong> take the forms</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">response</span> <span class="op">~</span> <span class="va">terms</span></span>
<span><span class="va">response</span> <span class="op">~</span> <span class="va">term1</span> <span class="op">+</span> <span class="va">term2</span> <span class="op">+</span> <span class="va">...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>where the left-hand side, <code>response</code> specifies the response variable in the model and the right-hand side specifies the terms in the model.</p>
<p>The notation <code>y ~ x</code> is read as “<code>y</code> <em>is modeled by</em> <code>x</code>”. On the right-hand side, the usual arithmetic operator, <code>+, -, *, /, ^</code> have special meanings as described below. The most fundamental is that <code>y ~ a + b</code> is interpreted as “<code>y</code> is modeled by <code>a</code> <em>and</em> <code>b</code>”.</p>
<p>Some examples for regression-like models using only quantitative variables, <code>X, X1, X2, x3, ...</code> are shown below:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>                      <span class="co"># simple linear regression</span></span>
<span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">-</span> <span class="fl">1</span>                  <span class="co"># no intercept: regression through the origin </span></span>
<span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>             <span class="co"># quadratic model</span></span>
<span><span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">3</span><span class="op">)</span>             <span class="co"># cubic model</span></span>
<span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">*</span> <span class="va">x2</span>                <span class="co"># crossing: x1 + x2 + x1 × x2</span></span>
<span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span>           <span class="co"># multiple regression</span></span>
<span><span class="va">y</span> <span class="op">~</span> <span class="op">(</span><span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>       <span class="co"># response surface: all quadratics &amp; two-way interactions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span><span class="op">)</span>   <span class="co"># arbitrary transformation of response</span></span>
<span><span class="va">y1</span> <span class="op">+</span> <span class="va">y2</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span>     <span class="co"># response is sum of y1 and y2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Factor variables are treated specially in linear models, but have simple notations in R formulas. The following examples use <code>A, B, C</code> to represent discrete factors with two or more levels.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">y</span> <span class="op">~</span> <span class="va">A</span>                 <span class="co"># one-way ANOVA</span></span>
<span><span class="va">y</span> <span class="op">~</span> <span class="va">A</span> <span class="op">+</span> <span class="va">B</span>             <span class="co"># two-way, main effects only</span></span>
<span><span class="va">y</span> <span class="op">~</span> <span class="va">A</span> <span class="op">*</span> <span class="va">B</span>             <span class="co"># full two-way, with interaction</span></span>
<span><span class="va">y</span> <span class="op">~</span> <span class="va">A</span> <span class="op">+</span> <span class="va">B</span> <span class="op">+</span> <span class="va">A</span><span class="op">:</span><span class="va">B</span>       <span class="co"># same, in long-hand</span></span>
<span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">+</span> <span class="va">A</span>             <span class="co"># one-way ANCOVA</span></span>
<span><span class="va">y</span> <span class="op">~</span> <span class="op">(</span><span class="va">A</span> <span class="op">+</span> <span class="va">B</span> <span class="op">+</span> <span class="va">C</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>     <span class="co"># three-way ANOVA, incl. all two-way interactions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="regression" class="level2" data-number="5.2"><h2 data-number="5.2" class="anchored" data-anchor-id="regression">
<span class="header-section-number">5.2</span> Regression</h2>
</section><section id="anova" class="level2" data-number="5.3"><h2 data-number="5.3" class="anchored" data-anchor-id="anova">
<span class="header-section-number">5.3</span> ANOVA</h2>
</section><section id="ancova" class="level2" data-number="5.4"><h2 data-number="5.4" class="anchored" data-anchor-id="ancova">
<span class="header-section-number">5.4</span> ANCOVA</h2>
</section><section id="regression-trees" class="level2" data-number="5.5"><h2 data-number="5.5" class="anchored" data-anchor-id="regression-trees">
<span class="header-section-number">5.5</span> Regression trees</h2>
<!-- ## References {.unnumbered} -->


<div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="list" style="display: none">
<div id="ref-Fisher1923" class="csl-entry" role="listitem">
Fisher, R. A. (1923). Studies in crop variation. II. The manurial response of different potato varieties. <em>The Journal of Agricultural Science</em>, <em>13</em>(2), 311–320. <a href="https://hdl.handle.net/2440/15179">https://hdl.handle.net/2440/15179</a>
</div>
<div id="ref-Fisher:25" class="csl-entry" role="listitem">
Fisher, R. A. (1925). <em>Statistical methods for research workers</em>. Oliver &amp; Boyd.
</div>
<div id="ref-Galton:1886" class="csl-entry" role="listitem">
Galton, F. (1886). Regression towards mediocrity in hereditary stature. <em>Journal of the Anthropological Institute</em>, <em>15</em>, 246–263. <a href="http://www.jstor.org/cgi-bin/jstor/viewitem/09595295/dm995266/99p0374f/0">http://www.jstor.org/cgi-bin/jstor/viewitem/09595295/dm995266/99p0374f/0</a>
</div>
<div id="ref-Galton:1889" class="csl-entry" role="listitem">
Galton, F. (1889). <em>Natural inheritance</em>. Macmillan. <a href="http://galton.org/books/natural-inheritance/pdf/galton-nat-inh-1up-clean.pdf">http://galton.org/books/natural-inheritance/pdf/galton-nat-inh-1up-clean.pdf</a>
</div>
<div id="ref-Pearson:1896" class="csl-entry" role="listitem">
Pearson, K. (1896). Contributions to the mathematical theory of evolution—<span>III</span>, regression, heredity and panmixia. <em>Philosophical Transactions of the Royal Society of London</em>, <em>187</em>, 253–318.
</div>
<div id="ref-WilkinsonRogers1973" class="csl-entry" role="listitem">
Wilkinson, G. N., &amp; Rogers, C. E. (1973). Symbolic description of factorial models for analysis of variance. <em>Applied Statistics</em>, <em>22</em>(3), 392. <a href="https://doi.org/10.2307/2346786">https://doi.org/10.2307/2346786</a>
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./04-pca-biplot.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Dimension Reduction</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./06-linear_models-plots.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Plots for univariate response models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<script src="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.js" defer="true"></script>
</body></html>