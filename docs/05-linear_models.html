<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.53">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>5&nbsp; Overview of Linear models – Visualizing Multivariate Data and Models in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./06-linear_models-plots.html" rel="next">
<link href="./04-pca-biplot.html" rel="prev">
<link href="./images/favicon/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./05-linear_models.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Overview of Linear models</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title"><span id="sec-linear-models" class="quarto-section-identifier"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Overview of Linear models</span></span></h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Visualizing Multivariate Data and Models in R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/friendly/vis-MLM-book" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-getting_started.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Started</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-multivariate_plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Plots of Multivariate Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-pca-biplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Dimension Reduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-linear_models.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Overview of Linear models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-linear_models-plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Plots for univariate response models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-lin-mod-topics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Topics in Linear Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-collinearity-ridge.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Collinearity &amp; Ridge Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-hotelling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Hotelling’s <span class="math inline">\(T^2\)</span></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-mlm-review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Multivariate Linear Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-mlm-viz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Visualizing Multivariate Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eqcov.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Visualizing Equality of Covariance Matrices</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./case-studies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Case studies</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./90-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./91-colophon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Colophon</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#linear-combinations" id="toc-linear-combinations" class="nav-link active" data-scroll-target="#linear-combinations"><span class="header-section-number">5.1</span> Linear combinations</a></li>
  <li>
<a href="#sec-GLM" id="toc-sec-GLM" class="nav-link" data-scroll-target="#sec-GLM"><span class="header-section-number">5.2</span> The General Linear Model</a>
  <ul class="collapse">
<li><a href="#sec-model-formulas" id="toc-sec-model-formulas" class="nav-link" data-scroll-target="#sec-model-formulas"><span class="header-section-number">5.2.1</span> Model formulas</a></li>
  <li><a href="#model-matrices" id="toc-model-matrices" class="nav-link" data-scroll-target="#model-matrices"><span class="header-section-number">5.2.2</span> Model matrices</a></li>
  <li><a href="#sec-contrasts" id="toc-sec-contrasts" class="nav-link" data-scroll-target="#sec-contrasts"><span class="header-section-number">5.2.3</span> Contrasts</a></li>
  </ul>
</li>
  <li><a href="#regression" id="toc-regression" class="nav-link" data-scroll-target="#regression"><span class="header-section-number">5.3</span> Regression</a></li>
  <li><a href="#anova" id="toc-anova" class="nav-link" data-scroll-target="#anova"><span class="header-section-number">5.4</span> ANOVA</a></li>
  <li><a href="#ancova" id="toc-ancova" class="nav-link" data-scroll-target="#ancova"><span class="header-section-number">5.5</span> ANCOVA</a></li>
  <li><a href="#regression-trees" id="toc-regression-trees" class="nav-link" data-scroll-target="#regression-trees"><span class="header-section-number">5.6</span> Regression trees</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/friendly/vis-MLM-book/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content"><!--- For HTML Only ---><!-- %\renewcommand*{\det}[1]{\mathrm{det} (#1)} --><!-- %\renewcommand*{\det}[1]{|#1|} --><!-- \newcommand{\sizedmat}[2]{\mathord{\mathop{\mat{#1}}\limits_{(#2)}}} --><!-- \newcommand*{\E}{\mathcal{E}} --><!-- % R stuff --><p>Although this book is primarily about multivariate models, it is useful to have an overview of the range of available techniques for univariate response models to see their uses and to appreciate how easily univariate models generalize to multivariate ones. Hence, this chapter reviews the characteristics of the standard univariate methods for explaining or predicting a single outcome variable from a set of predictors.</p>
<p>The key ideas are:</p>
<ul>
<li><p>For a single quantitative outcome variable <span class="math inline">\(\mathbf{y}\)</span>, methods of linear regression and analysis of variance (ANOVA) are comprised within a single framework of the <strong>general linear model</strong> (GLM). Regression and ANOVA differ only in that the predictors in the former are quantitative, while those in the latter are discrete factors. They can all be fit using <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>.</p></li>
<li><p>These models extend directly to the multivariate case of <span class="math inline">\(q &gt; 1\)</span> outcomes, <span class="math inline">\(\mathbf{Y} = (\mathbf{y}_1, \mathbf{y}_2, \dots \mathbf{y}_q)\)</span>, and are also fit using <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>.</p></li>
<li><p>A binary outcome <span class="math inline">\(y = (0, 1)\)</span> and categorical outcomes like marital status (“never married”, “married”, “separated”, “divorced”) can be handled within a different extension, the <strong>generalized</strong> linear model as logistic regression or multinomial regression, fit using <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code>.</p></li>
<li><p>All of these models involve linear combinations of predictors (weighted sums) fit to optimize some criterion, for example minimizing some function of the residuals or maximizing some measure of fit.</p></li>
<li><p>Models and data can be more easily understood with graphics, and many statistical ideas have a visual representation in geometry.</p></li>
</ul>
<p><a href="#fig-techniques" class="quarto-xref">Figure&nbsp;<span>5.1</span></a> summarizes a variety of methods for linear models, classified by number of predictors and number of response variables, and whether these are quantitative vs.&nbsp;discrete. For the present purposes, the key columns are the first two, for the case of one or more quantitative outcome variables.</p>
<!-- **TODO**: This should be a table, but that's not working -->
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-techniques" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-techniques-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/techniques-table.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-techniques-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.1: Techniques for linear models classified by number of predictors and number of response variables, and whether these are quantitative vs.&nbsp;discrete
</figcaption></figure>
</div>
</div>
</div>
<p>When the <em>predictors</em> are also quantitative, simple regression (<span class="math inline">\(p=1\)</span>) generalizes to multivariate regression with two or more outcomes (<span class="math inline">\(q &gt; 1\)</span>). For example we might want to predict weight and body mass index <em>jointly</em> from a person’s height.</p>
<p>The situation is more interesting when there are <span class="math inline">\(p&gt;1\)</span> predictors. The most common multivariate generalization is <em>multivariate multiple regression</em> (MMRA), where each outcome is regressed on the predictors, as if done separately for each outcome, but using multivariate tests that take correlations among the predictors into account. Other methods for this case include canonical correlation analysis, which tries to explain all relations between <span class="math inline">\(\mathbf{Y}\)</span> and a set of <span class="math inline">\(\mathbf{x}\)</span>s through maximally correlated linear combinations of each.</p>
<p>When the predictor variables are all discrete or categorical, such as gender or level of education, methods like the simple <span class="math inline">\(t\)</span>-test, one-way ANOVA and factorial ANOVA with <span class="math inline">\(q=1\)</span> outcome measures all have simple extensions to the case of <span class="math inline">\(q&gt;1\)</span> outcomes.</p>
<p>Not shown in <a href="#fig-techniques" class="quarto-xref">Figure&nbsp;<span>5.1</span></a> are rows for cases where predictor variables include a mixture quantitative and discrete factors. These have two “flavors”, depending on our emphasis.</p>
<ul>
<li><p><strong>Analysis of covariance</strong> (ANCOVA) is the term for models where the main emphasis on on comparing means of different groups, but where there are one or more quantitative predictors (for example a pre-test score on the outcome variable) that need to be taken into account, so we can assess the differences among groups <em>controlling</em> or <em>adjusting</em> for those predictors, which are called <em>covariates</em>. (Strictly speaking, ANCOVA models typically assume that the regression slopes are the same for all groups.)</p></li>
<li><p><strong>Homogeneity of regression</strong> treats the same type of data, but the main interest is on the regression relation between <span class="math inline">\(\mathbf{y}\)</span> and a set of quantitative <span class="math inline">\(\mathbf{x}\)</span>s, but there is also one or more grouping factors. In this case, we want to determine if the <em>same regression</em> relation applies in all groups or whether the groups differ in their intercepts and/or slopes. Another term for this class of questions is <strong>moderator</strong> effects, which refers to interactions between the quantitative predictors and group factors.</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="History Corner">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
History Corner
</div>
</div>
<div class="callout-body-container callout-body">
<p>Why are there so many different names for regression vs.&nbsp;ANOVA concepts, statistics and techniques? In regression, we use notation like <span class="math inline">\(x_1, x_2, ...\)</span> to refer to <em>predictors</em> in a model, while in ANOVA, factors <span class="math inline">\(A, B, ...\)</span> are called <em>main effects</em>. In regression applications, we often test <em>linear hypotheses</em>, are interested in <em>coefficients</em> and evaluate a model with an <span class="math inline">\(R^2\)</span> statistic, while in ANOVA we may test <em>contrasts</em> among factor levels, and use <span class="math inline">\(F\)</span>-tests to evaluate models.</p>
<p>Well, like twins separated at birth, they grew up in homes in different places and with different parents, who were each free to choose their own names, not recognizing their shared DNA.</p>
<p>Methods of regression began in evolutionary biology with Francis Galton’s <span class="citation" data-cites="Galton:1886 Galton:1889">(<a href="90-references.html#ref-Galton:1886" role="doc-biblioref">1886</a>, <a href="90-references.html#ref-Galton:1889" role="doc-biblioref">1889</a>)</span> studies of heritability of traits, trying to understand how strongly the physical characteristics of one generation of living things resembled those in the next generation. From a study of the diameters of sweet peas in parent plants and their size in the next generation, and another on the relationship between heights of human parents and their offspring, he developed the fundamental ideas of regression. Karl Pearson <span class="citation" data-cites="Pearson:1896">(<a href="90-references.html#ref-Pearson:1896" role="doc-biblioref">1896</a>)</span></p>
<p>In contrast, analysis of variance methods were raised on farms, notably the Rothamsted Experimental Station, where R. A. Fisher analyzed vast amounts of data on crop experiments designed to determine the conditions (soil condition, fertilizer treatments) that gave the greatest yields, while controlling for extraneous determiners (plots of planting). With multiple factors determining the outcome, Fisher <span class="citation" data-cites="Fisher1923">(<a href="90-references.html#ref-Fisher1923" role="doc-biblioref">1923</a>)</span>, in an experiment on yields of different varieties of potatoes given various manure treatments, devised the method of breaking down the total variance into portions attributable to each factor and presented the first ANOVA table. The method became well-known after Fisher’s <span class="citation" data-cites="Fisher:25">(<a href="90-references.html#ref-Fisher:25" role="doc-biblioref">1925</a>)</span> <em>Statistical Methods for Research Workers</em>.</p>
<p>The great synthesis of regression and ANOVA did not take place until the 1960s. At that time, methods for computing were beginning to move from programmable desk calculators to mainframe computers, largely using a collection of separate FORTRAN programs, designed for regression, one-way ANOVA, two-way ANOVA, models with interactions, and so forth. To complete an analysis, as a graduate student I often had to use three or more different programs.</p>
<p>Then, something remarkable happened on two fronts: theory and computation. First, in quick succession textbooks by <span class="citation" data-cites="Scheffe1960">Scheffé (<a href="90-references.html#ref-Scheffe1960" role="doc-biblioref">1960</a>)</span>, <span class="citation" data-cites="Graybill1961">Graybill (<a href="90-references.html#ref-Graybill1961" role="doc-biblioref">1961</a>)</span>, <span class="citation" data-cites="Winer1962">Winer (<a href="90-references.html#ref-Winer1962" role="doc-biblioref">1962</a>)</span> … began to layout a general theory of linear models that encompassed all of these separate models, giving the “General Linear Model” a well-deserved name. Second, two symposiums, one at IBM Yorkdown Heights (<span class="citation" data-cites="IBM1965">IBM (<a href="90-references.html#ref-IBM1965" role="doc-biblioref">1965</a>)</span>) and the other at the University of Georgia (BradshawFindley1967) resulted in the first general programs to handle all these cases in an understandable way.</p>
<p>A bit of matrix algebra thrown into the mix showed that most of the ideas for univariate models could be extended to multiple response variables, and so the “Multivariate Linear Model” was born. R. Darrell Bock <span class="citation" data-cites="Bock1963 Bock1964">(<a href="90-references.html#ref-Bock1963" role="doc-biblioref">Bock, 1963</a>, <a href="90-references.html#ref-Bock1964" role="doc-biblioref">1964</a>)</span> sketched a flowchart of the computational steps, which was implemented at the University of Chicago by Jeremy Finn <span class="citation" data-cites="Finn1967">(<a href="90-references.html#ref-Finn1967" role="doc-biblioref">1967</a>)</span> in the MULTIVARIANCE program. A group at the University of North Carolina headed by Elliot Cramer developed their MANOVA program <span class="citation" data-cites="Clyde-etal-1966">(<a href="90-references.html#ref-Clyde-etal-1966" role="doc-biblioref">Clyde, 1966</a>)</span> and Willard Dixon <span class="citation" data-cites="Dixon1965">(<a href="90-references.html#ref-Dixon1965" role="doc-biblioref">1965</a>)</span> at UCLA developed the BMD programs incorporating these ideas. The ANOVA and regression twins had finally become part of a larger family.</p>
<!--
...
Graybill, Winer, Bock  ... -> Symposium 1967

Birth of the general linear models : https://files.eric.ed.gov/fulltext/ED026737.pdf

Bock1966: flowchart -> Jeremy Finn (1967) MULTIVARIANCE
Elliot Cramer (UNC) -> Clyde, Cramer & Shering (1966) MANOVA
Dixon, UCLA (1965): BMD
-->
</div>
</div>
<section id="linear-combinations" class="level2" data-number="5.1"><h2 data-number="5.1" class="anchored" data-anchor-id="linear-combinations">
<span class="header-section-number">5.1</span> Linear combinations</h2>
<p>All methods of multivariate statistics involve a simple idea: Finding weighted sums—<em>linear combinations</em>— of observed variables to optimize some criterion—maximizing a measure of goodness-of-fit, like <span class="math inline">\(R^2\)</span> or minimizing a measure of badness-of-fit like sums of squares of residuals. Methods differ according to whether:</p>
<ul>
<li><p>All variables belong to <strong>one set</strong> (say, <span class="math inline">\(\mathbf{X}\)</span>), not distinguished as to whether they are responses or predictors, as in PCA and factor analysis, vs.&nbsp;<strong>two sets</strong> where one set is considered outcome, dependent variables, to be explained by predictors, independent variables (<span class="math inline">\(\mathbf{X}\)</span>), as in multiple regression, multivariate analysis of variance, discriminant analysis and canonical correlation analysis.</p></li>
<li><p>The variables in <span class="math inline">\(\mathbf{X}\)</span> and <span class="math inline">\(\mathbf{Y}\)</span> are discrete, <strong>categorical factors</strong> like sex and level of education or <strong>quantitative</strong> variables like salary and number of years of experience.</p></li>
</ul>
<section id="pca" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="pca">PCA</h4>
<p>For example, <a href="#fig-lin-comb-pca" class="quarto-xref">Figure&nbsp;<span>5.2</span></a> illustrates PCA (as we saw in <a href="04-pca-biplot.html" class="quarto-xref"><span>Chapter 4</span></a>) as finding weights to maximize the variance of linear combinations, <span class="math inline">\(v_1, v_2, ...\)</span>, <span class="math display">\[\begin{aligned}
\mathbf{v}_1 &amp; = &amp; a_1 \mathbf{x}_1 + a_2 \mathbf{x}_2 + a_3 \mathbf{x}_3 + a_4 \mathbf{x}_4 \\
\mathbf{v}_2 &amp; = &amp; b_1 \mathbf{x}_1 + b_2 \mathbf{x}_2 + b_3 \mathbf{x}_3 + b_4 \mathbf{x}_4 \\
\vdots &amp; = &amp; \vdots \; , \\
\end{aligned}\]</span></p>
<p>subject to all <span class="math inline">\(\mathbf{v}_i, \mathbf{v}_j\)</span> being uncorrelated, <span class="math inline">\(\mathbf{v}_i \;\perp\; \mathbf{v}_j\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-lin-comb-pca" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-lin-comb-pca-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/lin-comb-pca.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lin-comb-pca-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.2: Principal components analysis as linear combinations to maximize variance accounted for. Left: diagram of PCA showing two uncorrelated linear combinations, v1 and v2. Right: Geometry of PCA.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="multiple-regression" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="multiple-regression">Multiple regression</h4>
<p>An analogous diagram for multiple regression is shown in <a href="#fig-lin-comb-mra" class="quarto-xref">Figure&nbsp;<span>5.3</span></a>. Here, we find the weights <span class="math inline">\(b_1, b_2, \dots\)</span> to maximize the <span class="math inline">\(R^2\)</span> of <span class="math inline">\(\mathbf{y}\)</span> with the predicted values <span class="math inline">\(\widehat{\mathbf{y}}\)</span>,</p>
<p><span class="math display">\[
\widehat{\mathbf{y}} = b_1 \mathbf{x}_1 + b_2 \mathbf{x}_2 + b_3 \mathbf{x}_3 \:\: .
\]</span> In the vector diagram at the right, saying that the fitted vector <span class="math inline">\(\widehat{\mathbf{y}}\)</span> is a linear combination of <span class="math inline">\(\mathbf{x}_1\)</span> and <span class="math inline">\(\mathbf{x}_2\)</span> means that it lies in the plane that they define. The fitted vector is the orthogonal projection of <span class="math inline">\(\mathbf{y}\)</span> on this plane, and the least squares weights <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_2\)</span> give the maximum possible correlation <span class="math inline">\(r^2 (\mathbf{y}, \widehat{\mathbf{y}})\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-lin-comb-mra" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-lin-comb-mra-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/lin-comb-mra.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lin-comb-mra-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.3: Multiple regression as a linear combination to maximize the squared correlation with the predicted values <span class="math inline">\(\hat{\mathbf{y}}\)</span>. Right: vector geometry of multiple regression for two predictors.
</figcaption></figure>
</div>
</div>
</div>
<p>The vector of residuals, <span class="math inline">\(\mathbf{e} = \mathbf{y} -\widehat{\mathbf{y}}\)</span> is orthogonal to that plane (<span class="math inline">\(\mathbf{y}\)</span> and <span class="math inline">\(\mathbf{e}\)</span> are uncorrelated), and the least squares solution also minimizes length <span class="math inline">\(\parallel \mathbf{e} \parallel = \sqrt(\Sigma e_i^2)\)</span>.</p>
</section><section id="multivariate-regression" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="multivariate-regression">Multivariate regression</h4>
<p>Multivariate multiple regression does the same thing for each response variable, <span class="math inline">\(\mathbf{y}_1\)</span> and <span class="math inline">\(\mathbf{y}_2\)</span>, as shown in <a href="#fig-lin-comb3" class="quarto-xref">Figure&nbsp;<span>5.4</span></a>. It finds the weights to maximize the correlation between <em>each</em> <span class="math inline">\(\mathbf{y}_j\)</span> and the corresponding predicted value <span class="math inline">\(\widehat{\mathbf{y}}_j\)</span>.</p>
<p><span class="math display">\[\begin{aligned}
\widehat{\mathbf{y}}_1 &amp; = &amp; a_1 \mathbf{x}_1 + a_2 \mathbf{x}_2 + a_3 \mathbf{x}_3 \\
\widehat{\mathbf{y}}_2 &amp; = &amp; b_1 \mathbf{x}_1 + b_2 \mathbf{x}_2 + b_3 \mathbf{x}_3 \\
\end{aligned}\]</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-lin-comb3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-lin-comb3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/lin-comb3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:40.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lin-comb3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.4: Multivariate multiple regression as linear combinations to maximize the R squared for each response variable separately.
</figcaption></figure>
</div>
</div>
</div>
<p>The weights <span class="math inline">\(a_1, a_2, a_3\)</span> and <span class="math inline">\(b_1, b_2, b_3\)</span> are the same as would be found in separate multiple regressions for the response variables. However, the multivariate tests used here take the correlations among the <span class="math inline">\(\mathbf{y}\)</span>s, and can be more powerful than fitting separate univariate response models.</p>
</section><section id="canonical-correlation-analysis" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="canonical-correlation-analysis">Canonical correlation analysis</h4>
<p>Finally, canonical correlation analysis uses a different approach to fitting relations between a set of responses, <span class="math inline">\(\mathbf{y}_1, \mathbf{y}_2, \dots\)</span> and a set of predictors, <span class="math inline">\(\mathbf{x}_1, \mathbf{x}_2, \dots\)</span>. …</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-lin-comb4" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-lin-comb4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/lin-comb4.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:40.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lin-comb4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.5: Canonical correlation analyis finds uncorrelated linear combinations of the responses which maximize the R squared with linear combinations of the predictors.
</figcaption></figure>
</div>
</div>
</div>
</section></section><section id="sec-GLM" class="level2" data-number="5.2"><h2 data-number="5.2" class="anchored" data-anchor-id="sec-GLM">
<span class="header-section-number">5.2</span> The General Linear Model</h2>
<p>To establish notation and terminology, it is worthwhile to state the the general linear model formally. For convenience, I use vector and matrix notation. This expresses a response variable, <span class="math inline">\(\mathbf{y} = (y_1, y_2, \dots , y_n)^\mathsf{T}\)</span> for <span class="math inline">\(n\)</span> observations, as a sum of terms involving <span class="math inline">\(p\)</span> <em>regressors</em>, <span class="math inline">\(\mathbf{x}_1, \mathbf{x}_2, \dots , \mathbf{x}_p\)</span>, each of length <span class="math inline">\(n\)</span>.</p>
<!-- $$ -->
<!-- \begin{align*} -->
<!-- \mathbf{y} & = \beta_0 + \beta_1 \mathbf{x}_1 + \beta_2 \mathbf{x}_2 + \cdots + \beta_p \mathbf{x}_p + \mathbf{\epsilon} \\ -->
<!--            & = \left[ \mathbf{1},\; \mathbf{x}_1,\; \mathbf{x}_2,\; \dots ,\; \mathbf{x}_p \right] \; \boldsymbol{\beta} + \boldsymbol{\epsilon} \\ -->
<!--            & = \mathbf{X}_{n \times (p+1)}\; \boldsymbol{\beta}_{(p+1) \times 1} + \boldsymbol{\epsilon} -->
<!-- \end{align*} -->
<!-- $$ -->
<p><span id="eq-glm"><span class="math display">\[
\begin{align*}
\mathbf{y} &amp; = \beta_0 + \beta_1 \mathbf{x}_1 + \beta_2 \mathbf{x}_2 + \cdots + \beta_p \mathbf{x}_p + \mathbf{\epsilon} \\
           &amp; = \left[ \mathbf{1},\; \mathbf{x}_1,\; \mathbf{x}_2,\; \dots ,\; \mathbf{x}_p \right] \; \boldsymbol{\beta} + \boldsymbol{\epsilon} \\
\end{align*}
\tag{5.1}\]</span></span></p>
<!-- & = \LARGE{\sizedmat{X}{n \times (p+1)}\; \sizedmat{\boldsymbol{\beta}}{(p+1) \times 1} + \boldsymbol{\epsilon}} -->
<p>or, expressed in matrices,</p>
<p><span class="math display">\[
\Large{\mathord{\mathop{\mathbf{y}}\limits_{n \times 1}} = \mathord{\mathop{\mathbf{X}}\limits_{n \times (p+1)}}\; \mathord{\mathop{\mathbf{\boldsymbol{\beta}}}\limits_{(p+1) \times 1}} + \boldsymbol{\epsilon}}
\]</span></p>
<p>The matrix <span class="math inline">\(\mathbf{X}\)</span> is called the <em>model matrix</em> and contains the numerical representations of the predictor variables called <em>regressors</em>. The essential thing about a linear model is that it is linear in the <strong>parameters</strong> <span class="math inline">\(\beta_i\)</span>. That is, the predicted value of <span class="math inline">\(\mathbf{y}\)</span> is a linear combination of some <span class="math inline">\(\mathbf{x}_i\)</span> with weights <span class="math inline">\(\beta_i\)</span>. An example of a nonlinear model is the exponential growth model, <span class="math inline">\(y = \beta_0 + e^{\beta_1 x}\)</span>, where the parameter <span class="math inline">\(\beta_1\)</span> appears as an exponent.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<ul>
<li><p>These can be quantitative variables like <code>age</code>, <code>salary</code> or <code>years</code> of education. But they can also be transformed versions, like <code>sqrt(age)</code> or <code>log(salary)</code>.</p></li>
<li><p>A quantitative variable can be represented by more than one model regressor, for example if it is expressed as a polynomial like <code>poly(age, degree=2)</code> or a natural spline like <code>ns(salary, df=5)</code>. The model matrix portion for such terms contains one column for each degree of freedom (<code>df</code>) and there are <code>df</code> coefficients in the corresponding portion of <span class="math inline">\(\boldsymbol{\beta}\)</span>.</p></li>
<li><p>A categorical or discrete predictor– a factor variable in R– with <span class="math inline">\(d\)</span> levels is expressed as <span class="math inline">\(d - 1\)</span> columns in <span class="math inline">\(\mathbf{X}\)</span>. Typically these are contrasts or comparisons between a baseline or reference level and each of the remaining ones, but any set of <span class="math inline">\(d - 1\)</span> linearly independent contrasts can be used by assigning to <code>contrasts(factor)</code>. For example, <code>contrasts(factor) &lt;- contr.treatment(4)</code> for a 4-level factor assigns 3 contrasts representing comparisons with a baseline level, typically the first (in alphabetic order). For an <em>ordered</em> factor, such as one for political knowledge with levels “low”, “medium”, “high”, <code>contrasts.poly()</code> returns the coefficients of orthogonal polynomial contrasts representing linear and quadratic trends.</p></li>
<li><p>Interactions between predictors are represented as the direct products of the corresponding columns of <span class="math inline">\(\mathbf{X}\)</span>. This allows the effect of one predictor on the response to depend on values of other predictors. For example, the interaction of two quantitative variables, <span class="math inline">\(\mathbf{x}_1, \mathbf{x}_2\)</span> is represented by the product <span class="math inline">\(\mathbf{x}_1 \times \mathbf{x}_2\)</span>. More generally, for variables or factors <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> with degrees of freedom <span class="math inline">\(\text{df}_A\)</span> and <span class="math inline">\(\text{df}_B\)</span> the regressors in <span class="math inline">\(\mathbf{X}\)</span> are the <span class="math inline">\(\text{df}_A \times \text{df}_B\)</span> products of each column for <span class="math inline">\(A\)</span> with each column for <span class="math inline">\(B\)</span>.</p></li>
</ul>
<section id="sec-model-formulas" class="level3" data-number="5.2.1"><h3 data-number="5.2.1" class="anchored" data-anchor-id="sec-model-formulas">
<span class="header-section-number">5.2.1</span> Model formulas</h3>
<p>Statistical models in R, such as those fit by <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>, <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> and many other modelling function in R are expressed in a simple notation that was developed by <span class="citation" data-cites="WilkinsonRogers1973">Wilkinson &amp; Rogers (<a href="90-references.html#ref-WilkinsonRogers1973" role="doc-biblioref">1973</a>)</span> for the GENSTAT software system at the Rothamsted Research Station. It solves the problem of having a compact way to specify any model consisting of any combinations of quantitative and discrete factor variables, interactions of these and arbitrary transformations of these.</p>
<p>In this, a <strong>model formula</strong> take the forms</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">response</span> <span class="op">~</span> <span class="va">terms</span></span>
<span><span class="va">response</span> <span class="op">~</span> <span class="va">term1</span> <span class="op">+</span> <span class="va">term2</span> <span class="op">+</span> <span class="va">...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>where the left-hand side, <code>response</code> specifies the response variable in the model and the right-hand side specifies the <code>terms</code> in the model specifying the columns in the <span class="math inline">\(\mathbf{X}\)</span> matrix of <a href="#eq-glm" class="quarto-xref">Equation&nbsp;<span>5.1</span></a>; the coefficients <span class="math inline">\(\beta\)</span> are implied and not represented explicitly in the formula.</p>
<p>The notation <code>y ~ x</code> is read as “<code>y</code> <em>is modeled by</em> <code>x</code>”. The left-hand side is usually a variable name (such as <code>height</code>), but it could be an expression that evaluates to the the response, such as <code>log(salary)</code> or <code>weight/height^2</code> which represents the body mass index.</p>
<p>On the right-hand side (RHS), the usual arithmetic operator, <code>+, -, *, /, ^</code> have special meanings as described below. The most fundamental is that <code>y ~ a + b</code> is interpreted as “<code>y</code> is modeled by <code>a</code> <em>and</em> <code>b</code>”; that is, the sum of linear terms for <code>a</code> and <code>b</code>.</p>
<p>Some examples for regression-like models using only quantitative variables, <code>x, x1, x2, x3, ...</code> are shown below:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>                      <span class="co"># simple linear regression</span></span>
<span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">-</span> <span class="fl">1</span>                  <span class="co"># no intercept: regression through the origin </span></span>
<span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>             <span class="co"># quadratic model</span></span>
<span><span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">3</span><span class="op">)</span>             <span class="co"># cubic model</span></span>
<span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">*</span> <span class="va">x2</span>                <span class="co"># crossing: x1 + x2  +  x1 : x2</span></span>
<span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span>           <span class="co"># multiple regression</span></span>
<span><span class="va">y</span> <span class="op">~</span> <span class="op">(</span><span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>       <span class="co"># response surface: all quadratics &amp; two-way interactions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span><span class="op">)</span>   <span class="co"># arbitrary transformation of response</span></span>
<span><span class="va">y1</span> <span class="op">+</span> <span class="va">y2</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span>     <span class="co"># response is sum of y1 and y2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The intercept <span class="math inline">\(\beta_0\)</span> is automatically included in the model without need to specify it explicitly. The minus sign, <code>-</code> on the right-hand side removes terms from the model, so a model with no intercept <span class="math inline">\(\beta_0 = 0\)</span> can be specifies as <code>y ~ X -1</code> (or perhaps more naturally, <code>y ~ 0 + X</code>).</p>
<p>Function calls on the RHS, such as <code>poly(x, 3)</code> are evaluated directly, but to use a special model operator, like <code>^</code> must be “protected” by wrapping the term in <code><a href="https://rdrr.io/r/base/AsIs.html">I()</a></code>, meaning “identity” or “inhibit”. Thus, the model <code>y ~ x + I(x^2)</code> means the quadratic model <span class="math inline">\(y = \beta_0 + \beta_1 x + \beta_2 x^2\)</span>. This differs from the model <code>y ~ poly(x, 2)</code> in that the former uses the raw <code>x, x^2</code> values (which are necessarily positively correlated) while <code><a href="https://rdrr.io/r/stats/poly.html">poly()</a></code> converts these to orthogonal polynomial scores, which are uncorrelated (and therefore free from problems of collinearity).</p>
<p>Factor variables are treated specially in linear models, but have simple notations in R formulas. The following examples use <code>A, B, C</code> to represent discrete factors with two or more levels.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">y</span> <span class="op">~</span> <span class="va">A</span>                 <span class="co"># one-way ANOVA</span></span>
<span><span class="va">y</span> <span class="op">~</span> <span class="va">A</span> <span class="op">+</span> <span class="va">B</span>             <span class="co"># two-way, main effects only</span></span>
<span><span class="va">y</span> <span class="op">~</span> <span class="va">A</span> <span class="op">*</span> <span class="va">B</span>             <span class="co"># full two-way, with interaction</span></span>
<span><span class="va">y</span> <span class="op">~</span> <span class="va">A</span> <span class="op">+</span> <span class="va">B</span> <span class="op">+</span> <span class="va">A</span><span class="op">:</span><span class="va">B</span>       <span class="co"># same, in long-hand</span></span>
<span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">+</span> <span class="va">A</span>             <span class="co"># one-way ANCOVA</span></span>
<span><span class="va">y</span> <span class="op">~</span> <span class="op">(</span><span class="va">A</span> <span class="op">+</span> <span class="va">B</span> <span class="op">+</span> <span class="va">C</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>     <span class="co"># three-way ANOVA, incl. all two-way interactions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="crossing" class="level4 unnnumbered" data-number="5.2.1.1"><h4 class="unnnumbered anchored" data-number="5.2.1.1" data-anchor-id="crossing">
<span class="header-section-number">5.2.1.1</span> Crossing</h4>
<p>The <code>*</code> operator has special meaning used to specify the crossing of variables and factors and <code>:</code> specifies interactions (products of variables). So, the model <code>y ~ x1 * x2</code> is expanded to give <code>y ~ x1 + x2 + x1:x2</code> and the interaction term <code>x1:x2</code> is calculated as <span class="math inline">\(x_1 \times x_2\)</span>. In algebraic notation (omitting the error term) this works out to the model,</p>
<p><span class="math display">\[\begin{aligned}
y &amp; = &amp; \beta_0 + \beta_1 x_1 +  \beta_2 x_2 +  \beta_1 x_1 *  \beta_2 x_2 \\
  &amp; = &amp; \beta_0 + (\beta_1 + \beta_2 x_2) x_1 + \beta_2 x_2 \:\: ,\\
\end{aligned}\]</span></p>
<p>which means that the coefficient for <span class="math inline">\(x_1\)</span> in the model is not constant for all values of <span class="math inline">\(x_2\)</span>, but rather changes with the value of <span class="math inline">\(x_2\)</span>. If <span class="math inline">\(\beta_2 &gt; 0\)</span>, the slope for <span class="math inline">\(x_1\)</span> increases with <span class="math inline">\(x_2\)</span> and vice-versa.</p>
<p><code>y ~ A * B</code> for factors is similar, expanding to <code>y ~ A + B + A:B</code>, but the columns in the model matrix represent contrasts among the factor levels as describe above. The main effects, <code>A</code> and <code>B</code> come from contrasts among the means of their factor levels and the interaction term <code>A:B</code> reflects <em>differences</em> among means of <code>A</code> across the levels of <code>B</code> (and vice-versa).</p>
<p>The model formula <code>y ~ x + A</code> specifies an ANCOVA model with different intercepts for the levels of <code>A</code>, but with a common slope for <code>x</code>. Adding an interaction of <code>x:A</code> in the model <code>y ~ x * A</code> allow separate slopes and intercepts for the groups.</p>
</section><section id="powers" class="level4 unnnumbered" data-number="5.2.1.2"><h4 class="unnnumbered anchored" data-number="5.2.1.2" data-anchor-id="powers">
<span class="header-section-number">5.2.1.2</span> Powers</h4>
<p>The <code>^</code> exponent operator indicates <em>powers of a term expression</em> to a specified degree. Thus the term <code>(A + B)^2</code> is identical to <code>(A + B) * (A + B)</code> which expands to the main effects of <code>A</code>, <code>B</code> and their interaction, also identical to <code>A * B</code>. In general, the product of parenthesized terms expands as in ordinary algebra,</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">y</span> <span class="op">~</span> <span class="op">(</span><span class="va">A</span> <span class="op">+</span> <span class="va">B</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">C</span> <span class="op">+</span> <span class="va">D</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">A</span> <span class="op">+</span> <span class="va">B</span> <span class="op">+</span> <span class="va">C</span> <span class="op">+</span> <span class="va">D</span> <span class="op">+</span> <span class="va">A</span><span class="op">:</span><span class="va">C</span> <span class="op">+</span> <span class="va">A</span><span class="op">:</span><span class="va">D</span> <span class="op">+</span> <span class="va">B</span><span class="op">:</span><span class="va">C</span> <span class="op">+</span> <span class="va">B</span><span class="op">:</span><span class="va">D</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Powers get more interesting with more terms, so <code>(A + B + C)^2</code> is the same as <code>(A + B + C) * (A + B + C)</code>, which includes main effects of <code>A</code>, <code>B</code> and <code>C</code> as well as all two-way interactions, <code>A:B, A:C</code> and <code>B:C</code>. The model formula <code>(A + B + C)^3</code> expands to include all two-way interactions and the three-way interaction <code>A:B:C</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">A</span> <span class="op">+</span> <span class="va">B</span> <span class="op">+</span> <span class="va">C</span><span class="op">)</span><span class="op">^</span><span class="fl">3</span> <span class="op">-&gt;</span> <span class="va">A</span> <span class="op">+</span> <span class="va">B</span> <span class="op">+</span> <span class="va">C</span> <span class="op">+</span> <span class="va">A</span><span class="op">:</span><span class="va">B</span> <span class="op">+</span> <span class="va">A</span><span class="op">:</span><span class="va">C</span> <span class="op">+</span> <span class="va">B</span><span class="op">:</span><span class="va">C</span> <span class="op">+</span> <span class="va">A</span><span class="op">:</span><span class="va">B</span><span class="op">:</span><span class="va">C</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this context <code>-</code> can be use to remove terms, as shown in the following examples</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>(A <span class="sc">+</span> B <span class="sc">+</span> C)<span class="sc">^</span><span class="dv">2</span> <span class="ot">&lt;-</span><span class="er">&gt;</span> (A <span class="sc">+</span> B <span class="sc">+</span> C)<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> A<span class="sc">:</span>B<span class="sc">:</span>C</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>(A <span class="sc">+</span> B <span class="sc">+</span> C)<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> B<span class="sc">:</span>C <span class="sc">-</span> A<span class="sc">:</span>B<span class="sc">:</span>C  <span class="ot">&lt;-</span><span class="er">&gt;</span> A <span class="sc">+</span> B <span class="sc">+</span> C <span class="sc">+</span> A<span class="sc">:</span>B <span class="sc">+</span> A<span class="sc">:</span>C </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, the symbol <code>.</code> on the right-hand side specifies <em>all terms</em> in the current dataset other than the response. Thus if you have a data.frame containing <code>y, x1, x2, ..., x6</code>, you can specify a model with all variables except <code>x6</code> as predictors as</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="va">x6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To test what we’ve covered above,</p>
<ul>
<li><p>What do you think the model formula <code>y ~ .^2</code> means in a data set containing variables <code>x1, x2, x3,</code> and <code>x4</code>?</p></li>
<li><p>What about the formula with <code>y ~ .^2 - A:B:C:D</code> with factors <code>A, B, C, D</code>?</p></li>
</ul>
<p>You can work out questions like these or explore model formulae using <code><a href="https://rdrr.io/r/stats/terms.html">terms()</a></code> for a <code>"formula"</code> object. The labels of these terms can then be concatenated to a string and turned back into a formula using <code><a href="https://rdrr.io/r/stats/formula.html">as.formula()</a></code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="op">(</span><span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span> <span class="op">+</span> <span class="va">x4</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">terms</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/terms.html">terms</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span>, <span class="st">"term.labels"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">terms</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span>collapse <span class="op">=</span> <span class="st">" + "</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "x1 + x2 + x3 + x4 + x1:x2 + x1:x3 + x1:x4 + x2:x3 + x2:x4 + x3:x4"</span></span>
<span><span class="co"># convert back to a formula</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"y ~ %s"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">terms</span>, collapse<span class="op">=</span><span class="st">" + "</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co">#&gt; y ~ x1 + x2 + x3 + x4 + x1:x2 + x1:x3 + x1:x4 + x2:x3 + x2:x4 + </span></span>
<span><span class="co">#&gt;     x3:x4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="model-matrices" class="level3" data-number="5.2.2"><h3 data-number="5.2.2" class="anchored" data-anchor-id="model-matrices">
<span class="header-section-number">5.2.2</span> Model matrices</h3>
<p>As noted above, a model formula is used to generate the <span class="math inline">\(n \times (p+1)\)</span> model matrix, <span class="math inline">\(\mathbf{X}\)</span>, typically containing the column of 1s for the intercept <span class="math inline">\(\beta_0\)</span> in the model, followed by <span class="math inline">\(p\)</span> columns representing the regressors <span class="math inline">\(\mathbf{x}_1, \mathbf{x}_2, \dots , \mathbf{x}_p\)</span>. Internally, <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> uses <code><a href="https://rdrr.io/r/stats/model.matrix.html">stats::model.matrix()</a></code> and you can use this to explore how factors, interactions and other model terms are represented in a model object.</p>
<p>For a small example, here are a few observations representing income (<code>inc</code>) and <code>type</code> of occupation. <code><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix()</a></code> takes a <em>one-sided</em> formula with the terms on the right-hand side. The main effect model looks like this:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">inc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">9</span>, <span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bc"</span>, <span class="st">"wc"</span>, <span class="st">"prof"</span><span class="op">)</span>, each <span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="op">~</span> <span class="va">inc</span> <span class="op">+</span> <span class="va">type</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">type</span>, <span class="va">mm</span><span class="op">)</span></span>
<span><span class="co">#&gt;   type X.Intercept. inc typeprof typewc</span></span>
<span><span class="co">#&gt; 1   bc            1  38        0      0</span></span>
<span><span class="co">#&gt; 2   bc            1  39        0      0</span></span>
<span><span class="co">#&gt; 3   bc            1  26        0      0</span></span>
<span><span class="co">#&gt; 4   wc            1  37        0      1</span></span>
<span><span class="co">#&gt; 5   wc            1  33        0      1</span></span>
<span><span class="co">#&gt; 6   wc            1  30        0      1</span></span>
<span><span class="co">#&gt; 7 prof            1  35        1      0</span></span>
<span><span class="co">#&gt; 8 prof            1  23        1      0</span></span>
<span><span class="co">#&gt; 9 prof            1  33        1      0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As you can see, <code>type</code>, with 2 degrees of freedom is represented by two dummy (0/1) variables, <code>typeprof</code> and <code>typewc</code>. Together, these represent <em>treatment contrasts</em> (comparisons) between the <em>baseline</em> group <code>type=="bc"</code>, which is coded (0, 0) and each of the others: <code>type=="prof"</code>, coded (1, 0) and <code>type=="wc"</code>, codes (0, 1). By default, the baseline level is the first in alphabetic or numerical order, but you can change this using <code><a href="https://rdrr.io/r/stats/relevel.html">relevel()</a></code>.</p>
<p>In a model with the interaction <code>inc * type</code>, additional columns are constructed as the product of <code>inc</code> with each of the columns for <code>type</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="op">~</span> <span class="va">inc</span> <span class="op">*</span> <span class="va">type</span><span class="op">)</span></span>
<span><span class="co">#&gt;   (Intercept) inc typeprof typewc inc:typeprof inc:typewc</span></span>
<span><span class="co">#&gt; 1           1  38        0      0            0          0</span></span>
<span><span class="co">#&gt; 2           1  39        0      0            0          0</span></span>
<span><span class="co">#&gt; 3           1  26        0      0            0          0</span></span>
<span><span class="co">#&gt; 4           1  37        0      1            0         37</span></span>
<span><span class="co">#&gt; 5           1  33        0      1            0         33</span></span>
<span><span class="co">#&gt; 6           1  30        0      1            0         30</span></span>
<span><span class="co">#&gt; 7           1  35        1      0           35          0</span></span>
<span><span class="co">#&gt; 8           1  23        1      0           23          0</span></span>
<span><span class="co">#&gt; 9           1  33        1      0           33          0</span></span>
<span><span class="co">#&gt; attr(,"assign")</span></span>
<span><span class="co">#&gt; [1] 0 1 2 2 3 3</span></span>
<span><span class="co">#&gt; attr(,"contrasts")</span></span>
<span><span class="co">#&gt; attr(,"contrasts")$type</span></span>
<span><span class="co">#&gt; [1] "contr.treatment"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-contrasts" class="level3" data-number="5.2.3"><h3 data-number="5.2.3" class="anchored" data-anchor-id="sec-contrasts">
<span class="header-section-number">5.2.3</span> Contrasts</h3>
</section></section><section id="regression" class="level2" data-number="5.3"><h2 data-number="5.3" class="anchored" data-anchor-id="regression">
<span class="header-section-number">5.3</span> Regression</h2>
</section><section id="anova" class="level2" data-number="5.4"><h2 data-number="5.4" class="anchored" data-anchor-id="anova">
<span class="header-section-number">5.4</span> ANOVA</h2>
</section><section id="ancova" class="level2" data-number="5.5"><h2 data-number="5.5" class="anchored" data-anchor-id="ancova">
<span class="header-section-number">5.5</span> ANCOVA</h2>
</section><section id="regression-trees" class="level2" data-number="5.6"><h2 data-number="5.6" class="anchored" data-anchor-id="regression-trees">
<span class="header-section-number">5.6</span> Regression trees</h2>
<!-- ## References {.unnumbered} -->


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-Bock1963" class="csl-entry" role="listitem">
Bock, R. D. (1963). Programming univariate and multivariate analysis of variance. <em>Technometrics</em>, <em>5</em>(1), 95–117. <a href="https://doi.org/10.1080/00401706.1963.10490061">https://doi.org/10.1080/00401706.1963.10490061</a>
</div>
<div id="ref-Bock1964" class="csl-entry" role="listitem">
Bock, R. D. (1964). A computer program forunivariate and multivariate analysis of variance. <em>Proceedings of Scientific Symposium on Statistics</em>.
</div>
<div id="ref-Clyde-etal-1966" class="csl-entry" role="listitem">
Clyde, C., D. J. (1966). <em>Multivariate statistical programs</em>. Biometric Laboratory,University of Miami.
</div>
<div id="ref-Dixon1965" class="csl-entry" role="listitem">
Dixon, W. J. (1965). <em>BMD biomedical computer programs</em>. Health Sciences Computing Facility, School of Medicine, University of California; Health Sciences Computing Faculty.
</div>
<div id="ref-Finn1967" class="csl-entry" role="listitem">
Finn, J. D. (1967). <em><span>MULTIVARIANCE</span>: Fortran program for univariate and multivariate analysis of variance and covariance</em>. School of Education, State University of New York at Buffalo.
</div>
<div id="ref-Fisher1923" class="csl-entry" role="listitem">
Fisher, R. A. (1923). Studies in crop variation. II. The manurial response of different potato varieties. <em>The Journal of Agricultural Science</em>, <em>13</em>(2), 311–320. <a href="https://hdl.handle.net/2440/15179">https://hdl.handle.net/2440/15179</a>
</div>
<div id="ref-Fisher:25" class="csl-entry" role="listitem">
Fisher, R. A. (1925). <em>Statistical methods for research workers</em>. Oliver &amp; Boyd.
</div>
<div id="ref-Galton:1886" class="csl-entry" role="listitem">
Galton, F. (1886). Regression towards mediocrity in hereditary stature. <em>Journal of the Anthropological Institute</em>, <em>15</em>, 246–263. <a href="http://www.jstor.org/cgi-bin/jstor/viewitem/09595295/dm995266/99p0374f/0">http://www.jstor.org/cgi-bin/jstor/viewitem/09595295/dm995266/99p0374f/0</a>
</div>
<div id="ref-Galton:1889" class="csl-entry" role="listitem">
Galton, F. (1889). <em>Natural inheritance</em>. Macmillan. <a href="http://galton.org/books/natural-inheritance/pdf/galton-nat-inh-1up-clean.pdf">http://galton.org/books/natural-inheritance/pdf/galton-nat-inh-1up-clean.pdf</a>
</div>
<div id="ref-Graybill1961" class="csl-entry" role="listitem">
Graybill, F. A. (1961). <em>An introduction to linear statistical models</em>. McGraw-Hill.
</div>
<div id="ref-IBM1965" class="csl-entry" role="listitem">
IBM. (1965). <em>Proceedings of the IBM scientific computing symposium on statistics: Oct 21-23, 1963</em> (L. Robinson, Ed.). IBM. <a href="https://www.amazon.com/Proceedings-Scientific-Computing-Symposium-Statistics/dp/B000GL5RLU">https://www.amazon.com/Proceedings-Scientific-Computing-Symposium-Statistics/dp/B000GL5RLU</a>
</div>
<div id="ref-Pearson:1896" class="csl-entry" role="listitem">
Pearson, K. (1896). Contributions to the mathematical theory of evolution—<span>III</span>, regression, heredity and panmixia. <em>Philosophical Transactions of the Royal Society of London</em>, <em>187</em>, 253–318.
</div>
<div id="ref-Scheffe1960" class="csl-entry" role="listitem">
Scheffé, H. A. (1960). <em>The analysis of variance</em>. Wiley.
</div>
<div id="ref-WilkinsonRogers1973" class="csl-entry" role="listitem">
Wilkinson, G. N., &amp; Rogers, C. E. (1973). Symbolic description of factorial models for analysis of variance. <em>Applied Statistics</em>, <em>22</em>(3), 392. <a href="https://doi.org/10.2307/2346786">https://doi.org/10.2307/2346786</a>
</div>
<div id="ref-Winer1962" class="csl-entry" role="listitem">
Winer, B. J. (1962). <em>Statistical principles in experimental design</em>. McGraw-Hill.
</div>
</div>
</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>Taking logarithms of both sides would yield the linear model, <span class="math inline">\(log(y) = c + \beta_1 x\)</span>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./04-pca-biplot.html" class="pagination-link" aria-label="Dimension Reduction">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Dimension Reduction</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./06-linear_models-plots.html" class="pagination-link" aria-label="Plots for univariate response models">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Plots for univariate response models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/friendly/vis-MLM-book/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer><script src="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.js" defer="true"></script>
</body></html>