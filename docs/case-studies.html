<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Visualizing Multivariate Data and Models in R - 11&nbsp; Case studies</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./eqcov.html" rel="next">
<link href="./mlm-review.html" rel="prev">
<link href="./images/favicon/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./case-studies.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Case studies</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Visualizing Multivariate Data and Models in R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/friendly/vis-MLM-book" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-getting_started.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Started</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-multivariate_plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Plots of Multivariate Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-pca-biplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">PCA and Biplots</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-linear_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Overview of Linear models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear_models-plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Plots for univariate response models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./collinearity-ridge.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Collinearity &amp; Ridge Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hotelling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Hotelling’s <span class="math inline">\(T^2\)</span></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm-viz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Visualizing Multivariate Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm-review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Brief review of the multivariate linear model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./case-studies.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Case studies</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eqcov.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Visualizing Tests for Equality of Covariance Matrices</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./90-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#neuro--and-social-cognitive-measures-in-psychiatric-groups" id="toc-neuro--and-social-cognitive-measures-in-psychiatric-groups" class="nav-link active" data-scroll-target="#neuro--and-social-cognitive-measures-in-psychiatric-groups"><span class="header-section-number">11.1</span> Neuro- and Social-cognitive measures in psychiatric groups</a>
  <ul class="collapse">
<li><a href="#research-questions" id="toc-research-questions" class="nav-link" data-scroll-target="#research-questions"><span class="header-section-number">11.1.1</span> Research questions</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="header-section-number">11.1.2</span> Data</a></li>
  <li><a href="#a-first-look" id="toc-a-first-look" class="nav-link" data-scroll-target="#a-first-look"><span class="header-section-number">11.1.3</span> A first look</a></li>
  <li><a href="#bivariate-views" id="toc-bivariate-views" class="nav-link" data-scroll-target="#bivariate-views"><span class="header-section-number">11.1.4</span> Bivariate views</a></li>
  </ul>
</li>
  <li>
<a href="#fitting-the-mlm" id="toc-fitting-the-mlm" class="nav-link" data-scroll-target="#fitting-the-mlm"><span class="header-section-number">11.2</span> Fitting the MLM</a>
  <ul class="collapse">
<li><a href="#he-plot" id="toc-he-plot" class="nav-link" data-scroll-target="#he-plot"><span class="header-section-number">11.2.1</span> HE plot</a></li>
  <li><a href="#canonical-space" id="toc-canonical-space" class="nav-link" data-scroll-target="#canonical-space"><span class="header-section-number">11.2.2</span> Canonical space</a></li>
  </ul>
</li>
  <li>
<a href="#social-cognitive-measures" id="toc-social-cognitive-measures" class="nav-link" data-scroll-target="#social-cognitive-measures"><span class="header-section-number">11.3</span> Social cognitive measures</a>
  <ul class="collapse">
<li><a href="#model-checking" id="toc-model-checking" class="nav-link" data-scroll-target="#model-checking"><span class="header-section-number">11.3.1</span> Model checking</a></li>
  <li><a href="#canonical-he-plot" id="toc-canonical-he-plot" class="nav-link" data-scroll-target="#canonical-he-plot"><span class="header-section-number">11.3.2</span> Canonical HE plot</a></li>
  </ul>
</li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/friendly/vis-MLM-book/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Case studies</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>This chapter presents some complete analyses of datasets that will be prominent in the book. Some of this material may later be moved to earlier chapters.</p>
<p><strong>Packages</strong></p>
<p>In this chapter we use the following packages. Load them now</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://friendly.github.io/heplots/">heplots</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">candisc</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://kwstat.github.io/corrgram/">corrgram</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- **Packages** -->
<!-- In this chapter we use the following packages. Load them now -->
<!-- ```{r} -->
<!-- library(car) -->
<!-- library(heplots) -->
<!-- library(Hotelling) -->
<!-- library(ggplot2) -->
<!-- library(dplyr) -->
<!-- library(tidyr) -->
<!-- ``` -->
<section id="neuro--and-social-cognitive-measures-in-psychiatric-groups" class="level2" data-number="11.1"><h2 data-number="11.1" class="anchored" data-anchor-id="neuro--and-social-cognitive-measures-in-psychiatric-groups">
<span class="header-section-number">11.1</span> Neuro- and Social-cognitive measures in psychiatric groups</h2>
<p>A Ph.D.&nbsp;dissertation by Laura Hartman <span class="citation" data-cites="Hartman:2016">(<a href="90-references.html#ref-Hartman:2016" role="doc-biblioref">2016</a>)</span> at York University was designed to evaluate whether and how clinical patients diagnosed (on the DSM-IV) as schizophrenic or with schizoaffective disorder could be distinguished from each other and from a normal, control sample on collections of standardized tests in the following domains:</p>
<ul>
<li><p><strong>Neuro-cognitive</strong>: processing speed, attention, verbal learning, visual learning and problem solving;</p></li>
<li><p><strong>Social-cognitive</strong>: managing emotions, theory of mind, externalizing, personalizing bias.</p></li>
</ul>
<p>The study is an important contribution to clinical research because the two diagnostic categories are subtly different and their symptoms often overlap. Yet, they’re very different and often require different treatments. A key difference between schizoaffective disorder and schizophrenia is the prominence of mood disorder involving bipolar, manic and depressive moods. With schizoaffective disorder, mood disorders are front and center. With schizophrenia, that is not a dominant part of the disorder, but psychotic ideation (hearing voices, seeing imaginary people) is.</p>
<section id="research-questions" class="level3" data-number="11.1.1"><h3 data-number="11.1.1" class="anchored" data-anchor-id="research-questions">
<span class="header-section-number">11.1.1</span> Research questions</h3>
<p>This example is concerned with the following substantitive questions:</p>
<ul>
<li><p>To what extent can patients diagnosed as schizophrenic or with schizoaffective disorder be distinguished from each other and from a normal control sample using a well-validated, comprehensive neurocognitive battery specifically designed for individuals with psychosis <span class="citation" data-cites="Heinrichs-etal:2015">(<a href="90-references.html#ref-Heinrichs-etal:2015" role="doc-biblioref">Heinrichs et al., 2015</a>)</span> ?</p></li>
<li><p>If the groups differ, do any of the cognitive domains show particularly larger or smaller differences among these groups?</p></li>
<li><p>Do the neurocognitive measures discriminate among the in the same or different ways? If different, how many separate aspects or dimensions are distinguished?</p></li>
</ul>
<p>Apart from the research interest, it could aid diagnosis and treatment if these similar mental disorders could be distinguished by tests in the cognitive domain.</p>
</section><section id="data" class="level3" data-number="11.1.2"><h3 data-number="11.1.2" class="anchored" data-anchor-id="data">
<span class="header-section-number">11.1.2</span> Data</h3>
<p>The clinical sample comprised 116 male and female patients who met the following criteria: 1) a diagnosis of schizophrenia (<span class="math inline">\(n\)</span> = 70) or schizoaffective disorder (<span class="math inline">\(n\)</span> = 46) confirmed by the Structured Clinical Interview for DSM-IV-TR Axis I Disorders; 2) were outpatients; 3) a history free of developmental or learning disability; 4) age 18-65; 5) a history free of neurological or endocrine disorder; and 6) no concurrent diagnosis of substance use disorder. Non-psychiatric control participants (<span class="math inline">\(n\)</span> = 146) were screened for medical and psychiatric illness and history of substance abuse and were recruited from three outpatient clinics.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">NeuroCog</span>, package<span class="op">=</span><span class="st">"heplots"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">NeuroCog</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 242</span></span>
<span><span class="co">#&gt; Columns: 10</span></span>
<span><span class="co">#&gt; $ Dx        &lt;fct&gt; Schizophrenia, Schizophrenia, Schizophrenia, Sch…</span></span>
<span><span class="co">#&gt; $ Speed     &lt;int&gt; 19, 8, 14, 7, 21, 31, -1, 17, 7, 37, 30, 26, 32,…</span></span>
<span><span class="co">#&gt; $ Attention &lt;int&gt; 9, 25, 23, 18, 9, 10, 8, 20, 30, 15, 27, 20, 23,…</span></span>
<span><span class="co">#&gt; $ Memory    &lt;int&gt; 19, 15, 15, 14, 35, 26, 3, 27, 26, 17, 28, 22, 2…</span></span>
<span><span class="co">#&gt; $ Verbal    &lt;int&gt; 33, 28, 20, 34, 28, 29, 20, 30, 26, 33, 34, 33, …</span></span>
<span><span class="co">#&gt; $ Visual    &lt;int&gt; 24, 24, 13, 16, 29, 21, 12, 32, 27, 21, 19, 18, …</span></span>
<span><span class="co">#&gt; $ ProbSolv  &lt;int&gt; 39, 40, 32, 31, 45, 33, 29, 29, 30, 33, 30, 39, …</span></span>
<span><span class="co">#&gt; $ SocialCog &lt;int&gt; 28, 37, 24, 36, 28, 28, 28, 44, 39, 24, 32, 36, …</span></span>
<span><span class="co">#&gt; $ Age       &lt;int&gt; 44, 26, 55, 53, 51, 21, 53, 56, 48, 46, 48, 31, …</span></span>
<span><span class="co">#&gt; $ Sex       &lt;fct&gt; Female, Male, Female, Male, Male, Male, Male, Fe…</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The diagnostic classification variable is called <code>Dx</code> in the dataset. To facilitate answering questions regarding group differences, the following contrasts were applied: the first column compares the control group to the average of the diagnosed groups, the second compares the schizophrenia group against the schizoaffective group.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html">contrasts</a></span><span class="op">(</span><span class="va">NeuroCog</span><span class="op">$</span><span class="va">Dx</span><span class="op">)</span></span>
<span><span class="co">#&gt;                 [,1] [,2]</span></span>
<span><span class="co">#&gt; Schizophrenia   -0.5    1</span></span>
<span><span class="co">#&gt; Schizoaffective -0.5   -1</span></span>
<span><span class="co">#&gt; Control          1.0    0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this analysis, we ignore the <code>SocialCog</code> variable. The primary focus is on the variables <code>Attention : ProbSolv</code>.</p>
</section><section id="a-first-look" class="level3" data-number="11.1.3"><h3 data-number="11.1.3" class="anchored" data-anchor-id="a-first-look">
<span class="header-section-number">11.1.3</span> A first look</h3>
<p>As always, plot the data first! We want an overview of the distributions of the variables to see the centers, spread, shape and possible outliers for each group on each variable.</p>
<p>The plot below combines the use of boxplots and violin plots to give an informative display. As we saw earlier (Chapter XXX), doing this with <code>ggplot2</code> requires reshaping the data to long format.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Reshape from wide to long</span></span>
<span><span class="va">NC_long</span> <span class="op">&lt;-</span> <span class="va">NeuroCog</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">SocialCog</span>, <span class="op">-</span><span class="va">Age</span>, <span class="op">-</span><span class="va">Sex</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="va">response</span>, value <span class="op">=</span> <span class="st">"value"</span>, <span class="va">Speed</span><span class="op">:</span><span class="va">ProbSolv</span><span class="op">)</span></span>
<span><span class="co"># view 3 observations per group and measure</span></span>
<span><span class="va">NC_long</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Dx</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html">sample_n</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 9 × 3</span></span>
<span><span class="co">#&gt;   Dx              response  value</span></span>
<span><span class="co">#&gt;   &lt;fct&gt;           &lt;chr&gt;     &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 Schizophrenia   Speed        39</span></span>
<span><span class="co">#&gt; 2 Schizophrenia   Visual       21</span></span>
<span><span class="co">#&gt; 3 Schizophrenia   Memory       40</span></span>
<span><span class="co">#&gt; 4 Schizoaffective ProbSolv     40</span></span>
<span><span class="co">#&gt; 5 Schizoaffective Speed        25</span></span>
<span><span class="co">#&gt; 6 Schizoaffective Verbal       48</span></span>
<span><span class="co">#&gt; 7 Control         Speed        33</span></span>
<span><span class="co">#&gt; 8 Control         ProbSolv     43</span></span>
<span><span class="co">#&gt; 9 Control         Attention    37</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the plot, we take care to adjust the transparency (<code>alpha</code>) values for the points, violin plots and boxplots so that all can be seen. Options for <code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot()</a></code> are used to give these greater visual prominence.</p>
<div class="cell" data-layout-align="center">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb5" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">NC_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Dx</span>, y<span class="op">=</span><span class="va">value</span>, fill<span class="op">=</span><span class="va">Dx</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>shape<span class="op">=</span><span class="fl">16</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, size<span class="op">=</span><span class="fl">1</span>, width<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.5</span>, alpha<span class="op">=</span><span class="fl">0.4</span>, </span>
<span>               outlier.alpha<span class="op">=</span><span class="fl">1</span>, outlier.size <span class="op">=</span> <span class="fl">3</span>, outlier.color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Schizo"</span>, <span class="st">"SchizAff"</span>, <span class="st">"Control"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">response</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, as.table <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"bottom"</span>,</span>
<span>        axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">rel</a></span><span class="op">(</span><span class="fl">1.2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        axis.text  <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">rel</a></span><span class="op">(</span><span class="fl">1.2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-NC-boxplot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/fig-NC-boxplot-1.png" class="img-fluid figure-img" style="width:120.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;11.1: Boxplots and violin plots of the <code>NeuroCog</code> data.</figcaption></figure>
</div>
</div>
</div>
<p>We can see that the control participants score higher on all measures, but there is no consistent pattern of medians for the two patient groups. But these univariate summaries do not inform about the relations among variables.</p>
</section><section id="bivariate-views" class="level3" data-number="11.1.4"><h3 data-number="11.1.4" class="anchored" data-anchor-id="bivariate-views">
<span class="header-section-number">11.1.4</span> Bivariate views</h3>
<section id="corrgram" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="corrgram">Corrgram</h4>
<p>A corrgram <span class="citation" data-cites="Friendly:02:corrgram">(<a href="90-references.html#ref-Friendly:02:corrgram" role="doc-biblioref">Friendly, 2002</a>)</span> provides a useful reconnaisance plot of the bivariate correlations in the dataset. It suppresses details, and allows focus on the overall pattern. The <code><a href="https://kwstat.github.io/corrgram/reference/corrgram.html">corrgram::corrgram()</a></code> function has the ability to enhance perception by permuting the variables in the order of their variable vectors in a biplot, so more highly correlated variables are adjacent in the plot, and example of <em>effect ordering</em> for data displays <span class="citation" data-cites="FriendlyKwan:03:effect">(<a href="90-references.html#ref-FriendlyKwan:03:effect" role="doc-biblioref">Friendly &amp; Kwan, 2003</a>)</span>.</p>
<p>The plot below includes all variables except for <code>Dx</code> group. There are a number of <code>panel.*</code> functions for choosing how the correlation for each pair is rendered.</p>
<div class="cell" data-layout-align="center" data-fig.asp="1">
<div class="sourceCode" id="cb6" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">NeuroCog</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Dx</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://kwstat.github.io/corrgram/reference/corrgram.html">corrgram</a></span><span class="op">(</span>order <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>           diag.panel <span class="op">=</span> <span class="va">panel.density</span>,</span>
<span>           upper.panel <span class="op">=</span> <span class="va">panel.pie</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-NC-corrgram" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/fig-NC-corrgram-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;11.2: corrgram of the <code>NeuroCog</code> data. The upper and lower triangles use two different ways of encoding the value of the correlation for each pair of variables.</figcaption></figure>
</div>
</div>
</div>
<p>In this plot you can see that adjacent variables are more highly correlated than those more widely separated. The diagonal panels show that most variables are reasonably symmetric in their distributions. <code>Age</code>, not included in this analysis is negatively correlated with the others: older participants tend to do less well on these tests.</p>
</section><section id="scatterplot-matrix" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="scatterplot-matrix">Scatterplot matrix</h4>
<p>A scatterplot matrix gives a more detailed overview of all pairwise relations. The plot below suppresses the data points and summarizes the relation using data ellipses and regression lines. The model syntax, <code>~ Speed + ... |Dx</code>, treats <code>Dx</code> as a conditioning variable (similar to the use of the <code>color</code> aestheic in <code>ggplot2</code>) giving a separate data ellipse and regression line for each group. (The legend is suppressed here. The groups are <span style="color: red;">Schizophrenic</span>, <span style="color: green;">SchizoAffective</span>, <span style="color: blue;">Normal</span>.)</p>
<div class="cell" data-layout-align="center" data-fig.asp="1">
<div class="sourceCode" id="cb7" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/scatterplotMatrix.html">scatterplotMatrix</a></span><span class="op">(</span><span class="op">~</span> <span class="va">Speed</span> <span class="op">+</span> <span class="va">Attention</span> <span class="op">+</span> <span class="va">Memory</span> <span class="op">+</span> <span class="va">Verbal</span> <span class="op">+</span> <span class="va">Visual</span> <span class="op">+</span> <span class="va">ProbSolv</span> <span class="op">|</span> <span class="va">Dx</span>,</span>
<span>  data<span class="op">=</span><span class="va">NeuroCog</span>,</span>
<span>  plot.points <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  smooth <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  col <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pal_hue.html">hue_pal</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>  ellipse<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>levels<span class="op">=</span><span class="fl">0.68</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-NC-scatmat" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/fig-NC-scatmat-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;11.3: Scatterplot matrix of the <code>NeuroCog</code> data. Points are suppressed here, focusing on the data ellipses and regression lines. Colors for the groups: Schizophrenic (red), SchizoAffective (green), Normal (blue)</figcaption></figure>
</div>
</div>
</div>
<p>In this figure, we can see that the regression lines have similar slopes and similar data ellipses for the groups, though with a few exceptions.</p>
<p><strong>TODO</strong>: Should we add biplot here?</p>
</section></section></section><section id="fitting-the-mlm" class="level2" data-number="11.2"><h2 data-number="11.2" class="anchored" data-anchor-id="fitting-the-mlm">
<span class="header-section-number">11.2</span> Fitting the MLM</h2>
<p>We proceed to fit the one-way MANOVA model.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">NC.mlm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">Speed</span>, <span class="va">Attention</span>, <span class="va">Memory</span>, <span class="va">Verbal</span>, <span class="va">Visual</span>, <span class="va">ProbSolv</span><span class="op">)</span> <span class="op">~</span> <span class="va">Dx</span>,</span>
<span>             data<span class="op">=</span><span class="va">NeuroCog</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html">Anova</a></span><span class="op">(</span><span class="va">NC.mlm</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type II MANOVA Tests: Pillai test statistic</span></span>
<span><span class="co">#&gt;    Df test stat approx F num Df den Df  Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; Dx  2     0.299     6.89     12    470 1.6e-11 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The first research question is captured by the contrasts for the <code>Dx</code> factor shown above. We can test these with <code><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html">car::linearHypothesis()</a></code>. The contrast <code>Dx1</code> for control vs.&nbsp;the diagnosed groups is highly significant,</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># control vs. patients</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html">linearHypothesis</a></span><span class="op">(</span><span class="va">NC.mlm</span>, <span class="st">"Dx1"</span><span class="op">)</span>, SSP<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multivariate Tests: </span></span>
<span><span class="co">#&gt;                  Df test stat approx F num Df den Df  Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; Pillai            1     0.289     15.9      6    234 2.8e-15 ***</span></span>
<span><span class="co">#&gt; Wilks             1     0.711     15.9      6    234 2.8e-15 ***</span></span>
<span><span class="co">#&gt; Hotelling-Lawley  1     0.407     15.9      6    234 2.8e-15 ***</span></span>
<span><span class="co">#&gt; Roy               1     0.407     15.9      6    234 2.8e-15 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>but the second contrast, <code>Dx2</code>, comparing the schizophrenic and schizoaffective group, is not.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Schizo vs SchizAff</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html">linearHypothesis</a></span><span class="op">(</span><span class="va">NC.mlm</span>, <span class="st">"Dx2"</span><span class="op">)</span>, SSP<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multivariate Tests: </span></span>
<span><span class="co">#&gt;                  Df test stat approx F num Df den Df Pr(&gt;F)</span></span>
<span><span class="co">#&gt; Pillai            1     0.006    0.249      6    234   0.96</span></span>
<span><span class="co">#&gt; Wilks             1     0.994    0.249      6    234   0.96</span></span>
<span><span class="co">#&gt; Hotelling-Lawley  1     0.006    0.249      6    234   0.96</span></span>
<span><span class="co">#&gt; Roy               1     0.006    0.249      6    234   0.96</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="he-plot" class="level3" data-number="11.2.1"><h3 data-number="11.2.1" class="anchored" data-anchor-id="he-plot">
<span class="header-section-number">11.2.1</span> HE plot</h3>
<p>So the question becomes: how to understand these results.<br><code><a href="https://friendly.github.io/heplots/reference/heplot.html">heplot()</a></code> shows the visualization of the multivariate model in the space of two response variables (the first two by default). The result (<a href="#fig-NC-HEplot">Figure&nbsp;<span>11.4</span></a>) tells a very simple story: The control group performs higher on higher measures than the diagnosed groups, which do not differ between themselves.</p>
<p>(For technical reasons, to abbreviate the group labels in the plot, we need to <code><a href="https://rdrr.io/r/stats/update.html">update()</a></code> the MLM model after the labels are reassigned.)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># abbreviate levels for plots</span></span>
<span><span class="va">NeuroCog</span><span class="op">$</span><span class="va">Dx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">NeuroCog</span><span class="op">$</span><span class="va">Dx</span>, </span>
<span>                      labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Schiz"</span>, <span class="st">"SchAff"</span>, <span class="st">"Contr"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">NC.mlm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">NC.mlm</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb12" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">+</span><span class="fl">.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://friendly.github.io/heplots/reference/heplot.html">heplot</a></span><span class="op">(</span><span class="va">NC.mlm</span>, </span>
<span>       fill<span class="op">=</span><span class="cn">TRUE</span>, fill.alpha<span class="op">=</span><span class="fl">0.1</span>,</span>
<span>       cex.lab<span class="op">=</span><span class="fl">1.3</span>, cex<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-NC-HEplot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/fig-NC-HEplot-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;11.4: HE plot of Speed and Attention in the MLM for the <code>NeuroCog</code> data. The labeled points show the means of the groups on the two variables. The blue H ellipse for groups indicates the strong positive correlation of the group means.</figcaption></figure>
</div>
</div>
</div>
<p>This pattern is consistent across all of the response variables, as we see from a plot of <code>pairs(NC.mlm)</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb13" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">NC.mlm</span>, </span>
<span>      fill<span class="op">=</span><span class="cn">TRUE</span>, fill.alpha<span class="op">=</span><span class="fl">0.1</span>,</span>
<span>      var.cex<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-NC-HE-pairs" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/fig-NC-HE-pairs-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;11.5: HE plot matrix of the MLM for <code>NeuroCog</code> data.</figcaption></figure>
</div>
</div>
</div>
</section><section id="canonical-space" class="level3" data-number="11.2.2"><h3 data-number="11.2.2" class="anchored" data-anchor-id="canonical-space">
<span class="header-section-number">11.2.2</span> Canonical space</h3>
<p>We can gain further insight, and a simplified plot showing all the response variables by projecting the MANOVA into the canonical space, which is entirely 2-dimensional (because <span class="math inline">\(df_h=2\)</span>). However, the output from <code><a href="https://rdrr.io/pkg/candisc/man/candisc.html">candisc()</a></code> shows that 98.5% of the mean differences among groups can be accounted for in one canonical dimension. ::: {.cell layout-align=“center”}</p>
<div class="sourceCode" id="cb14" data-code-line-numbers=""><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">NC.can</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/candisc/man/candisc.html">candisc</a></span><span class="op">(</span><span class="va">NC.mlm</span><span class="op">)</span></span>
<span><span class="va">NC.can</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Canonical Discriminant Analysis for Dx:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    CanRsq Eigenvalue Difference Percent Cumulative</span></span>
<span><span class="co">#&gt; 1 0.29295    0.41433      0.408    98.5       98.5</span></span>
<span><span class="co">#&gt; 2 0.00625    0.00629      0.408     1.5      100.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test of H0: The canonical correlations in the </span></span>
<span><span class="co">#&gt; current row and all that follow are zero</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   LR test stat approx F numDF denDF Pr(&gt; F)    </span></span>
<span><span class="co">#&gt; 1        0.703     7.53    12   468   9e-13 ***</span></span>
<span><span class="co">#&gt; 2        0.994     0.30     5   235    0.91    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>:::</p>
<p><a href="#fig-NC-candisc">Figure&nbsp;<span>11.6</span></a> is the result of the <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> method for class <code>"candisc"</code> objects, that is, the result of calling <code>plot(NC.can, ...)</code>. It plots the two canonical scores, <span class="math inline">\(\mathbf{Z}_{n \times 2}\)</span> for the subjects, together with data ellipses for each of the three groups.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb15" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"darkgreen"</span>, <span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">+</span><span class="fl">.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">NC.can</span>, </span>
<span>     ellipse<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>     rev.axes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>,<span class="cn">FALSE</span><span class="op">)</span>, </span>
<span>     pch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">9</span>,<span class="fl">10</span><span class="op">)</span>,</span>
<span>     var.cex<span class="op">=</span><span class="fl">1.2</span>, cex.lab<span class="op">=</span><span class="fl">1.5</span>, var.lwd<span class="op">=</span><span class="fl">2</span>,  scale<span class="op">=</span><span class="fl">4.5</span>, </span>
<span>     col<span class="op">=</span><span class="va">col</span>,</span>
<span>       var.col<span class="op">=</span><span class="st">"black"</span>, var.pos<span class="op">=</span><span class="va">pos</span>,</span>
<span>     prefix<span class="op">=</span><span class="st">"Canonical dimension "</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-NC-candisc" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/fig-NC-candisc-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;11.6: Canonical discriminant plot for the <code>NeuroCog</code> data MANOVA. Scores on the two canonical dimensions are plotted, together with 68% data ellipses for each group.</figcaption></figure>
</div>
</div>
</div>
<p>The interpretation of <a href="#fig-NC-candisc">Figure&nbsp;<span>11.6</span></a> is again fairly straightforward. As noted earlier (REF???), the projections of the variable vectors in this plot on the coordinate axes are proportional to the correlations of the responses with the canonical scores. From this, we see that the normal group differs from the two patient groups, having higher scores on all the neurocognitive variables, most of which are highyl correlated. The problem solving measure is slightly different, and this, compared to the cluster of memory, verbal and attention, is what distinguishes the schizophrenic group from the schizoaffectives.</p>
<p>The separation of the groups is essentially one-dimensional, with the control group higher on all measures. Moreover, the variables processing speed and visual memory are the purest measures of this dimension, but all variables contribute positively. The second canonical dimension accounts for only 1.5% of group mean differences and is non-significant (by a likelihood ratio test). Yet, if we were to interpret it, we would note that the schizophrenia group is slightly higher on this dimension, scoring better in problem solving and slightly worse on working memory, attention, and verbal learning tasks.</p>
<p><strong>Summary</strong></p>
<p>This analysis gives a very simple description of the data, in relation to the research questions posed earlier:</p>
<ul>
<li><p>On the basis of these neurocognitive tests, the schizophrenic and schizoaffective groups do not differ significantly overall, but these groups differ greatly from the normal controls.</p></li>
<li><p>All cognitive domains distinguish the groups in the same direction, with the greatest differences shown for the variables most closely aligned with the horizontal axis in <a href="#fig-NC-candisc">Figure&nbsp;<span>11.6</span></a>.</p></li>
</ul></section></section><section id="social-cognitive-measures" class="level2" data-number="11.3"><h2 data-number="11.3" class="anchored" data-anchor-id="social-cognitive-measures">
<span class="header-section-number">11.3</span> Social cognitive measures</h2>
<p>The social cognitive measures were designed to tap various aspects of the perception and cognitive processing of emotions of others. Emotion perception was assessed using a Managing Emotions score from the MCCB. A “theory of mind” (<code>ToM</code>) score assessed ability to read the emotions of others from photographs of the eye region of male and female faces. Two other measures, externalizing bias (<code>ExtBias</code>) and personalizing bias (<code>PersBias</code>) were calculated from a scale measuring the degree to which individuals attribute internal, personal or situational causal attributions to positive and negative social events.</p>
<p>The analysis of the <code>SocialCog</code> data proceeds in a similar way: first we fit the MANOVA model, then test the overall differences among groups using <code><a href="https://rdrr.io/pkg/car/man/Anova.html">Anova()</a></code>. We find that the overall multivariate test is again significant,</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb16" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">SocialCog</span>, package<span class="op">=</span><span class="st">"heplots"</span><span class="op">)</span></span>
<span><span class="va">SC.mlm</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">MgeEmotions</span>,<span class="va">ToM</span>, <span class="va">ExtBias</span>, <span class="va">PersBias</span><span class="op">)</span> <span class="op">~</span> <span class="va">Dx</span>,</span>
<span>               data<span class="op">=</span><span class="va">SocialCog</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html">Anova</a></span><span class="op">(</span><span class="va">SC.mlm</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type II MANOVA Tests: Pillai test statistic</span></span>
<span><span class="co">#&gt;    Df test stat approx F num Df den Df  Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; Dx  2     0.212     3.97      8    268 0.00018 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Testing the same two contrasts using <code><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html">linearHypothesis()</a></code> (results not shown), w e find that the overall multivariate test is again significant, but now <em>both</em> contrasts are significant (Dx1: <span class="math inline">\(F(4, 133)=5.21, p &lt; 0.001\)</span>; Dx2: <span class="math inline">\(F(4, 133)=2.49, p = 0.0461\)</span>), the test for <code>Dx2</code> just barely.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb17" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># control vs. patients</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html">linearHypothesis</a></span><span class="op">(</span><span class="va">SC.mlm</span>, <span class="st">"Dx1"</span><span class="op">)</span>, SSP<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># Schizo vs. SchizAff</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html">linearHypothesis</a></span><span class="op">(</span><span class="va">SC.mlm</span>, <span class="st">"Dx2"</span><span class="op">)</span>, SSP<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These results are important, because, if they are reliable and make sense substantively, they imply that patients with schizophrenia and schizoaffective diagnoses <em>can</em> be distinguished by their performance on tasks assessing social perception and cognition. This was potentially a new finding in the literature on schizophrenia.</p>
<p>As we did above, it is useful to visualize the nature of these differences among groups with HE plots for the <code>SC.mlm</code> model. Each contrast has a corresponding <span class="math inline">\(\mathbf{H}\)</span> ellipse, which we can show in the plot using the <code>hypotheses</code> argument. With a single degree of freedom, these degenerate ellipses plot as lines.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb18" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">+</span><span class="fl">.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://friendly.github.io/heplots/reference/heplot.html">heplot</a></span><span class="op">(</span><span class="va">SC.mlm</span>, </span>
<span>       hypotheses<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"Dx1"</span><span class="op">=</span><span class="st">"Dx1"</span>, <span class="st">"Dx2"</span><span class="op">=</span><span class="st">"Dx2"</span><span class="op">)</span>,</span>
<span>       fill<span class="op">=</span><span class="cn">TRUE</span>, fill.alpha<span class="op">=</span><span class="fl">.1</span>,</span>
<span>       cex.lab<span class="op">=</span><span class="fl">1.5</span>, cex<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-SC-HEplot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/fig-SC-HEplot-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;11.7: HE plot of Speed and Attention in the MLM for the <code>SocialCog</code> data. The labeled points show the means of the groups on the two variables. The lines for Dx1 and Dx2 show the tests of the contrasts among groups.</figcaption></figure>
</div>
</div>
</div>
<p>It can be seen that the three group means are approximately equally spaced on the <code>ToM</code> measure, whereas for <code>MgeEmotions</code>, the control and schizoaffective groups are quite similar, and both are higher than the schizophrenic group. This ordering of the three groups was somewhat similar for the other responses, as we could see in a <code>pairs(SC.mlm)</code> plot.</p>
<section id="model-checking" class="level3" data-number="11.3.1"><h3 data-number="11.3.1" class="anchored" data-anchor-id="model-checking">
<span class="header-section-number">11.3.1</span> Model checking</h3>
<p>Normally, we would continue this analysis, and consider other HE and canonical discriminant plots to further interpret the results, in particular the relations of the cognitive measures to group differences, or perhaps an analysis of the relationships between the neuro- and social-cognitive measures. We don’t pursue this here for reasons of length, but this example actually has a more important lesson to demonstrate.</p>
<p>Before beginning the MANOVA analyses, extensive data screening was done by the client using SPSS, in which all the response <em>and</em> predictor variables were checked for univariate normality and multivariate normality (MVN) for both sets. This traditional approach yielded a huge amount of tabular output and no graphs, and did not indicate any major violation of assumptions.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>A simple visual test of MVN and the possible presence of multivariate outliers is related to the theory of the data ellipse: Under MVN, the squared Mahalanobis distances <span class="math inline">\(D^2_M (\mathbf{y}) = (\mathbf{y} - \bar{\mathbf{y}})' \, \mathbf{S}^{-1} \, (\mathbf{y} - \bar{\mathbf{y}})\)</span> should follow a <span class="math inline">\(\chi^2_p\)</span> distribution. Thus, a quantile-quantile plot of the ordered <span class="math inline">\(D^2_M\)</span> values vs.&nbsp;corresponding quantiles of the <span class="math inline">\(\chi^2\)</span> distribution should approximate a straight line <span class="citation" data-cites="Cox:1968 Healy:1968:MNP">(<a href="90-references.html#ref-Cox:1968" role="doc-biblioref">Cox, 1968</a>; <a href="90-references.html#ref-Healy:1968:MNP" role="doc-biblioref">Healy, 1968</a>)</span>. Note that this should be applied to the <em>residuals</em> from the model – <code>residuals(SC.mlm)</code> – and not to the response variables directly.</p>
<p><code><a href="https://friendly.github.io/heplots/reference/cqplot.html">heplots::cqplot()</a></code> implements this for <code>"mlm"</code> objects Calling this function for the model <code>SC.mlm</code> produces <a href="#fig-SC-cqplot">Figure&nbsp;<span>11.8</span></a>. It is immediately apparent that there is one extreme multivariate outlier; three other points are identified, but the remaining observations are nearly within the 95% confidence envelope (using a robust MVE estimate of <span class="math inline">\(\mathbf{S}\)</span>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb19" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">+</span><span class="fl">.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://friendly.github.io/heplots/reference/cqplot.html">cqplot</a></span><span class="op">(</span><span class="va">SC.mlm</span>, method<span class="op">=</span><span class="st">"mve"</span>, </span>
<span>       id.n<span class="op">=</span><span class="fl">4</span>, </span>
<span>       main<span class="op">=</span><span class="st">""</span>, </span>
<span>       cex.lab<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-SC-cqplot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/fig-SC-cqplot-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;11.8: Chi-square quantile-quantile plot for residuals from the model <code>SC.mlm</code>. The confidence band gives a point-wise 95% envelope, providing information about uncertainty. One extreme multivariate outlier is highlighted.</figcaption></figure>
</div>
</div>
</div>
<p>Further checking revealed that this was a data entry error where one case (15) in the schizophrenia group had a score of -33 recorded on the <code>ExtBias</code> measure, whose valid range was (-10, +10). In R, it is very easy to re-fit a model to a subset of observations (rather than modifying the dataset itself) using <code><a href="https://rdrr.io/r/stats/update.html">update()</a></code>. The result of the overall Anova and the test of <code>Dx1</code> were unchanged; however, the multivariate test for the most interesting contrast <code>Dx2</code> comparing the schizophrenia and schizoaffective groups became non-significant at the <span class="math inline">\(\alpha=0.05\)</span> level (<span class="math inline">\(F(4, 133)=2.18, p = 0.0742\)</span>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb20" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">SC.mlm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">SC.mlm</span>, </span>
<span>                  subset<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">SocialCog</span><span class="op">)</span><span class="op">!=</span><span class="st">"15"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html">Anova</a></span><span class="op">(</span><span class="va">SC.mlm1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html">linearHypothesis</a></span><span class="op">(</span><span class="va">SC.mlm1</span>, <span class="st">"Dx1"</span><span class="op">)</span>, SSP<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html">linearHypothesis</a></span><span class="op">(</span><span class="va">SC.mlm1</span>, <span class="st">"Dx2"</span><span class="op">)</span>, SSP<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="canonical-he-plot" class="level3" data-number="11.3.2"><h3 data-number="11.3.2" class="anchored" data-anchor-id="canonical-he-plot">
<span class="header-section-number">11.3.2</span> Canonical HE plot</h3>
<p>This outcome creates a bit of a quandry for further analysis (do univariate follow-up tests? try a robust model?) and reporting (what to claim about the <code>Dx2</code> contrast?) that we don’t explore here. Rather, we proceed to attempt to interpret the MLM with the aid of canonical analysis and a canonical HE plot. The canonical analysis of the model <code>SC.mlm1</code> now shows that both canonical dimensions are significant, and account for 83.9% and 16.1% of between group mean differences respectively.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb21" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">SC.can1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/candisc/man/candisc.html">candisc</a></span><span class="op">(</span><span class="va">SC.mlm1</span><span class="op">)</span></span>
<span><span class="va">SC.can1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Canonical Discriminant Analysis for Dx:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   CanRsq Eigenvalue Difference Percent Cumulative</span></span>
<span><span class="co">#&gt; 1 0.1645     0.1969      0.159    83.9       83.9</span></span>
<span><span class="co">#&gt; 2 0.0364     0.0378      0.159    16.1      100.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test of H0: The canonical correlations in the </span></span>
<span><span class="co">#&gt; current row and all that follow are zero</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   LR test stat approx F numDF denDF Pr(&gt; F)    </span></span>
<span><span class="co">#&gt; 1        0.805     3.78     8   264 0.00032 ***</span></span>
<span><span class="co">#&gt; 2        0.964     1.68     3   133 0.17537    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb22" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">+</span><span class="fl">.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://friendly.github.io/heplots/reference/heplot.html">heplot</a></span><span class="op">(</span><span class="va">SC.can1</span>, </span>
<span>    fill<span class="op">=</span><span class="cn">TRUE</span>, fill.alpha<span class="op">=</span><span class="fl">.1</span>,</span>
<span>    hypotheses<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"Dx1"</span><span class="op">=</span><span class="st">"Dx1"</span>, <span class="st">"Dx2"</span><span class="op">=</span><span class="st">"Dx2"</span><span class="op">)</span>,</span>
<span>    lwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"darkgreen"</span>, <span class="st">"darkgreen"</span><span class="op">)</span>,</span>
<span>    var.lwd<span class="op">=</span><span class="fl">2</span>, </span>
<span>    var.col<span class="op">=</span><span class="st">"black"</span>, </span>
<span>    label.pos<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span>, </span>
<span>    var.cex<span class="op">=</span><span class="fl">1.2</span>, </span>
<span>    cex<span class="op">=</span><span class="fl">1.25</span>, cex.lab<span class="op">=</span><span class="fl">1.2</span>, </span>
<span>    scale<span class="op">=</span><span class="fl">2.8</span>,</span>
<span>    prefix<span class="op">=</span><span class="st">"Canonical dimension "</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-SC1-hecan" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/fig-SC1-hecan-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;11.9: Canonical HE plot for the corrected <code>SocialCog</code> MANOVA. The variable vectors show the correlations of the responses with the canonical variables. The embedded green lines show the projections of the <strong>H</strong> ellipses for the contrasts <code>Dx1</code> and <code>Dx2</code> in canonical space.</figcaption></figure>
</div>
</div>
</div>
<p>The HE plot version of this canonical plot is shown in <a href="#fig-SC1-hecan">Figure&nbsp;<span>11.9</span></a>. Because the <code><a href="https://friendly.github.io/heplots/reference/heplot.html">heplot()</a></code> method for a <code>"candisc"</code> object refits the original model to the <span class="math inline">\(\mathbf{Z}\)</span> canonical scores, it is easy to also project other linear hypotheses into this space. Note that in this view, both the <code>Dx1</code> and <code>Dx2</code> contrasts project outside <span class="math inline">\(\mathbf{E}\)</span> ellipse.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>.</p>
<p>This canonical HE plot has a very simple description:</p>
<ul>
<li>Dimension 1 orders the groups from control to schizoaffective to schizophrenia, while dimension 2 separates the schizoaffective group from the others;</li>
<li>Externalizing bias and theory of mind contributes most to the first dimension, while personal bias and managing emotions are more aligned with the second; and,</li>
<li>The relations of the two contrasts to group differences and to the response variables can be easily read from this plot.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb23" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#cat("Packages used here:\n")</span></span>
<span><span class="fu">write_pkgs</span><span class="op">(</span>file <span class="op">=</span> <span class="va">.pkg_file</span><span class="op">)</span></span>
<span><span class="co">#&gt; 17  packages used here:</span></span>
<span><span class="co">#&gt;  base, broom, candisc, car, carData, corrgram, datasets, dplyr, ggplot2, graphics, grDevices, heplots, knitr, methods, stats, tidyr, utils</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="references" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="references">References</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="list" style="display: none">
<div id="ref-Cox:1968" class="csl-entry" role="listitem">
Cox, D. R. (1968). Notes on some aspects of regression analysis. <em>Journal of the Royal Statistical Society Series A</em>, <em>131</em>, 265–279.
</div>
<div id="ref-Friendly:02:corrgram" class="csl-entry" role="listitem">
Friendly, M. (2002). Corrgrams: Exploratory displays for correlation matrices. <em>The American Statistician</em>, <em>56</em>(4), 316–324. <a href="https://doi.org/10.1198/000313002533">https://doi.org/10.1198/000313002533</a>
</div>
<div id="ref-FriendlyKwan:03:effect" class="csl-entry" role="listitem">
Friendly, M., &amp; Kwan, E. (2003). Effect ordering for data displays. <em>Computational Statistics and Data Analysis</em>, <em>43</em>(4), 509–539. <a href="https://doi.org/10.1016/S0167-9473(02)00290-6">https://doi.org/10.1016/S0167-9473(02)00290-6</a>
</div>
<div id="ref-Hartman:2016" class="csl-entry" role="listitem">
Hartman, L. I. (2016). <em>Schizophrenia and schizoaffective disorder: One condition or two?</em> [PhD dissertation]. York University.
</div>
<div id="ref-Healy:1968:MNP" class="csl-entry" role="listitem">
Healy, M. J. R. (1968). Multivariate normal plotting. <em>Journal of the Royal Statistical Society Series C</em>, <em>17</em>(2), 157–161.
</div>
<div id="ref-Heinrichs-etal:2015" class="csl-entry" role="listitem">
Heinrichs, R. W., Pinnock, F., Muharib, E., Hartman, L., Goldberg, J., &amp; McDermid Vaz, S. (2015). Neurocognitive normality in schizophrenia revisited. <em>Schizophrenia Research: Cognition</em>, <em>2</em>(4), 227–232. <a href="https://doi.org/10.1016/j.scog.2015.09.001">https://doi.org/10.1016/j.scog.2015.09.001</a>
</div>
<div id="ref-Mardia:1970:MMS" class="csl-entry" role="listitem">
Mardia, K. V. (1970). Measures of multivariate skewness and kurtosis with applications. <em>Biometrika</em>, <em>57</em>(3), 519–530. https://doi.org/<a href="http://dx.doi.org/10.2307/2334770">http://dx.doi.org/10.2307/2334770</a>
</div>
<div id="ref-Mardia:1974" class="csl-entry" role="listitem">
Mardia, K. V. (1974). Applications of some measures of multivariate skewness and kurtosis in testing normality and robustness studies. <em>Sankhya: The Indian Journal of Statistics, Series B</em>, <em>36</em>(2), 115–128. <a href="http://www.jstor.org/stable/25051892">http://www.jstor.org/stable/25051892</a>
</div>
</div>
</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>Actually, multivariate normality of the predictors in <span class="math inline">\(\mathbf{X}\)</span> is not required in the MLM. This assumption applies only to the conditional values <span class="math inline">\(\mathbf{Y} \;|\; \mathbf{X}\)</span>, i.e., that the errors <span class="math inline">\(\mathbf{u}_{i}' \sim \mathcal{N}_{p}(\mathbf{0},\boldsymbol{\Sigma})\)</span> with constant covariance matrix. Moreover, the widely used MVN test statistics, such as Mardia’s <span class="citation" data-cites="Mardia:1970:MMS">(<a href="90-references.html#ref-Mardia:1970:MMS" role="doc-biblioref">1970</a>)</span> test based on multivariate skewness and kurtosis are known to be quite sensitive to mild departures in kurtosis <span class="citation" data-cites="Mardia:1974">(<a href="90-references.html#ref-Mardia:1974" role="doc-biblioref">Mardia, 1974</a>)</span> which do not threaten the validity of the multivariate tests.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>The direct application of significance tests to canonical scores probably requires some adjustment because these are computed to have the optimal between-group discrimination.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./mlm-review.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Brief review of the multivariate linear model</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./eqcov.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Visualizing Tests for Equality of Covariance Matrices</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<script src="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.js" defer="true"></script>
</body></html>