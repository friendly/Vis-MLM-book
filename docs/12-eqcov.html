<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.29">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>12&nbsp; Visualizing Equality of Covariance Matrices – Visualizing Multivariate Data and Models in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./13-case-studies.html" rel="next">
<link href="./11-mlm-viz.html" rel="prev">
<link href="./images/favicon/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-0815c480559380816a4d1ea211a47e91.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-b5345210c3a79db27e5ded64c8911254.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./09-hotelling.html">Multivariate Linear Models</a></li><li class="breadcrumb-item"><a href="./12-eqcov.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Visualizing Equality of Covariance Matrices</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./09-hotelling.html">Multivariate Linear Models</a></li><li class="breadcrumb-item"><a href="./12-eqcov.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Visualizing Equality of Covariance Matrices</span></a></li></ol></nav>
      <h1 class="title"><span id="sec-eqcov" class="quarto-section-identifier"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Visualizing Equality of Covariance Matrices</span></span></h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Visualizing Multivariate Data and Models in R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/friendly/vis-MLM-book" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Orienting Ideas</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-getting_started.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Started</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Exploratory Methods</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-multivariate_plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Plots of Multivariate Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-pca-biplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Dimension Reduction</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Univariate Linear Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-linear_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Overview of Linear models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-linear_models-plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Plots for univariate response models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-lin-mod-topics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Topics in Linear Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-collinearity-ridge.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Collinearity &amp; Ridge Regression</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Multivariate Linear Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-hotelling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Hotelling’s <span class="math inline">\(T^2\)</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-mlm-review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Multivariate Linear Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-mlm-viz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Visualizing Multivariate Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-eqcov.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Visualizing Equality of Covariance Matrices</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-case-studies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Case studies</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">End matter</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./91-colophon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Colophon</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./95-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#sec-homogeneity-ANOVA" id="toc-sec-homogeneity-ANOVA" class="nav-link active" data-scroll-target="#sec-homogeneity-ANOVA"><span class="header-section-number">12.1</span> Homogeneity of Variance in Univariate ANOVA</a></li>
  <li><a href="#sec-mlevene" id="toc-sec-mlevene" class="nav-link" data-scroll-target="#sec-mlevene"><span class="header-section-number">12.2</span> Visualizing Levene’s test</a></li>
  <li><a href="#sec-homogeneity-MANOVA" id="toc-sec-homogeneity-MANOVA" class="nav-link" data-scroll-target="#sec-homogeneity-MANOVA"><span class="header-section-number">12.3</span> Homogeneity of variance in MANOVA</a></li>
  <li><a href="#sec-boxM" id="toc-sec-boxM" class="nav-link" data-scroll-target="#sec-boxM"><span class="header-section-number">12.4</span> Testing heterogeneity of covariance matrices: Box’s M test</a></li>
  <li><a href="#visualizing-heterogeneity" id="toc-visualizing-heterogeneity" class="nav-link" data-scroll-target="#visualizing-heterogeneity"><span class="header-section-number">12.5</span> Visualizing heterogeneity</a></li>
  <li><a href="#visualizing-boxs-mathcalm" id="toc-visualizing-boxs-mathcalm" class="nav-link" data-scroll-target="#visualizing-boxs-mathcalm"><span class="header-section-number">12.6</span> Visualizing Box’s <span class="math inline">\(\mathcal{M}\)</span></a></li>
  <li><a href="#low-rank-views" id="toc-low-rank-views" class="nav-link" data-scroll-target="#low-rank-views"><span class="header-section-number">12.7</span> Low-rank views</a></li>
  <li><a href="#other-measures-of-heterogeneity" id="toc-other-measures-of-heterogeneity" class="nav-link" data-scroll-target="#other-measures-of-heterogeneity"><span class="header-section-number">12.8</span> Other measures of heterogeneity</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/friendly/vis-MLM-book/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content"><!--- For HTML Only ---><!-- \require{newcommand} --><!-- %\renewcommand*{\det}[1]{\mathrm{det} (#1)} --><!-- %\renewcommand*{\det}[1]{|#1|} --><!-- \newcommand{\sizedmat}[2]{\mathord{\mathop{\mat{#1}}\limits_{(#2)}}} --><!-- \newcommand*{\E}{\mathcal{E}} --><!-- Index generation --><!-- % R packages:  indexed under both package name and packages! --><!-- % data sets:  --><!-- % R stuff --><blockquote class="blockquote">
<p><em>To make the preliminary test on variances is rather like putting to sea in a rowing boat to find out whether conditions are sufficiently calm for an ocean liner to leave port.</em> — G. E. P. Box <span class="citation" data-cites="Box:1953">(<a href="95-references.html#ref-Box:1953" role="doc-biblioref">1953</a>)</span></p>
</blockquote>
<p>This chapter concerns the extension of tests of homogeneity of variance from the classical univariate ANOVA setting to the analogous multivariate (MANOVA) setting. Such tests are a routine but important aspect of data analysis, as particular violations can drastically impact model estimates and appropriate conclusions that can be drawn <span class="citation" data-cites="Lix:1996">(<a href="95-references.html#ref-Lix:1996" role="doc-biblioref">Lix &amp; Keselman, 1996</a>)</span>.</p>
<p>Beyond issues of model assumptions, the question of equality of covariance matrices is often of general interest itself. For instance, variability is often an important issue in studies of strict equivalence in laboratories comparing across multiple patient measurements and in other applied contexts <span class="citation" data-cites="Gastwirth-etal:2009">(see <a href="95-references.html#ref-Gastwirth-etal:2009" role="doc-biblioref">Gastwirth et al., 2009</a> for other exemplars)</span>.</p>
<p>Moreover the outcome of such tests often have important consequences for the details of a main method of analysis. Just as the Welsh <span class="math inline">\(t\)</span>-test <span class="citation" data-cites="Welch:1947">(<a href="95-references.html#ref-Welch:1947" role="doc-biblioref">Welch, 1947</a>)</span> is now commonly used and reported for a two-group test of differences in means under <em>unequal</em> variances, a preliminary test of equality of covariance matrices is often used in discriminant analysis to decide whether linear (LDA) or quadratic discriminant analysis (QDA) should be applied in a given problem. In such cases, the data at hand should inform the choice of statistical analysis to utilize.</p>
<p>We provide some answers to the following questions:</p>
<ul>
<li><p><strong>Visualization</strong>: How can we visualize differences among group variances and covariance matrices, perhaps in a way that is analogous to what is done to visualize differences among group means? As will be illustrated, differences among covariance matrices can be comprised of spread in overall size (“scatter”) and shape (“orientation”). These can be seen in data space with data ellipses, particularly if the data is centered by shifting all groups to the grand mean,</p></li>
<li><p><strong>Low-D views</strong>: When there are more than a few response variables, what low-dimensional views can show the most interesting properties related to the equality of covariance matrices? Projecting the data into the space of the principal components serves well again here. Surprisingly, we will see that the <em>small dimensions</em> contain useful information about differences among the group covariance matrices, similar to what we find for outlier detection.</p></li>
<li><p><strong>Other statistics</strong>: Box’s <span class="math inline">\(M\)</span>-test is most widely used. Are there other worthwhile test statistics? We will see that graphics methods suggest alternatives.</p></li>
</ul>
<p>The following subsections provide a capsule summary of the issues in this topic. Most of the discussion is couched in terms of a one-way design for simplicity, but the same ideas can apply to two-way (and higher) designs, where a “group” factor is defined as the product combination (interaction) of two or more factor variables.</p>
<p>When there are also numeric covariates, this topic can also be extended to the multivariate analysis of covariance (MANCOVA) setting. This is accomplished simply by applying these techniques to the residuals from predictions by the covariates alone.</p>
<p><strong>Packages</strong></p>
<p>In this chapter we use the following packages. Load them now</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://friendly.github.io/heplots/">heplots</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/friendly/candisc/">candisc</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="sec-homogeneity-ANOVA" class="level2" data-number="12.1"><h2 data-number="12.1" class="anchored" data-anchor-id="sec-homogeneity-ANOVA">
<span class="header-section-number">12.1</span> Homogeneity of Variance in Univariate ANOVA</h2>
<p>In classical (Gaussian) univariate ANOVA models, the main interest is typically on tests of mean differences in a response <span class="math inline">\(y\)</span> according to one or more factors. The validity of the typical <span class="math inline">\(F\)</span> test, however, relies on the assumption of <em>homogeneity of variance</em>: all groups have the same (or similar) variance, <span class="math display">\[
\sigma_1^2 = \sigma_2^2 = \cdots = \sigma_g^2 \; .
\]</span></p>
<p>It turns out that the <span class="math inline">\(F\)</span> test for differences in means is relatively robust to violation of this assumption <span class="citation" data-cites="Harwell:1992">(<a href="95-references.html#ref-Harwell:1992" role="doc-biblioref">Harwell et al., 1992</a>)</span>, as long as the group sample sizes are roughly equal.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> This applies to Type I error <span class="math inline">\(\alpha\)</span> rates, which are not much affected. However, unequal variance makes the ANOVA tests less efficient: you lose power to detect significant differences.</p>
<p>A variety of classical test statistics for homogeneity of variance are available, including Hartley’s <span class="math inline">\(F_{max}\)</span> <span class="citation" data-cites="Hartley:1950">(<a href="95-references.html#ref-Hartley:1950" role="doc-biblioref">Hartley, 1950</a>)</span>, Cochran’s <em>C</em> <span class="citation" data-cites="Cochran:1941">(<a href="95-references.html#ref-Cochran:1941" role="doc-biblioref">Cochran, 1941</a>)</span>,and Bartlett’s test <span class="citation" data-cites="Bartlett:1937">(<a href="95-references.html#ref-Bartlett:1937" role="doc-biblioref">Bartlett, 1937</a>)</span>, but these have been found to have terrible statistical properties <span class="citation" data-cites="Rogan:1977">(<a href="95-references.html#ref-Rogan:1977" role="doc-biblioref">Rogan &amp; Keselman, 1977</a>)</span>, which prompted Box’s famous quote.</p>
<p>Levene <span class="citation" data-cites="Levene:1960">(<a href="95-references.html#ref-Levene:1960" role="doc-biblioref">1960</a>)</span> introduced a different form of test, based on the simple idea that when variances are equal across groups, the average <em>absolute values</em> of differences between the observations and group means will also be equal, i.e., substituting an <span class="math inline">\(L_1\)</span> norm for the <span class="math inline">\(L_2\)</span> norm of variance. In a one-way design, this is equivalent to a test of group differences in the means of the auxilliary variable <span class="math inline">\(z_{ij} = | y_{ij} - \bar{y}_i |\)</span>.</p>
<p>More robust versions of this test were proposed by <span class="citation" data-cites="BrownForsythe:1974">Brown &amp; Forsythe (<a href="95-references.html#ref-BrownForsythe:1974" role="doc-biblioref">1974</a>)</span>. These tests substitute the group mean by either the group <strong>median</strong> or a <strong>trimmed mean</strong> in the ANOVA of the absolute deviations. Some suggest these should be almost always preferred to Levene’s version using the mean deviation. See <span class="citation" data-cites="Conover-etal:1981">Conover et al. (<a href="95-references.html#ref-Conover-etal:1981" role="doc-biblioref">1981</a>)</span> for an early review and <span class="citation" data-cites="Gastwirth-etal:2009">Gastwirth et al. (<a href="95-references.html#ref-Gastwirth-etal:2009" role="doc-biblioref">2009</a>)</span> for a general discussion of these tests. In what follows, we refer to this class of tests as “Levene-type” tests and suggest a multivariate extension described below (<a href="#sec-mlevene" class="quarto-xref"><span>Section 12.2</span></a>).</p>
<p>These deviations from a group central can be calculated using <code><a href="https://friendly.github.io/heplots/reference/colDevs.html">heplots::colDevs()</a></code> and the central value can be a function, like <code>mean</code>, <code>median</code> or an anonymous one like <code>function(x) mean(x, trim = 0.1))</code> that trims 10% off each side of the distribution. With a response <code>Y</code> Levene’s test then be performed “by hand” as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Z.mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span> <span class="fu"><a href="https://friendly.github.io/heplots/reference/colDevs.html">colDevs</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">group</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Z.mean</span> <span class="op">~</span> <span class="va">group</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Z.med</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span> <span class="fu"><a href="https://friendly.github.io/heplots/reference/colDevs.html">colDevs</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">group</span>, <span class="va">median</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Z.med</span> <span class="op">~</span> <span class="va">group</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The function <code><a href="https://rdrr.io/pkg/car/man/leveneTest.html">car::leveneTest()</a></code> does this, so we could examine whether the variances are equal in the Penguin variables, one at a time, like so:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">peng</span>, package <span class="op">=</span> <span class="st">"heplots"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/leveneTest.html">leveneTest</a></span><span class="op">(</span><span class="va">bill_length</span> <span class="op">~</span> <span class="va">species</span>, data<span class="op">=</span><span class="va">peng</span><span class="op">)</span></span>
<span><span class="co">#&gt; Levene's Test for Homogeneity of Variance (center = median)</span></span>
<span><span class="co">#&gt;        Df F value Pr(&gt;F)</span></span>
<span><span class="co">#&gt; group   2    2.29    0.1</span></span>
<span><span class="co">#&gt;       330</span></span>
<span></span>
<span><span class="co"># ...</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/leveneTest.html">leveneTest</a></span><span class="op">(</span><span class="va">body_mass</span> <span class="op">~</span> <span class="va">species</span>, data<span class="op">=</span><span class="va">peng</span><span class="op">)</span></span>
<span><span class="co">#&gt; Levene's Test for Homogeneity of Variance (center = median)</span></span>
<span><span class="co">#&gt;        Df F value Pr(&gt;F)   </span></span>
<span><span class="co">#&gt; group   2    5.13 0.0064 **</span></span>
<span><span class="co">#&gt;       330                  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>More conveniently, <code>heplots:leveneTests()</code> with an “s”, does this for each of a set of response variables, specified in a data frame, a model formula or a <code>"mlm"</code> object. It also formats the results in a more pleasing way:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">peng.mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">bill_length</span>, <span class="va">bill_depth</span>, <span class="va">flipper_length</span>, <span class="va">body_mass</span><span class="op">)</span> <span class="op">~</span> <span class="va">species</span>, </span>
<span>               data <span class="op">=</span> <span class="va">peng</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://friendly.github.io/heplots/reference/leveneTests.html">leveneTests</a></span><span class="op">(</span><span class="va">peng.mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; Levene's Tests for Homogeneity of Variance (center = median)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                df1 df2 F value Pr(&gt;F)   </span></span>
<span><span class="co">#&gt; bill_length      2 330    2.29 0.1033   </span></span>
<span><span class="co">#&gt; bill_depth       2 330    1.91 0.1494   </span></span>
<span><span class="co">#&gt; flipper_length   2 330    0.44 0.6426   </span></span>
<span><span class="co">#&gt; body_mass        2 330    5.13 0.0064 **</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>So, this tells us that the groups do not differ in variances on first three variables, but they do for <code>body_mass</code>.</p>
</section><section id="sec-mlevene" class="level2" data-number="12.2"><h2 data-number="12.2" class="anchored" data-anchor-id="sec-mlevene">
<span class="header-section-number">12.2</span> Visualizing Levene’s test</h2>
<p>To gain some insight into the problem of homogeneity of variance it is helpful how the situation looks in terms of data. For the Penguin data, it might be simplest just just to look at boxplots of the variables and try to see whether the <strong>widths</strong> of the central 50% boxes seem to be the same, as in <a href="#fig-peng-boxplots" class="quarto-xref">Figure&nbsp;<span>12.1</span></a>. However, it is perceptually difficult to focus on differences with widths of the boxes within each panel when their centers also differ from group to group.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>See the code</summary><div class="sourceCode" id="cb5" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"R/penguin/penguin-colors.R"</span><span class="op">)</span></span>
<span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu">peng.colors</span><span class="op">(</span><span class="st">"dark"</span><span class="op">)</span></span>
<span><span class="va">clr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">col</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html">gray</a></span><span class="op">(</span><span class="fl">.20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">peng_long</span> <span class="op">&lt;-</span> <span class="va">peng</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">bill_length</span><span class="op">:</span><span class="va">body_mass</span>, </span>
<span>               names_to <span class="op">=</span> <span class="st">"variable"</span>, </span>
<span>               values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">peng_long</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">value</span>, <span class="va">species</span>, fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">variable</span>, scales <span class="op">=</span> <span class="st">'free_x'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_penguins</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">'none'</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-peng-boxplots" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-peng-boxplots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figs/ch12/fig-peng-boxplots-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-peng-boxplots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.1: Boxplots for the Penguin variables. For assessing homogeneity of variance, we should be looking for differences in width of the central 50% boxes in each panel, rather than difference in central tendency.
</figcaption></figure>
</div>
</div>
</div>
<p>Instead, you can see more <em>directly</em> what is tested by the Levene test by graphing the <em>absolute deviations</em> from the group means or medians. This is another example of the graphic idea that to make visual comparisons easier by plotting quantities of direct interest. You can calculate these values as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bill_length"</span>, <span class="st">"bill_depth"</span>, <span class="st">"flipper_length"</span>, <span class="st">"body_mass"</span><span class="op">)</span></span>
<span><span class="va">pengDevs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://friendly.github.io/heplots/reference/colDevs.html">colDevs</a></span><span class="op">(</span><span class="va">peng</span><span class="op">[</span>, <span class="va">vars</span><span class="op">]</span>, <span class="va">peng</span><span class="op">$</span><span class="va">species</span>, <span class="va">median</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>From a boxplot of the absolute deviations in <a href="#fig-peng-devplots" class="quarto-xref">Figure&nbsp;<span>12.2</span></a> your eye can now focus on the central value, shown by the <strong>median</strong> ‘|’ line, because Levene’s method is testing whether these differ across groups.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>See the code</summary><div class="sourceCode" id="cb7" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># calculate absolute differences from median</span></span>
<span><span class="va">dev_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>species <span class="op">=</span> <span class="va">peng</span><span class="op">$</span><span class="va">species</span>, <span class="va">pengDevs</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">bill_length</span><span class="op">:</span><span class="va">body_mass</span>, </span>
<span>               names_to <span class="op">=</span> <span class="st">"variable"</span>, </span>
<span>               values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">dev_long</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">value</span>, <span class="va">species</span>, fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">variable</span>, scales <span class="op">=</span> <span class="st">'free_x'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"absolute median deviation"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_penguins</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">'none'</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-peng-devplots" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-peng-devplots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figs/ch12/fig-peng-devplots-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-peng-devplots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.2: Boxplots for absolute differences from group medians for the Penguin data.
</figcaption></figure>
</div>
</div>
</div>
<p>It is now easy to see that the medians largely align for all the variables except for <code>body_mass</code>.</p>
</section><section id="sec-homogeneity-MANOVA" class="level2" data-number="12.3"><h2 data-number="12.3" class="anchored" data-anchor-id="sec-homogeneity-MANOVA">
<span class="header-section-number">12.3</span> Homogeneity of variance in MANOVA</h2>
<p>In the MANOVA context, the main emphasis, of course, is on differences among mean vectors, testing <span class="math display">\[
\mathcal{H}_0 : \mathbf{\mu}_1 = \mathbf{\mu}_2 = \cdots = \mathbf{\mu}_g \; .
\]</span> However, the standard test statistics (Wilks’ Lambda, Hotelling-Lawley trace, Pillai-Bartlett trace, Roy’s maximum root) rely upon the analogous assumption that the within-group covariance <strong>matrices</strong> <span class="math inline">\(\mathbf{\Sigma}_i\)</span> are equal for all groups, <span class="math display">\[
\mathbf{\Sigma}_1 = \mathbf{\Sigma}_2 = \cdots = \mathbf{\Sigma}_g \; .
\]</span> This is much stronger than in the univariate case, because it also requires that all the correlations between pairs of variables are the same for all groups. For example, for two responses, there are three parameters (<span class="math inline">\(\rho, \sigma_1^2, \sigma_2^2\)</span>) assumed equal across all groups; for <span class="math inline">\(p\)</span> responses, there are <span class="math inline">\(p (p+1) / 2\)</span> assumed equal. The variances relate to <em>size</em> differences among data ellipses while the differences in the covariances appear as differences in <em>shape</em>.</p>
<!--
For example, in the case of two responses,
we must assume:

$$
\begin{pmatrix} 
\sigma_1^2             & \textsf{sym} \\ 
\rho \sigma_1 \sigma_2 & \sigma_2^2   \\ 
\end{pmatrix}_1 = 
\begin{pmatrix} 
\sigma_1^2             & \textsf{sym} \\ 
\rho \sigma_1 \sigma_2 & \sigma_2^2   \\ 
\end{pmatrix}_2 = \dots =
\begin{pmatrix} 
\sigma_1^2             & \textsf{sym} \\ 
\rho \sigma_1 \sigma_2 & \sigma_2^2   \\ 
\end{pmatrix}
_g
$$
-->
<!-- **Insert** pairs covEllipses for penguins data -->
<p>To preview the main example, <a href="#fig-peng-covEllipse0" class="quarto-xref">Figure&nbsp;<span>12.3</span></a> shows data ellipses for the main size variables in the <code><a href="https://allisonhorst.github.io/palmerpenguins/reference/penguins.html">palmerpenguins::penguins</a></code> data. <code><a href="https://friendly.github.io/heplots/reference/covEllipses.html">heplots::covEllipses()</a></code> is specialized for viewing the relations among the data ellipsoids representing the sample covariance matrices, <span class="math inline">\(\mathbf{S}_1 = \mathbf{S}_2 = \cdots = \mathbf{S}_g\)</span>. It draws the data ellipse for each group, and also for the pooled within-group <span class="math inline">\(\mathbf{S}_p\)</span>, as shown in <a href="#fig-peng-covEllipse0" class="quarto-xref">Figure&nbsp;<span>12.3</span></a> for bill length and bill depth.</p>
<p>You can see that the sizes and shapes of the data ellipses are sort of similar in the left panel. The visual comparison becomes more precise when the data ellipses are all shifted to a common origin at the grand means (using <code>center = TRUE</code>). From this you can see that the Adelie group differs most from the others.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>See the code</summary><div class="sourceCode" id="cb8" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">.5</span>,</span>
<span>          mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://friendly.github.io/heplots/reference/covEllipses.html">covEllipses</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">bill_length</span>, <span class="va">bill_depth</span><span class="op">)</span> <span class="op">~</span> <span class="va">species</span>, data<span class="op">=</span><span class="va">peng</span>,</span>
<span>  fill <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fill.alpha <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  lwd <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  col <span class="op">=</span> <span class="va">clr</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://friendly.github.io/heplots/reference/covEllipses.html">covEllipses</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">bill_length</span>, <span class="va">bill_depth</span><span class="op">)</span> <span class="op">~</span> <span class="va">species</span>, data<span class="op">=</span><span class="va">peng</span>,</span>
<span>  center <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>  fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">FALSE</span>,<span class="fl">3</span><span class="op">)</span>, <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>  fill.alpha <span class="op">=</span> <span class="fl">.1</span>, </span>
<span>  lwd <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  col <span class="op">=</span> <span class="va">clr</span>,</span>
<span>  label.pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-peng-covEllipse0" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-peng-covEllipse0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figs/ch12/fig-peng-covEllipse0-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-peng-covEllipse0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.3: Data ellipses for bill length and bill depth in the penguins data, also showing the pooled covariance. Left: As is; right: centered at the grand means for easier comparison.
</figcaption></figure>
</div>
</div>
</div>
<p>All pairwise plots in scatterplot matrix format are produced using the <code>variables</code> argument.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">clr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu">peng.colors</span><span class="op">(</span><span class="op">)</span>, <span class="st">"black"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://friendly.github.io/heplots/reference/covEllipses.html">covEllipses</a></span><span class="op">(</span><span class="va">peng</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>, <span class="va">peng</span><span class="op">$</span><span class="va">species</span>, </span>
<span>  variables<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,</span>
<span>  col <span class="op">=</span> <span class="va">clr</span>,</span>
<span>  fill<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>  fill.alpha<span class="op">=</span><span class="fl">.1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-peng-covEllipse-pairs" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-peng-covEllipse-pairs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figs/ch12/fig-peng-covEllipse-pairs-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-peng-covEllipse-pairs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.4: All pairwise covariance ellipses for the penguins data.
</figcaption></figure>
</div>
</div>
</div>
<p>They covariance ellipses look pretty similar in size, shape and orientation. But what does Box’s M test (described below) say? As you can see, it concludes strongly against the null hypothesis.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://friendly.github.io/heplots/reference/boxM.html">boxM</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">bill_length</span>, <span class="va">bill_depth</span>, <span class="va">flipper_length</span>, <span class="va">body_mass</span><span class="op">)</span> <span class="op">~</span> <span class="va">species</span>, data<span class="op">=</span><span class="va">peng</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Box's M-test for Homogeneity of Covariance Matrices</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  Y</span></span>
<span><span class="co">#&gt; Chi-Sq (approx.) = 75, df = 20, p-value = 3e-08</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-boxM" class="level2" data-number="12.4"><h2 data-number="12.4" class="anchored" data-anchor-id="sec-boxM">
<span class="header-section-number">12.4</span> Testing heterogeneity of covariance matrices: Box’s M test</h2>
<p><span class="citation" data-cites="Box:1949">Box (<a href="95-references.html#ref-Box:1949" role="doc-biblioref">1949</a>)</span> proposed the following likelihood-ratio test (LRT) statistic <span class="math inline">\(\mathcal{M}\)</span> for testing the hypothesis of equal covariance matrices, <span id="eq-boxm"><span class="math display">\[
\mathcal{M} = (N -g) \ln \;|\; \mathbf{S}_p \;|\; - \sum_{i=1}^g (n_i -1) \ln \;|\; \mathbf{S}_i \;|\; \; ,
\tag{12.1}\]</span></span></p>
<p>where <span class="math inline">\(N = \sum n_i\)</span> is the total sample size and</p>
<p><span class="math display">\[\mathbf{S}_p = (N-g)^{-1} \sum_{i=1}^g (n_i - 1) \mathbf{S}_i\]</span></p>
<p>is the pooled covariance matrix.</p>
<p><span class="math inline">\(\mathcal{M}\)</span> can thus be thought of as a ratio of the determinant of the pooled <span class="math inline">\(\mathbf{S}_p\)</span> to the geometric mean of the determinants of the separate <span class="math inline">\(\mathbf{S}_i\)</span>.</p>
<p>In practice, there are various transformations of the value of <span class="math inline">\(M\)</span> to yield a test statistic with an approximately known distribution <span class="citation" data-cites="Timm:75">(<a href="95-references.html#ref-Timm:75" role="doc-biblioref">Timm, 1975</a>)</span>. Roughly speaking, when each <span class="math inline">\(n_i &gt; 20\)</span>, a <span class="math inline">\(\chi^2\)</span> approximation is often used; otherwise an <span class="math inline">\(F\)</span> approximation is known to be more accurate.</p>
<p>Asymptotically, <span class="math inline">\(-2 \ln (\mathcal{M})\)</span> has a <span class="math inline">\(\chi^2\)</span> distribution. The <span class="math inline">\(\chi^2\)</span> approximation due to Box <span class="citation" data-cites="Box:1949 Box:1950">(<a href="95-references.html#ref-Box:1949" role="doc-biblioref">1949</a>, <a href="95-references.html#ref-Box:1950" role="doc-biblioref">1950</a>)</span> is that <span class="math display">\[
X^2 = -2 (1-c_1) \ln (\mathcal{M}) \quad \sim \quad \chi^2_{df}
\]</span> with <span class="math inline">\(df = (g-1) p (p+1)/2\)</span> degrees of freedom, and a bias correction constant: <span class="math display">\[
c_1 = \left(
\sum_i \frac{1}{n_i -1}
- \frac{1}{N-g}
\right)
\frac{2p^2 +3p -1}{6 (p+1)(g-1)} \; .
\]</span></p>
<p>In this form, Bartlett’s test for equality of variances in the univariate case is the special case of Box’s M when there is only one response variable, so Bartlett’s test is sometimes used as univariate follow-up to determine which response variables show heterogeneity of variance.</p>
<p>Yet, like its univariate counterpart, Box’s test is well-known to be highly sensitive to violation of (multivariate) normality and the presence of outliers. For example, <span class="citation" data-cites="TikuBalakrishnan:1984">Tiku &amp; Balakrishnan (<a href="95-references.html#ref-TikuBalakrishnan:1984" role="doc-biblioref">1984</a>)</span> concluded from simulation studies that the normal-theory LRT provides poor control of Type I error under even modest departures from normality. <span class="citation" data-cites="OBrien:1992">O’Brien (<a href="95-references.html#ref-OBrien:1992" role="doc-biblioref">1992</a>)</span> proposed some robust alternatives, and showed that Box’s normal theory approximation suffered both in controlling the null size of the test and in power. <span class="citation" data-cites="ZhangBoos:1992:BCV">Zhang &amp; Boos (<a href="95-references.html#ref-ZhangBoos:1992:BCV" role="doc-biblioref">1992</a>)</span> also carried out simulation studies with similar conclusions and used bootstrap methods to obtain corrected critical values.</p>
</section><section id="visualizing-heterogeneity" class="level2" data-number="12.5"><h2 data-number="12.5" class="anchored" data-anchor-id="visualizing-heterogeneity">
<span class="header-section-number">12.5</span> Visualizing heterogeneity</h2>
<p>The goal of this chapter is to use the above background as a platform for discussing approaches to visualizing and testing the heterogeneity of covariance matrices in multivariate designs. While researchers often rely on a single number to determine if their data have met a particular threshold, such compression will often obscure interesting information, particularly when a test concludes that differences exist, and one is left to wonder ``why?’’. It is within this context where, again, visualizations often reign supreme. In fact, we find it somewhat surprising that this issue has not been addressed before graphically in any systematic way. <strong>TODO: cut this down</strong></p>
<p>In what follows, we propose three visualization-based approaches to questions of heterogeneity of covariance in MANOVA designs:</p>
<ol type="a">
<li><p>direct visualization of the information in the <span class="math inline">\(\mathbf{S}_i\)</span> and <span class="math inline">\(\mathbf{S}_p\)</span> using <em>data ellipsoids</em> to show size and shape as minimal schematic summaries;</p></li>
<li><p>a simple dotplot of the components of Box’s M test: the log determinants of the <span class="math inline">\(\mathbf{S}_i\)</span> together with that of the pooled <span class="math inline">\(\mathbf{S}_p\)</span>. Extensions of these simple plots raise the question of whether measures of heterogeneity other than that captured in Box’s test might also be useful; and,</p></li>
<li><p>the connection between Levene-type tests and an ANOVA (of centered absolute differences) suggests a parallel with a multivariate extension of Levene-type tests and a MANOVA. We explore this with a version of Hypothesis-Error (HE) plots we have found useful for visualizing mean differences in MANOVA designs.</p></li>
</ol></section><section id="visualizing-boxs-mathcalm" class="level2" data-number="12.6"><h2 data-number="12.6" class="anchored" data-anchor-id="visualizing-boxs-mathcalm">
<span class="header-section-number">12.6</span> Visualizing Box’s <span class="math inline">\(\mathcal{M}\)</span>
</h2>
<p>Box’s test is based on a comparison of the log determinants of the <span class="math inline">\(\mathbf{S}_i\)</span> relative to that of the pooled <span class="math inline">\(\mathbf{S}_p\)</span>, so the simplest thing to do is just plot them!</p>
</section><section id="low-rank-views" class="level2" data-number="12.7"><h2 data-number="12.7" class="anchored" data-anchor-id="low-rank-views">
<span class="header-section-number">12.7</span> Low-rank views</h2>
<p>With <span class="math inline">\(p&gt;3\)</span> response variables, a simple alternative to the pairwise 2D projections shown in is the projection into the principal component space accounting for the greatest amounts of total variance in the data. For the Iris data, a simple PCA of the covariance matrix shows that nearly 98% of total variance in the data is accounted for in the first two dimensions.</p>
</section><section id="other-measures-of-heterogeneity" class="level2" data-number="12.8"><h2 data-number="12.8" class="anchored" data-anchor-id="other-measures-of-heterogeneity">
<span class="header-section-number">12.8</span> Other measures of heterogeneity</h2>
<p><strong>Packages used here</strong></p>
<div class="cell" data-layout-align="center">
<pre data-code-line-numbers=""><code>#&gt; Writing packages to  C:/R/Projects/Vis-MLM-book/bib/pkgs.txt
#&gt; 9  packages used here:
#&gt;  broom, candisc, car, carData, dplyr, ggplot2, heplots, knitr, tidyr</code></pre>
</div>
<!-- ## References -->


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-Bartlett:1937" class="csl-entry" role="listitem">
Bartlett, M. S. (1937). Properties of sufficiency and statistical tests. <em>Proceedings of the Royal Society of London. Series A</em>, <em>160</em>(901), 268–282. <a href="https://doi.org/10.2307/96803">https://doi.org/10.2307/96803</a>
</div>
<div id="ref-Box:1949" class="csl-entry" role="listitem">
Box, G. E. P. (1949). A general distribution theory for a class of likelihood criteria. <em>Biometrika</em>, <em>36</em>(3-4), 317–346. <a href="https://doi.org/10.1093/biomet/36.3-4.317">https://doi.org/10.1093/biomet/36.3-4.317</a>
</div>
<div id="ref-Box:1950" class="csl-entry" role="listitem">
Box, G. E. P. (1950). <a href="">Problems in the analysis of growth and wear curves</a>. <em>Biometrics</em>, <em>6</em>, 362–389.
</div>
<div id="ref-Box:1953" class="csl-entry" role="listitem">
Box, G. E. P. (1953). Non-normality and tests on variances. <em>Biometrika</em>, <em>40</em>(3/4), 318–335. <a href="https://doi.org/10.2307/2333350">https://doi.org/10.2307/2333350</a>
</div>
<div id="ref-BrownForsythe:1974" class="csl-entry" role="listitem">
Brown, M. B., &amp; Forsythe, A. B. (1974). Robust tests for equality of variances. <em>Journal of the American Statistical Association</em>, <em>69</em>(346), 364–367. <a href="https://doi.org/10.1080/01621459.1974.10482955">https://doi.org/10.1080/01621459.1974.10482955</a>
</div>
<div id="ref-Cochran:1941" class="csl-entry" role="listitem">
Cochran, W. G. (1941). The distribution of the largest of a set of estimated variances as a fraction of their total. <em>Annals of Eugenics</em>, <em>11</em>(1), 47–52. <a href="https://doi.org/10.1111/j.1469-1809.1941.tb02271.x">https://doi.org/10.1111/j.1469-1809.1941.tb02271.x</a>
</div>
<div id="ref-Conover-etal:1981" class="csl-entry" role="listitem">
Conover, W. J., Johnson, M. E., &amp; Johnson, M. M. (1981). A comparative study of tests for homogeneity of variances, with applications to the outer continental shelf bidding data. <em>Technometrics</em>, <em>23</em>(4), 351–361. <a href="https://doi.org/10.1080/00401706.1981.10487680">https://doi.org/10.1080/00401706.1981.10487680</a>
</div>
<div id="ref-Gastwirth-etal:2009" class="csl-entry" role="listitem">
Gastwirth, J. L., Gel, Y. R., &amp; Miao, W. (2009). The impact of <span class="nocase">Levene’s</span> test of equality of variances on statistical theory and practice. <em>Statistical Science</em>, <em>24</em>(3), 343–360. <a href="https://doi.org/10.1214/09-STS301">https://doi.org/10.1214/09-STS301</a>
</div>
<div id="ref-Hartley:1950" class="csl-entry" role="listitem">
Hartley, H. O. (1950). The use of range in analysis of variance. <em>Biometrika</em>, <em>37</em>(3–4), 271–280. <a href="https://doi.org/10.1093/biomet/37.3-4.271">https://doi.org/10.1093/biomet/37.3-4.271</a>
</div>
<div id="ref-Harwell:1992" class="csl-entry" role="listitem">
Harwell, M. R., Rubinstein, E. N., Hayes, W. S., &amp; Olds, C. C. (1992). Summarizing monte carlo results in methodological research: The one- and two-factor fixed effects <span>ANOVA</span> cases. <em>Journal of Educational and Behavioral Statistics</em>, <em>17</em>(4), 315–339. <a href="https://doi.org/10.3102/10769986017004315">https://doi.org/10.3102/10769986017004315</a>
</div>
<div id="ref-Levene:1960" class="csl-entry" role="listitem">
Levene, H. (1960). Robust tests for equality of variances. In I. Olkin, S. G. Ghurye, W. Hoeffding, W. G. Madow, &amp; H. B. Mann (Eds.), <em>Contributions to probability and statistics: Essays in honor of <span>Harold Hotelling</span></em> (pp. 278–292). Stanford University Press.
</div>
<div id="ref-Lix:1996" class="csl-entry" role="listitem">
Lix, J. M., L. M. Keselman, &amp; Keselman, H. J. (1996). Consequences of assumption violations revisited: A quantitative review of alternatives to the one-way analysis of variance <span>F</span> test. <em>Review of Educational Research</em>, <em>66</em>(4), 579–619. <a href="https://doi.org/10.3102/00346543066004579">https://doi.org/10.3102/00346543066004579</a>
</div>
<div id="ref-OBrien:1992" class="csl-entry" role="listitem">
O’Brien, P. C. (1992). Robust procedures for testing equality of covariance matrices. <em>Biometrics</em>, <em>48</em>(3), 819–827. <a href="http://www.jstor.org/stable/2532347">http://www.jstor.org/stable/2532347</a>
</div>
<div id="ref-Rogan:1977" class="csl-entry" role="listitem">
Rogan, J. C., &amp; Keselman, H. J. (1977). Is the <span>ANOVA</span> f-test robust to variance heterogeneity when sample sizes are equal?: An investigation via a coefficient of variation. <em>American Educational Research Journal</em>, <em>14</em>(4), 493–498. <a href="https://doi.org/10.3102/00028312014004493">https://doi.org/10.3102/00028312014004493</a>
</div>
<div id="ref-TikuBalakrishnan:1984" class="csl-entry" role="listitem">
Tiku, M. L., &amp; Balakrishnan, N. (1984). Testing equality of population variances the robust way. <em>Communications in Statistics - Theory and Methods</em>, <em>13</em>(17), 2143–2159. <a href="https://doi.org/10.1080/03610928408828818">https://doi.org/10.1080/03610928408828818</a>
</div>
<div id="ref-Timm:75" class="csl-entry" role="listitem">
Timm, N. H. (1975). <em>Multivariate analysis with applications in education and psychology</em>. Wadsworth (Brooks/Cole).
</div>
<div id="ref-Welch:1947" class="csl-entry" role="listitem">
Welch, B. L. (1947). The generalization of "student’s" problem when several different population varlances are involved. <em>Biometrika</em>, <em>34</em>(1–2), 28–35. <a href="https://doi.org/10.1093/biomet/34.1-2.28">https://doi.org/10.1093/biomet/34.1-2.28</a>
</div>
<div id="ref-ZhangBoos:1992:BCV" class="csl-entry" role="listitem">
Zhang, J., &amp; Boos, D. D. (1992). Bootstrap critical values for testing homogeneity of covariance matrices. <em>Journal of the American Statistical Association</em>, <em>87</em>(418), 425–429. <a href="http://www.jstor.org/stable/2290273">http://www.jstor.org/stable/2290273</a>
</div>
</div>
</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>If group sizes are greatly unequal <strong>and</strong> homogeneity of variance is violated, then the <span class="math inline">\(F\)</span> statistic is too liberal (<span class="math inline">\(p\)</span> values too large) when large sample variances are associated with small group sizes. Conversely, the <span class="math inline">\(F\)</span> statistic is too conservative if large variances are associated with large group sizes.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./11-mlm-viz.html" class="pagination-link" aria-label="Visualizing Multivariate Models">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Visualizing Multivariate Models</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./13-case-studies.html" class="pagination-link" aria-label="Case studies">
        <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Case studies</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/friendly/vis-MLM-book/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer><script src="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.js" defer="true"></script>
</body></html>