<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.29">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Michael Friendly">
<meta name="dcterms.date" content="2025-10-16">
<title>Visualizing Multivariate Data and Models in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./00-Author.html" rel="next">
<link href="./images/favicon/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-0815c480559380816a4d1ea211a47e91.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-17e746a5a36f38a88c5f5cc681d9ba3d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./index.html">Preface</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Visualizing Multivariate Data and Models in R</h1>
            <p class="subtitle lead">A Romance in Many Dimensions</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p><a href="https://datavis.ca">Michael Friendly</a> </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 16, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Visualizing Multivariate Data and Models in R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/friendly/vis-MLM-book" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-Author.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Author</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Orienting Ideas</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-Prelude.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Warm-up Exercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-getting_started.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Started</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Exploratory Methods</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-multivariate_plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Plots of Multivariate Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-pca-biplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Dimension Reduction</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Univariate Linear Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-linear_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Overview of Linear models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-linear_models-plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Plots for Univariate Response Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-lin-mod-topics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Topics in Linear Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-collinearity-ridge.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Collinearity &amp; Ridge Regression</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Multivariate Linear Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-hotelling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Hotelling’s <span class="math inline">\(T^2\)</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-mlm-review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Multivariate Linear Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-mlm-viz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Visualizing Multivariate Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-eqcov.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Visualizing Equality of Covariance Matrices</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-infl-robust.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Multiviate Influence and Robust Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-case-studies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Case Studies</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">End Matter</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./91-colophon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Colophon</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./95-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#preface" id="toc-preface" class="nav-link active" data-scroll-target="#preface">Preface</a>
  <ul class="collapse">
<li><a href="#features" id="toc-features" class="nav-link" data-scroll-target="#features">Features</a></li>
  <li><a href="#what-i-assume" id="toc-what-i-assume" class="nav-link" data-scroll-target="#what-i-assume">What I assume</a></li>
  <li><a href="#r-resources" id="toc-r-resources" class="nav-link" data-scroll-target="#r-resources">R Resources</a></li>
  <li><a href="#r-graphics-resources" id="toc-r-graphics-resources" class="nav-link" data-scroll-target="#r-graphics-resources">R graphics resources</a></li>
  <li><a href="#r-coding-style-used-here" id="toc-r-coding-style-used-here" class="nav-link" data-scroll-target="#r-coding-style-used-here">R coding style used here</a></li>
  <li><a href="#typographic-conventions-used-in-this-book" id="toc-typographic-conventions-used-in-this-book" class="nav-link" data-scroll-target="#typographic-conventions-used-in-this-book">Typographic conventions used in this book</a></li>
  <li><a href="#acknowledgements" id="toc-acknowledgements" class="nav-link" data-scroll-target="#acknowledgements">Acknowledgements</a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/friendly/vis-MLM-book/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content"><p><img src="images/cover/cover-peng.jpg" title="Visualizing Multivariate Data and Models in R" class="quarto-cover-image nolightbox img-fluid"></p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Welcome to the online version of <em>Visualizing Multivariate Data and Models with R</em>.</p>
<p>This book will be published by <a href="https://www.routledge.com/corporate/about-us/crc-press">CRC Press</a>.</p>
</div>
</div>
</div>
<section id="preface" class="level1 unnumbered"><h1 class="unnumbered">Preface</h1>
<!-- **TODO**: Make this a more general introduction -->
<p>This book is about graphical methods developed recently for multivariate data, and their uses in understanding relationships when there are several aspects to be considered together. Data visualization methods for statistical analysis are well-developed and widely available in R for simple linear models with a single outcome variable, as well as for more complex models with nonlinear effects, hierarchical data with observations grouped within larger units and so forth.</p>
<p>However, with applied research in the sciences, social and behavioral in particular, it is often the case that the phenomena of interest (e.g., depression, job satisfaction, academic achievement, childhood ADHD disorders, etc.) can be measured in several different ways or related <em>aspects</em>. Understanding how these different aspects are <em>related</em> can be crucial to our knowledge of the general phenomenon.</p>
<p>For example, if academic achievement can be measured for adolescents by reading, mathematics, science and history scores, how do predictors such as parental encouragement, school environment and socioeconomic status affect all these outcomes? In a similar way? In different ways? In such cases, much more can be understood from a multivariate approach that considers the correlations among the outcomes. Yet, sadly, researchers typically examine the outcomes one by one which often only tells part of the data story.</p>
<p>However, to convey the statistical and graphic methods to do these things, I begin with some warm-up exercises in multivariate thinking, with a grand scheme for statistics and data visualization, a parable, and an example of multivariate discovery.</p>
<p><strong>TODO</strong>: Include an overview of the parts and chapters somewhere here</p>
<!-- {r child="child/00-one-two-many.qmd"} -->
<!--
::: {.callout-warning}
The material in the following subsections are meant to provide motivation for the book and some perspectives that inform it.
These will be moved to a following front-matter chapter, **Preludes**.
:::
-->
<!-- {r child="child/00-flatland.qmd"} -->
<!-- {r child="child/00-eureka.qmd"} -->
<section id="features" class="level2"><h2 class="anchored" data-anchor-id="features">Features</h2>
<p>Some key substantive and pedagogical features of the book are:</p>
<ul>
<li><p>The writing style is purposely pedagogical (hopefully not too pedantic), in that it aims to teach <strong>how to think</strong> about analysis and graphics for multivariate data. That is, I try to convey how you can achieve <em>understanding</em> of statistical concepts and data visualization through ways of <em>representing those ideas</em> in diagrams and plots, and producing graphics using R functions and packages.</p></li>
<li><p>To help understand the how modern statistical and graphic methods became more powerful over time, the book takes a <strong>historical perspective</strong>, where it is useful to convey how the innovations we use today evolved.</p></li>
<li><p>Statistical data visualization is cast in a general framework by their <strong>goal</strong> for communicating information, either to your self or others (such as see the <em>data</em>, visualize a <em>model</em>, diagnose <em>problems</em>), rather than a categorization by <strong>graphic types</strong> like bar charts and line graphs. This is best informed by the principles and goals of <strong>communication</strong>, for example making graphic comparison easy and ordering factors and variables according to what should be seen, called <em>effect ordering</em> for data display <span class="citation" data-cites="FriendlyKwan:03:effect">(<a href="#ref-FriendlyKwan:03:effect" role="doc-biblioref">Friendly &amp; Kwan, 2003</a>)</span>. </p></li>
<li><p>Data visualization is seen as a combination of <strong>exposure</strong>—plotting the raw data—and <strong>summarization</strong>— plotting statistical summaries—to highlight what should be noticed. For example, data ellipses and confidence ellipses are widely used as simple, effective summaries of data and fitted model parameters. When the data is complex, the idea of <strong>visual thinning</strong> can be used to balance the tradeoff. </p></li>
<li><p>The book exploits the rich connections among <strong>statistics</strong>, <strong>geometry</strong> and <strong>data visualization</strong>. Statistical ideas, particularly for multivariate data, can be more easily understood in terms of geometrical ones that can be seen in diagrams and data displays. More importantly, ideas from one domain can amplify what we can understand from another.</p></li>
<li><p>These graphical tools can be used to understand or explain a wide variety of statistical concepts, phenomena, and paradoxes such as Simpson’s paradox (<a href="#sec-simpsons" class="quarto-xref"><span class="quarto-unresolved-ref">sec-simpsons</span></a>), effects of measurement error (<a href="#sec-meas-error" class="quarto-xref"><span class="quarto-unresolved-ref">sec-meas-error</span></a>), bias-variance tradeoff (<a href="#sec-bias-variance" class="quarto-xref"><span class="quarto-unresolved-ref">sec-bias-variance</span></a>), and so forth.</p></li>
<li><p>The HE (“hypothesis - error”) plot framework provides a simple way to understand the results of statistical tests and the relations among response outcomes in the multivariate linear model.</p></li>
<li><p>Dimension reduction techniques such as PCA and discriminant analysis are presented as “multivariate juicers”, able to squeeze the important information in high-dimensional data into informative two-dimensional views. But sometimes, the most important information for a problem lies in the smallest dimensions, as is the case in outlier detection (<a href="#sec-multivar-normality" class="quarto-xref"><span class="quarto-unresolved-ref">sec-multivar-normality</span></a>), collinearity (<a href="#sec-collin-biplots" class="quarto-xref"><span class="quarto-unresolved-ref">sec-collin-biplots</span></a>) and ridge regression (<a href="#sec-ridge-low-rank" class="quarto-xref"><span class="quarto-unresolved-ref">sec-ridge-low-rank</span></a>).</p></li>
</ul></section><section id="what-i-assume" class="level2"><h2 class="anchored" data-anchor-id="what-i-assume">What I assume</h2>
<p>It is assumed that the reader has at least a basic background in <em>applied, intermediate</em> statistics. This would normally include material on simple and multiple regression as well as simple analysis of variance (ANOVA) designs. This also means that you should be familiar with the basic ideas of statistical inference including hypothesis tests and confidence intervals. <!-- **TODO**: Complete this required background --></p>
<p>There will also be some mathematics in the book where words and diagrams are not enough. The mathematical level will be intermediate, mostly consisting of simple algebra. No derivations, proofs, theorems here!</p>
<p>For multivariate methods, it will be useful to express ideas using <strong>matrix notation</strong> to simplify presentation. It will be enough for you to recognize that a single symbol <span class="math inline">\(\mathbf{y}\)</span> can be a shorthand for <span class="math inline">\(n\)</span> scores on a variable like weight, and the symbol <span class="math inline">\(\mathbf{X}\)</span> can represent an entire data table, with, say <span class="math inline">\(n\)</span> observations on <span class="math inline">\(p\)</span> variables like height, body mass index, diet components, and so forth. Then, the notation <span class="math inline">\(\mathbf{y} = \mathbf{X} \boldsymbol{\beta}\)</span> represents an entire linear model to relate weight to these other variables. I’m using this math notation to express ideas, and all you will need is a reading-level of understanding.</p>
<p>For this, the first chapter of <span class="citation" data-cites="Fox2021">Fox (<a href="#ref-Fox2021" role="doc-biblioref">2021</a>)</span>, <em>A Mathematical Primer for Social Statistics</em>, is excellent, and the rest is well worth reading. If you want to learn something of using matrix algebra for data analysis and statistics in R, I recommend our package <span style="color: brown;"><strong>matlib</strong></span> <span class="citation" data-cites="R-matlib">(<a href="#ref-R-matlib" role="doc-biblioref">Friendly et al., 2024</a>)</span>.</p>
</section><section id="r-resources" class="level2"><h2 class="anchored" data-anchor-id="r-resources">R Resources</h2>
<p>I also assume the reader to have at least a basic familiarity with statistical analysis in R. While R fundamentals are outside the scope of the book, I believe that this language provides a rich set of resources, far beyond that offered by other statistical software packages, and is well worth learning. For those not familiar with R or wish to learn new skills, I recommend:</p>
<ul>
<li>Cotton <span class="citation" data-cites="Cotton-2013">(<a href="#ref-Cotton-2013" role="doc-biblioref">2013</a>)</span>, <em>Learning R</em> (<a href="http://duhi23.github.io/Analisis-de-datos/Cotton.pdf">online</a>) provides a well-rounded basic introduction to R, covering data types, lists and data frames, functions, packages and workflow for data analysis and graphics;</li>
<li>Matloff<span class="citation" data-cites="Matloff-2011">(<a href="#ref-Matloff-2011" role="doc-biblioref">2011</a>)</span>, <em>The Art of R Programming</em> (<a href="https://diytranscriptomics.com/Reading/files/The%20Art%20of%20R%20Programming.pdf">online</a>) is devoted to learning the programming features of R. It covers all the basics (data types, arrays, data frames), R functions, object-oriented programming, debugging, and so forth.</li>
<li>Wickham<span class="citation" data-cites="Wickham2019">(<a href="#ref-Wickham2019" role="doc-biblioref">2019</a>)</span>, <em>Advanced R</em> (<a href="https://adv-r.hadley.nz/">online</a>) is aimed at intermediate R programmers who want to dive deeper into R and learn how things work,</li>
<li>Long &amp; Teetor <span class="citation" data-cites="LongTeetor2019">(<a href="#ref-LongTeetor2019" role="doc-biblioref">2019</a>)</span>, <em>R Cookbook</em> 2<span class="math inline">\(^{nd}\)</span> Ed (<a href="https://rc2e.com/">online</a>) provides how-to recipies for basic tasks from working with RStudio, to input and output, general statistics, graphics, and regression / ANOVA;</li>
<li>Fox &amp; Weisberg <span class="citation" data-cites="FoxWeisberg:2018">(<a href="#ref-FoxWeisberg:2018" role="doc-biblioref">2018</a>)</span>, <em>An R Companion to Applied Regression</em> is a fantastic resource for learning how to perform statistical analyses in R and visualize results with insightful graphics. It is the companion book to Fox’s <span class="citation" data-cites="Fox:2016:ARA">(<a href="#ref-Fox:2016:ARA" role="doc-biblioref">2016</a>)</span>, <em>Applied Regression Analysis and Generalized Linear Models</em>, which I consider the best intermediate-level modern treatment of these topics. I make heavy use of the accompanying <span style="color: brown;"><strong>car</strong></span> package <span class="citation" data-cites="R-car">(<a href="#ref-R-car" role="doc-biblioref">Fox &amp; Weisberg, 2019</a>)</span> which provides important and convenient graphical methods.</li>
</ul>
<p>When you work with R, it may be useful to have this collection of <a href="https://friendly.github.io/6135/R/rstudio-cheat-sheets-rev3.pdf">R and RStudio cheatsheets</a> I prepared for my graduate data visualization course.</p>
</section><section id="r-graphics-resources" class="level2"><h2 class="anchored" data-anchor-id="r-graphics-resources">R graphics resources</h2>
<p>In this book, I create a large number of graphs in R, and have aimed to present and <em>describe</em> how I do them using R packages and code to manipulate the data or numerical output from analysis function, so that you can learn from these examples to apply these ideas to your own data.</p>
<p>In writing this, I’ve also tried to exemplify graphical principles that underlie effective graphic communication. You might find the lecture notes, extensive resources and R examples for my course, <a href="https://friendly.github.io/6135/"><em>Psychology of Data Visualization</em></a> useful.</p>
<p>In addition, there are a few books I recommend:</p>
<center>
<a href="https://clauswilke.com/dataviz/"><img src="images/icons/Wilke-FundamentalsOfDataVis.png" height="120"></a> &nbsp;&nbsp; <a href="http://socvis.co"><img src="images/icons/healy-dava-vis-cover-pupress.jpg" height="120"></a> &nbsp;&nbsp; <a href="https://github.com/antonr4/GmooGkodes"><img src="images/icons/Unwin-GmooG.webp" height="120"></a> &nbsp;&nbsp; <a href="https://nrennie.rbind.io/art-of-viz/"><img src="images/icons/Rennie-cover.png" height="120"></a>
</center>
<p> </p>
<ul>
<li><p>Claus Wilke <span class="citation" data-cites="Wilke2019">(<a href="#ref-Wilke2019" role="doc-biblioref">2019</a>)</span>, <em>Fundamentals of Data Visualization</em> (<a href="https://clauswilke.com/dataviz/">online</a>) A well thought out presentation of important ideas of graphic presentation; it covers a wide range of topics, with good practical advice and lots of examples. How to do these in R is covered in his <a href="https://wilkelab.org/SDS375/">course notes</a>.</p></li>
<li><p>Keiran Healy <span class="citation" data-cites="Healy2019">(<a href="#ref-Healy2019" role="doc-biblioref">2019</a>)</span>, <em>Data Visualization: A Practical Introduction</em> (<a href="http://socvis.co">online</a>). A highly accessible, hands-on primer on how to create effective graphics from data using <span style="color: brown;"><strong>ggplot2</strong></span>, with a focus on how to think about the information you want to show.</p></li>
<li><p>Antony Unwin <span class="citation" data-cites="Unwin2024">(<a href="#ref-Unwin2024" role="doc-biblioref">2024</a>)</span>, <em>Getting (more out of) Graphics</em>. This book offers a collection of 25 case studies of interesting datasets, exemplifying desirable features of graphs use to understand them and using <span style="color: brown;"><strong>ggplot2</strong></span> graphics. A second part provides useful advice on graphical practice, drawing on the lessons of the examples from the first part. The R code for all chapters is <a href="https://github.com/antonr4/GmooGkodes">available online</a>.</p></li>
<li><p>Nicola Rennie <span class="citation" data-cites="Rennie2025">(<a href="#ref-Rennie2025" role="doc-biblioref">2025</a>)</span>, <em>The Art of Data Visualization with ggplot2</em> (<a href="https://nrennie.rbind.io/art-of-viz/">online</a>). Rennie offers a kind of master class in designing effective, attractive graphics using <span style="color: brown;"><strong>ggplot2</strong></span>. The examples chosen stem from the weekly<a href="https://github.com/rfordatascience/tidytuesday">Tidy Tuesday</a> challenges that invite graphic programmers and designers to to work on a shared dataset to see what they can do.</p></li>
</ul>
<!-- **TODO**: Add more stuff on general books about graphics --></section><section id="r-coding-style-used-here" class="level2"><h2 class="anchored" data-anchor-id="r-coding-style-used-here">R coding style used here</h2>
<div class="callout callout-style-default callout-note callout-titled" title="Note to reviewers">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note to reviewers
</div>
</div>
<div class="callout-body-container callout-body">
<p>The coding style for computing and graphics used in this book are expressed using both the traditional functional syntax, <code>f(g(x))</code> and the newer approach using pipes (<code>|&gt;</code>) of the tidyverse. Similarly, I use both base R graphics and plots based on the “ggverse” of <span style="color: brown;"><strong>ggplot2</strong></span> and it’s large family of add-on and extension packages.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>How and why it is this way should be explained to the reader. The material below is a start, but needs a bit of fleshing out or editing down.</p>
<!-- Standing on the shoulders of several giants ... -->
</div>
</div>
<p>Like natural language and the graphic methods used in this book, R syntax and the programming style for graphics has evolved considerably since R was first introduced by Ross Ihaka and Robert Gentleman in 1992. It was originally based on the S programming language <span class="citation" data-cites="Becker-etal:88">(<a href="#ref-Becker-etal:88" role="doc-biblioref">Becker et al., 1988</a>)</span> and designed as a <em>functional</em> language. This means that programs are constructed by applying and composing functions, like <code>log(x)</code>, <code>exp(x)</code>, which return a value. …</p>
<ul>
<li>pipes</li>
<li>tidyverse</li>
<li>R graphics: <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> -&gt; <code>ggplot()</code>
</li>
</ul>
<p>Rather than being dogmatic about using the newest, most politically correct style,<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> in this book I have taken the view that what is most important about programming and graphics software is that they serve as a route—as short and direct as possible—between <strong>having an idea</strong> in your head of what you want to do, and <strong>seeing the result</strong> on your screen or in your report, as illustrated in <a href="#fig-idea-graph" class="quarto-xref">Figure&nbsp;<span class="quarto-unresolved-ref">fig-idea-graph</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-idea-graph" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-idea-graph-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/idea-graph.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-idea-graph-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: The expressive power of graphics software can be considered as minimizing the path from an idea in your head to finished graphic.
</figcaption></figure>
</div>
</div>
</div>
<p>Consequently, for nearly every graph in this book, I used what I considered to be the most effective style to produce an <em>admirable graphic</em>, but—perhaps more importantly–to be able to <em>describe how</em> I coded that to the reader.</p>
<p>For example, the <span style="color: brown;"><strong>car</strong></span> package and my <span style="color: brown;"><strong>heplots</strong></span> and related packages use base-R graphics, but I could customize their use in examples by using the conventions of <code><a href="https://rdrr.io/r/graphics/points.html">points()</a></code>, <code><a href="https://rdrr.io/r/graphics/lines.html">lines()</a></code>, <code><a href="https://rdrr.io/r/graphics/text.html">text()</a></code> and even <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code> when necessary. However, if I was starting this project anew, I would now use <span style="color: brown;"><strong>tinyplot</strong></span> <span class="citation" data-cites="R-tinyplot">(<a href="#ref-R-tinyplot" role="doc-biblioref">McDermott et al., 2025</a>)</span>, which has removed many of the cringeworthy features of base-R graphics.</p>
<p>On the other hand, <span style="color: brown;"><strong>ggplot2</strong></span> package was designed to be an <em>elegant</em> language, based on the grammar of graphics <span class="citation" data-cites="Wilkinson:99">(<a href="#ref-Wilkinson:99" role="doc-biblioref">Wilkinson, 1999</a>)</span>. It allows you to <em>think of building plots</em> logically and coherently, layer by layer. Instead of memorizing specific function calls and their arguments for every type of chart, you learn a flexible, high-level language for describing what you <em>want your graphic to look like</em>. This promotes a more structured thinking about data visualization, making it easier for you to iterate<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>, as we always do, to create beautiful, publication-quality graphics.</p>
<p>This is great in theory, but as you will see here, in many code examples, beyond the basic <code>geom_*</code> elements, a good deal of the effort to produce them required multiple steps to (a) get my data into a tidy format, (b) assign proper <code>scale_*</code>s to data variables and (c) use <code>theme()</code> arguments to control the large and small aspects of graphic design that contribute to the elegance and potential beauty of finished product you see.</p>
<p>Consequently, this book stands on the shoulders of <em>several</em> giants in R graphics software, but the goal of reducing the gap between the idea of a graph and the visual result can still be narrowed.</p>
</section><section id="typographic-conventions-used-in-this-book" class="level2"><h2 class="anchored" data-anchor-id="typographic-conventions-used-in-this-book">Typographic conventions used in this book</h2>
<p>The following typographic conventions are used in this book:</p>
<ul>
<li><p><em>italic</em> : indicates terms or phrases to be <em>emphasized</em> or defined in the text; <strong>bold</strong> : is used for terms to be given <strong>strong emphasis</strong>, particularly for their first mention.</p></li>
<li><p>Package names are printed in <strong>bold</strong> and colored <span style="color: brown4;">brown</span>, for example <span style="color: brown;"><strong>ggplot2</strong></span>, <span style="color: brown;"><strong>car</strong></span> and the <span style="color: brown;"><strong>matlib</strong></span> package. These uses generate citations like <span style="color: brown;"><strong>ggplot2</strong></span> <span class="citation" data-cites="R-ggplot2">(<a href="#ref-R-ggplot2" role="doc-biblioref">Wickham, 2016</a>)</span> on their first use. Package references in the text are automatically indexed, individually and under a “Packages” heading.</p></li>
<li><p>Datasets are rendered as their name in monospaced font, like <code>Prestige</code> or indicating the package from which they come, as in <code><a href="https://rdrr.io/pkg/carData/man/Prestige.html">carData::Prestige</a></code>. These too are automatically indexed.</p></li>
<li><p>A monospaced <code>typewriter</code> font is used in the text to refer to <em>variable</em> and <em>function</em> names, such as <code>education</code> and <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code>. This font is also for R statement elements, keywords and code fragments as well.</p></li>
<li><p>R code in program listings and output is presented in a <code>monospaced (typewriter)</code> font, <a href="https://fonts.google.com/specimen/Fira+Mono"><code>fira mono</code></a></p></li>
</ul>
<!-- * _`fixed-width italic`_ : isn't used yet, but probably should be. --><ul>
<li>For R functions in packages, I use the notation <code>package::function()</code>, such as <code><a href="https://rdrr.io/pkg/car/man/Anova.html">car::Anova()</a></code>, to identify that the <code>Anova()</code> function is defined in the <span style="color: brown;"><strong>car</strong></span> package. This also means you can get help on a function by typing <code><a href="https://rdrr.io/pkg/car/man/Anova.html">?car::Anova</a></code> in the console, or a list of its arguments and default values from <code>args(car::Anova)</code>.</li>
</ul></section><section id="acknowledgements" class="level2"><h2 class="anchored" data-anchor-id="acknowledgements">Acknowledgements</h2>
<p>I am profoundly grateful to my friends and colleagues John Fox, Georges Monette and Phil Chalmers at York University who have inspired me with their insights into statistical thinking and visualization of statistical ideas over many years. They also contributed greatly to the R packages that help make the methods of this book accessible and easy to use.</p>
<p>There is also a host of graduate students I have taught, supervised and worked with over my 50+ year career. Among these, Ernest Kwan and Matthew Sigal were important contributors to the development of data visualization ideas and techniques reflected here. Agnieska Kopinska, Gigi Luk and Touraj Amiri were TAs and RAs who contributed to my teaching and research. Most recently, Udi Alter and Michael Shiuming Truong worked as research assistants and helped me in numerous ways with work on this book.</p>
<p>Writing this book using <a href="https://quarto.org/">Quarto</a> within the RStudio (now <a href="https://posit.co/">Posit</a>) development environment presented many technical challenges I had not encountered in previous books (<span class="citation" data-cites="FriendlyMeyer:2016:DDAR">Friendly &amp; Meyer (<a href="#ref-FriendlyMeyer:2016:DDAR" role="doc-biblioref">2016</a>)</span>). I am grateful to Mickaël Canouil, Christophe Dervieux, Felix Benning and others in the quarto-dev community who graciously helped me solve many issues, and again to Michael Shiuming Truong who helped with this effort with incisive comments, suggestions and an eagle-eye to typographic and programming details.</p>
<p>The book also relies heavily on the graphic ideas and software of many R developers, including Cory Brunson, Vincent Arel-Bundock, Di Cook, John Fox, Duncan Murdoch, who replied to issues and feature requests on their packages. I am also indebted to Gina Reynolds, Teun van den Brand and other participants in the the <a href="https://ggplot2-extenders.github.io/ggplot-extension-club/">ggplot2 extenders club</a> for help with <code>ggplot()</code> methods I needed for things like labeling “noteworthy” observations in plots.</p>
<!-- ## References {.unnumbered} -->


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-Becker-etal:88" class="csl-entry" role="listitem">
Becker, R. A., Chambers, J. M., &amp; Wilks, A. R. (1988). <em>The new <span>S</span> language</em>. Wadsworth &amp; Brooks/Cole.
</div>
<div id="ref-Cotton-2013" class="csl-entry" role="listitem">
Cotton, R. (2013). <em><span>Learning R</span></em>. O’Reilly Media.
</div>
<div id="ref-Fox:2016:ARA" class="csl-entry" role="listitem">
Fox, J. (2016). <em>Applied regression analysis and generalized linear models</em> (Third edition.). SAGE.
</div>
<div id="ref-Fox2021" class="csl-entry" role="listitem">
Fox, J. (2021). <em>A mathematical primer for social statistics</em> (2nd ed.). SAGE Publications, Inc. <a href="https://doi.org/10.4135/9781071878835">https://doi.org/10.4135/9781071878835</a>
</div>
<div id="ref-FoxWeisberg:2018" class="csl-entry" role="listitem">
Fox, J., &amp; Weisberg, S. (2018). <em>An <span>R</span> companion to applied regression</em> (Third). SAGE Publications. <a href="https://books.google.ca/books?id=uPNrDwAAQBAJ">https://books.google.ca/books?id=uPNrDwAAQBAJ</a>
</div>
<div id="ref-R-car" class="csl-entry" role="listitem">
Fox, J., &amp; Weisberg, S. (2019). <em>An <span>R</span> companion to applied regression</em> (Third). Sage. <a href="https://www.john-fox.ca/Companion/">https://www.john-fox.ca/Companion/</a>
</div>
<div id="ref-R-matlib" class="csl-entry" role="listitem">
Friendly, M., Fox, J., &amp; Chalmers, P. (2024). <em>Matlib: Matrix functions for teaching and learning linear algebra and multivariate statistics</em>. <a href="https://github.com/friendly/matlib">https://github.com/friendly/matlib</a>
</div>
<div id="ref-FriendlyKwan:03:effect" class="csl-entry" role="listitem">
Friendly, M., &amp; Kwan, E. (2003). Effect ordering for data displays. <em>Computational Statistics and Data Analysis</em>, <em>43</em>(4), 509–539. <a href="https://doi.org/10.1016/S0167-9473(02)00290-6">https://doi.org/10.1016/S0167-9473(02)00290-6</a>
</div>
<div id="ref-FriendlyMeyer:2016:DDAR" class="csl-entry" role="listitem">
Friendly, M., &amp; Meyer, D. (2016). <em>Discrete data analysis with <span>R</span>: Visualization and modeling techniques for categorical and count data</em>. Chapman &amp; Hall/CRC.
</div>
<div id="ref-Healy2019" class="csl-entry" role="listitem">
Healy, K. (2019). <em>Data visualization: A practical introduction</em>. Princeton University Press. <a href="http://www.socviz.co">http://www.socviz.co</a>
</div>
<div id="ref-LongTeetor2019" class="csl-entry" role="listitem">
Long, J. D., &amp; Teetor, P. (2019). <em>R cookbook: Proven recipes for data analysis, statistics, and graphics</em>. O’Reilly. <a href="https://rc2e.com/">https://rc2e.com/</a>
</div>
<div id="ref-Matloff-2011" class="csl-entry" role="listitem">
Matloff, N. (2011). <em>The art of <span>R</span> programming: <span>A</span> tour of statistical software design</em>. No Starch Press.
</div>
<div id="ref-R-tinyplot" class="csl-entry" role="listitem">
McDermott, G., Arel-Bundock, V., &amp; Zeileis, A. (2025). <em><span class="nocase">tinyplot</span>: Lightweight extension of the base r graphics system</em>. <a href="https://doi.org/10.32614/CRAN.package.tinyplot">https://doi.org/10.32614/CRAN.package.tinyplot</a>
</div>
<div id="ref-Rennie2025" class="csl-entry" role="listitem">
Rennie, N. (2025). <em>The art of data visualization with ggplot2</em>. CRC Press. <a href="https://nrennie.rbind.io/art-of-viz/">https://nrennie.rbind.io/art-of-viz/</a>
</div>
<div id="ref-Unwin2024" class="csl-entry" role="listitem">
Unwin, A. (2024). <em>Getting (more out of) graphics: Practice and principles of data visualisation</em>. Chapman; Hall/CRC. <a href="https://doi.org/10.1201/9781003131212">https://doi.org/10.1201/9781003131212</a>
</div>
<div id="ref-R-ggplot2" class="csl-entry" role="listitem">
Wickham, H. (2016). <em>ggplot2: Elegant graphics for data analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>
</div>
<div id="ref-Wickham2019" class="csl-entry" role="listitem">
Wickham, H. (2019). <em>Advanced r</em>. Chapman; Hall/CRC. <a href="https://doi.org/10.1201/9781351201315">https://doi.org/10.1201/9781351201315</a>
</div>
<div id="ref-Wilke2019" class="csl-entry" role="listitem">
Wilke, C. O. (2019). <em>Fundamentals of <span>Data</span> <span>Visualization</span>: <span>A</span> <span>Primer</span> on <span>Making</span> <span>Informative</span> and <span>Compelling</span> <span>Figures</span></em>. O’Reilly Media. <a href="https://clauswilke.com/dataviz">clauswilke.com/dataviz</a>
</div>
<div id="ref-Wilkinson:99" class="csl-entry" role="listitem">
Wilkinson, L. (1999). <em>The grammar of graphics</em>. Springer.
</div>
</div>
</section></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>The official <a href="https://exts.ggplot2.tidyverse.org/gallery/">ggplot2 extensions gallery website</a>, lists 151 registered extension packages available as of this writing. There is also the <a href="https://ggplot2-extenders.github.io/ggplot-extension-club/">ggplot2 extenders club</a>, an active group of developers organized by Gina Reynolds and Teun van den Brand, who aim to facilitate thinking about further growth of <code>ggplot</code> ideas and implementations.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>See Norm Matloff’s essay <a href="https://matloff.github.io/TidyverseSkeptic/Skeptic.html">Tidyverse Skeptic</a>. He argues that the tidyverse is not a good vehicle for teaching novice, noncoders, and that using base-R as the vehicle of instruction brings students to a more skilled level, in shorter time.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>You should think of the “80-20” graphics rule when you work. This says you can produce 80% of your finished graphic with 20% of your total effort. But the corollary is that it takes you 80% of your time to fix the limitations of the remaining 20%.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/friendly\.github\.io\/Vis-MLM-book");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
  </div>
  <div class="nav-page nav-page-next">
      <a href="./00-Author.html" class="pagination-link" aria-label="Author">
        <span class="nav-page-text">Author</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/friendly/vis-MLM-book/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer><script src="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.js" defer="true"></script>
</body></html>