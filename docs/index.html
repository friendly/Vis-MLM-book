<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Michael Friendly">
<meta name="dcterms.date" content="2024-03-25">
<title>Visualizing Multivariate Data and Models in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./01-intro.html" rel="next">
<link href="./images/favicon/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./index.html">Preface</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Visualizing Multivariate Data and Models in R</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p><a href="https://datavis.ca">Michael Friendly</a> </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 25, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Visualizing Multivariate Data and Models in R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/friendly/vis-MLM-book" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-getting_started.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Started</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-multivariate_plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Plots of Multivariate Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-pca-biplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">PCA and Biplots</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-linear_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Overview of Linear models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-linear_models-plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Plots for univariate response models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-collinearity-ridge.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Collinearity &amp; Ridge Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hotelling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Hotelling’s <span class="math inline">\(T^2\)</span></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm-viz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Visualizing Multivariate Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm-review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Brief review of the multivariate linear model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./case-studies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Case studies</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eqcov.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Visualizing Tests for Equality of Covariance Matrices</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./90-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./91-colophon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Colophon</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#preface" id="toc-preface" class="nav-link active" data-scroll-target="#preface">Preface</a>
  <ul class="collapse">
<li><a href="#one-two-many" id="toc-one-two-many" class="nav-link" data-scroll-target="#one-two-many">ONE, TWO, MANY</a></li>
  <li><a href="#flatland" id="toc-flatland" class="nav-link" data-scroll-target="#flatland">Flatland</a></li>
  <li>
<a href="#eureka" id="toc-eureka" class="nav-link" data-scroll-target="#eureka">EUREKA!</a>
  <ul class="collapse">
<li><a href="#sec-discoveries" id="toc-sec-discoveries" class="nav-link" data-scroll-target="#sec-discoveries">Multivariate scientific discoveries</a></li>
  </ul>
</li>
  <li><a href="#what-i-assume" id="toc-what-i-assume" class="nav-link" data-scroll-target="#what-i-assume">What I assume</a></li>
  <li><a href="#conventions-used-in-this-book" id="toc-conventions-used-in-this-book" class="nav-link" data-scroll-target="#conventions-used-in-this-book">Conventions used in this book</a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/friendly/vis-MLM-book/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">
<section id="preface" class="level1 unnumbered"><h1 class="unnumbered">Preface</h1><p><img src="images/cover-ellipse.jpg" title="Visualizing Multivariate Data and Models in R" class="quarto-cover-image img-fluid"></p>
<p><strong>TODO</strong>: Make this a more general introduction</p>
<p>This book is about graphical methods developed recently for multivariate data, and their uses in understanding relationships when there are several aspects to be considered together. Data visualization methods for statistical analysis are well-developed for simple linear models with a single outcome variable. However, with applied research in the social and behavioral sciences, it is often the case that the phenomena of interest (e.g., depression, job satisfaction, academic achievement, childhood ADHD disorders, etc.) can be measured in several different ways or related aspects.</p>
<p>For example, if academic achievement can be measured for adolescents by reading, mathematics, science and history scores, how do predictors such as parental encouragement, school environment and socioeconomic status affect all these outcomes? In a similar way? In different ways? In such cases, much more can be understood from a multivariate approach that considers the correlations among the outcomes. Yet, sadly, researchers typically examine the outcomes one by one which often only tells part of the data story.</p>
<p>However, to do this it is useful to set the stage for multivariate thinking, with a grand scheme for statistics and data visualization, a parable, and an example of multivariate discovery.</p>
<section id="one-two-many" class="level2"><h2 class="anchored" data-anchor-id="one-two-many">ONE, TWO, MANY</h2>
<p>There is an old and helpful idea I learned from John Hartigan in my graduate days at Princeton:</p>
<blockquote class="blockquote">
<p>In statistics and data visualization <em>all</em> methods can be classified by the number of dimensions contemplated, on a scale of <strong>ONE</strong>, <strong>TWO</strong>, <strong>MANY</strong>.</p>
</blockquote>
<p>By this, he meant that, at a global level, all data, statistical summaries, and graphical displays could be classified as:</p>
<ul>
<li>
<strong>univariate</strong>: a single variable, considered in isolation (age, COVID cases, pizzas ordered). Univariate numerical summaries are means, medians, measures of variablilty, and so forth. Univariate displays include dot plots, boxplots, histograms and density estimates.</li>
<li>
<strong>bivariate</strong>: two variables, considered jointly. Numerical summaries include correlations, covariances and two-way tables of frequencies or measures of association for categorical variables. Bivariate displays include scatterplots and mosaic plots.</li>
<li>
<strong>multivariate</strong>: three or more variables, considered jointly. Numerical summaries include correlation and covariance matrices, consisting of all pairwise values, but also derived measures from the analysis of these matrices (eigenvalues, eigenvectors). Graphical displays of multivariate data can sometimes be shown in 3D, but often involve multiple views of the data projected into 2D plots.</li>
</ul>
<p>As a quasi-numerical scale, I refer to these as <strong>1D</strong>, <strong>2D</strong> and <strong>nD</strong>. This admits the possibility of half-integer cases, such as <strong>1.5D</strong>, where the main focus is on a single variable, but that is classified by a simple factor (e.g., gender), or <strong>2.5D</strong> where a 2D scatterplot can show other variables using color, shape or other visual attributes His point in this classification was that once you’ve reached three variables, all higher dimensions involve similar summaries and data displays.</p>
<p>Univariate and bivariate methods and displays are well-known. This book is about how these ideas can be extended to an <span class="math inline">\(n\)</span>-dimensional world. Three-dimensional data displays are now fairly easy to produce, even if they are sometimes difficult to understand. But how can we even think about four or more dimensions? The difficulty can be appreciated by considering the tale of <em>Flatland</em>.</p>
</section><section id="flatland" class="level2"><h2 class="anchored" data-anchor-id="flatland">Flatland</h2>
<blockquote class="blockquote">
<p>To comport oneself with perfect propriety in Polygonal society, one ought to be a Polygon oneself. — Edwin A. Abbott, <em>Flatland</em></p>
</blockquote>
<p>In 1884, an English schoolmaster, Edwin Abbott Abbott, shook the world of Victorian culture with a slim volume, <em>Flatland: A Romance of Many Dimensions</em> <span class="citation" data-cites="Abbott:1884">(<a href="90-references.html#ref-Abbott:1884" role="doc-biblioref">Abbott, 1884</a>)</span>. He described a two-dimensional world, <em>Flatland</em>, inhabited entirely by geometric figures in the plane. His purpose was satirical, to poke fun at the social and gender class system at the time: Women were mere line segments, while men were represented as polygons with varying numbers of sides— a triangle was a working man, but acute isosceles were soldiers or criminals of very small angle; gentlemen and professionals had more sides. Abbot published this under the pseudonym, “A Square”, suggesting his place in the hierarchy.</p>
<blockquote class="blockquote">
<p>True, said the Sphere; it appears to you a Plane, because you are not accustomed to light and shade and perspective; just as in Flatland a Hexagon would appear a Straight Line to one who has not the Art of Sight Recognition. But in reality it is a Solid, as you shall learn by the sense of Feeling. — Edwin A. Abbott, <em>Flatland</em></p>
</blockquote>
<p>But how did it feel to be a member of a flatland society? How could a point (a newborn child?) understand a line (a woman)? How does a Triangle “see” a Hexagon or even a infinitely-sided Circle? Abbott introduces the very idea of different dimensions of existence through dreams and visions:</p>
<ul>
<li><p>A Square dreams of visiting a one-dimensional <em>Lineland</em> where men appear as lines, and women are merely “illustrious points”, but the inhabitants can only see the Square as lines.</p></li>
<li><p>In a vision, the Square is visited by a Sphere, to illustrate what a 2D Flatlander could understand from a 3D sphere (<a href="#fig-flatland-spheres">Figure&nbsp;<span>1</span></a>) that passes through the plane he inhabits. It is a large circle when seen at the moment of its’ greatest extent. As the Spehere rises, it becomes progressively smaller, until it becomes a point, and then vanishes.</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-flatland-spheres" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/flatland-spheres.jpg" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;1: A 2D Flatlander seeing a sphere as it passes through Flatland. The line, labeled ‘My Eye’ indicates what the Flatlander would see. Source: <span class="citation" data-cites="Abbott:1884">Abbott (<a href="90-references.html#ref-Abbott:1884" role="doc-biblioref">1884</a>)</span></figcaption></figure>
</div>
</div>
</div>
<p>Abbott goes on to state what could be considered as a demonstration (or proof) by induction of the difficulties of seeing in 1, 2, 3 dimensions, and how the idea motion over time (one more dimension) could allow citizens of any 1D, 2D, 3D world to contemplate one more dimension.</p>
<blockquote class="blockquote">
<p>In One Dimensions, did not a moving Point produce a Line with two terminal points? In two Dimensions, did not a moving Line produce a Square with four terminal points? In Three Dimensions, did not a moving Square produce - did not the eyes of mine behold it - that blessed being, a Cube, with eight terminal points? And in Four Dimensions, shall not a moving Cube - alas, for Analogy, and alas for the Progress of Truth if it be not so - shall not, I say the motion of a divine Cube result in a still more divine organization with sixteen terminal points? — Edwin A. Abbott</p>
</blockquote>
<p>For Abbot, the way for a citizen of any world to imagine one more dimension was to consider how a higher-dimensional object would change over time.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> A line moved over time could produce a rectangle as shown in <a href="#fig-1D-4D">Figure&nbsp;<span>2</span></a>; that rectangle moving in another direction over time would produce a 3D figure, and so forth.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-1D-4D" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/1D-4D.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2: Geometrical objects in 1 to 4 dimensions. One more dimension can be thought of as the trace of movement over time.</figcaption></figure>
</div>
</div>
</div>
<p>But wait! Where does that 4D thing (a <em>tesseract</em>) come from? To really see a tesseract it helps to view it in an animation over time (<a href="#fig-tesseract">Figure&nbsp;<span>3</span></a>). But like the Square, contemplating 3D from a 2D world, it takes some imagination.</p>
<!-- ::: {.content-visible when-format="html"} -->
<!-- :::: {#fig-tesseract} -->
<!-- ```{=html} -->
<!-- <div align="center"> -->
<!-- <iframe width="256" height="256" src="images/tesseract.gif"></iframe> -->
<!-- </div> -->
<!-- ``` -->
<!-- Animation of a tesseract, a cube changing over time. -->
<!-- :::: -->
<!-- ::: -->
<div id="fig-tesseract" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/tesseract.gif" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;3: Animation of a tesseract, a cube changing over time.</figcaption></figure>
</div>
<p>Yet the deep mathematics of more than three dimensions only emerged in the 19th century. In Newtonian mechanics, space and time were always considered independent of each other. Our familiar three-dimensional space, of length, width, and height had formed the backbone of Euclidean geometry for millenea. However, the idea that space and time are indeed interwoven was first proposed by German mathematician Hermann Minkowski (1864–1909) in 1908. This was a powerful idea. It bore fruit when Albert Einstein revolutionized the Newtonian conceptions of gravity in 1915 when he presented a theory of general relativity which was based primarily on the fact that mass and energy warp the fabric of four-dimensional spacetime.</p>
<p>The parable of <em>Flatland</em> can provide inspiration for statistical thinking and data visualization. Once we go beyond bivariate statistics and 2D plots, we are in a multivariate world of possibly MANY dimensions. It takes only some imagination and suitable methods to get there.</p>
<p>Like Abbott’s <em>Flatland</em>, this book is a romance, in many dimensions, of what we can learn from modern methods of data visualization.</p>
</section><section id="eureka" class="level2"><h2 class="anchored" data-anchor-id="eureka">EUREKA!</h2>
<p>Even modest sized multivariate data can have secrets that can be revealed in the right view. As an example, David Coleman at RCA Laboratories in Princeton, N.J. generated a dataset of five (fictitious) measurements of grains of pollen for the 1986 Data Exposition at the Joint statistical Meetings. The first three variables are the lengths of geometric features 3848 observed sampled pollen grains – in the x, y, and z dimensions: a <code>ridge</code> along x, a <code>nub</code> in the y direction, and a <code>crack</code> in along the z dimension. The fourth variable is pollen grain <code>weight</code>, and the fifth is <code>density</code>. The challenge was to “find something interesting” in this dataset, now available as <code><a href="https://rdrr.io/pkg/animation/man/pollen.html">animation::pollen</a></code>. </p>
<p>Those who solved the puzzle were able to find an orientation of this 5-dimensional dataset, such that zooming in revealed a magic word, “EUREKA” spelled in points, as in the following figure.</p>
<div id="fig-pollen-eureka" class="quarto-layout-panel">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="images/pollen-eureka1.png" class="img-fluid figure-img"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="images/pollen-eureka2.png" class="img-fluid figure-img"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="images/pollen-eureka4.png" class="img-fluid figure-img"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="images/pollen-eureka3.png" class="img-fluid figure-img"></p>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;4: Four views of the <code>pollen</code> data, zooming in, clockwise from the upper left to discover the word “EUREKA”.</figcaption><p></p>
</figure>
</div>
<p>This can be seen better in a 3D animation. The <code>rgl</code> package <span class="citation" data-cites="R-rgl">(<a href="90-references.html#ref-R-rgl" role="doc-biblioref">Adler &amp; Murdoch, 2023</a>)</span> is used to create a 3D scatterplot of the first three variables. Then the <code>animation</code> package <span class="citation" data-cites="R-animation">(<a href="90-references.html#ref-R-animation" role="doc-biblioref">Xie, 2021</a>)</span> is use to record a sequence of images, adjusting the <code>rgl::par3d(zoom)</code> value.</p>
<div class="cell" data-layout-align="center">
<details><summary>Code</summary><div class="sourceCode" id="cb1" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/animation/">animation</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dmurdoch/rgl">rgl</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">pollen</span>, package <span class="op">=</span> <span class="st">"animation"</span><span class="op">)</span></span>
<span><span class="va">oopt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/animation/man/ani.options.html">ani.options</a></span><span class="op">(</span>interval <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">## adjust the viewpoint</span></span>
<span><span class="va">uM</span> <span class="op">=</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3709192276</span>, <span class="op">-</span><span class="fl">0.5133571028</span>, <span class="op">-</span><span class="fl">0.7738776206</span>, <span class="fl">0</span>, </span>
<span>           <span class="op">-</span><span class="fl">0.7305060625</span>,  <span class="fl">0.6758151054</span>, <span class="op">-</span><span class="fl">0.0981751680</span>, <span class="fl">0</span>, </span>
<span>            <span class="fl">0.57339602708</span>, <span class="fl">0.5289064049</span>, <span class="op">-</span><span class="fl">0.6256819367</span>, <span class="fl">0</span>, </span>
<span>           <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/open3d.html">open3d</a></span><span class="op">(</span>userMatrix <span class="op">=</span> <span class="va">uM</span>, </span>
<span>       windowRect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">510</span>, <span class="fl">510</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/plot3d.html">plot3d</a></span><span class="op">(</span><span class="va">pollen</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># zoom in</span></span>
<span><span class="va">zm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.045</span>, length <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/par3d.html">par3d</a></span><span class="op">(</span>zoom <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">zm</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/par3d.html">par3d</a></span><span class="op">(</span>zoom <span class="op">=</span> <span class="va">zm</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/animation/man/ani.pause.html">ani.pause</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/animation/man/ani.options.html">ani.options</a></span><span class="op">(</span><span class="va">oopt</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="fig-pollen-eureka" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/pollen-eureka.gif" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Animation of zooming in on the <code>pollen</code> data. This figure only appears in the online version.</figcaption></figure>
</div>
<figcaption class="figure-caption">Figure&nbsp;5: <strong>?(caption)</strong></figcaption></figure>
</div>
<section id="sec-discoveries" class="level3"><h3 class="anchored" data-anchor-id="sec-discoveries">Multivariate scientific discoveries</h3>
<p>Lest this example seem contrived (which it admittedly is), multivariate visualization has played an important role in quite a few scientific discoveries. Among these, Francis Galton’s <span class="citation" data-cites="Galton:1863">(<a href="90-references.html#ref-Galton:1863" role="doc-biblioref">1863</a>)</span> discovery of the anti-cyclonic pattern of wind direction in relation to barometric pressure from many weather measures recorded systematically across all weather stations, lighthouses and observatories in Europe in December 1861 stands out as the best example of a scientific discovery achieved almost entirely through graphical means–– something that was totally unexpected, and purely the product of his use of remarkably novel high-dimensional graphs <span class="citation" data-cites="FriendlyWainer:2021:TOGS">(<a href="90-references.html#ref-FriendlyWainer:2021:TOGS" role="doc-biblioref">Friendly &amp; Wainer, 2021, pp. 170–173</a>)</span>.</p>
<p>A more recent example is the discovery of two general classes in the development of Type 2 diabetes by <span class="citation" data-cites="ReavenMiller:79">G. M. Reaven &amp; Miller (<a href="90-references.html#ref-ReavenMiller:79" role="doc-biblioref">1979</a>)</span>, using PRIM-9 <span class="citation" data-cites="Fishkeller-etal:1974b">(<a href="90-references.html#ref-Fishkeller-etal:1974b" role="doc-biblioref">Fishkeller et al., 1974</a>)</span>, the first computer system for high-dimensional visualization<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. In an earlier study <span class="citation" data-cites="ReavenMiller:68">G. Reaven &amp; Miller (<a href="90-references.html#ref-ReavenMiller:68" role="doc-biblioref">1968</a>)</span> examined the relation between blood glucose levels and the production of insulin in normal subjects and in patients with varying degrees of hyperglicemia (elevated blood sugar level). They found a peculiar “horse shoe” pattern They found a peculiar ``horse shoe’’ shape in this relation (shown in <a href="#fig-diabetes1">Figure&nbsp;<span>6</span></a>), about which they could only speculate: perhaps individuals with the best glucose tolerance also had the lowest levels of insulin as a response to an oral dose of glucose; perhaps those with low glucose response could secrete higher levels of insulin; perhaps those who were low on both glucose and insulin responses followed some other mechanism. In 2D plots, this was a mystery.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">Diabetes</span>, package<span class="op">=</span><span class="st">"heplots"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">instest</span> <span class="op">~</span> <span class="va">glutest</span>, data<span class="op">=</span><span class="va">Diabetes</span>, </span>
<span>     pch<span class="op">=</span><span class="fl">16</span>,</span>
<span>     cex.lab<span class="op">=</span><span class="fl">1.25</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Glucose response"</span>,</span>
<span>     ylab<span class="op">=</span><span class="st">"Insulin response"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-diabetes1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/fig-diabetes1-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;6: Reproduction of a graph similar to that from <span class="citation" data-cites="ReavenMiller:68">G. Reaven &amp; Miller (<a href="90-references.html#ref-ReavenMiller:68" role="doc-biblioref">1968</a>)</span> on the relationship between glucose and insulin response to being given an oral dose of glucose.</figcaption></figure>
</div>
</div>
</div>
<!-- knitr::include_graphics("images/diabetes1.png") -->
<p>An answer to their questions came ten years later, when they were able to visualize similar but new data in 3D using the PRIM-9 system. In a carefully controlled study, they also measured ``steady state plasma glucose’’ (SSPG), a measure of the efficiency of use of insulin in the body, where large values mean insulin resistance, as well as other variables. PRIM-9 allowed them to explore various sets of three variables, and, more importantly, to rotate a given plot in three dimensions to search for interesting features. One plot that stood out concerned the relation between plasma glucose response, plasma insulin response and SSPG response, shown in <a href="#fig-ReavenMiller-3d">Figure&nbsp;<span>7</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ReavenMiller-3d" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/ReavenMiller-3d-annotated.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;7: Artist’s rendition of data from <span class="citation" data-cites="ReavenMiller:79">G. M. Reaven &amp; Miller (<a href="90-references.html#ref-ReavenMiller:79" role="doc-biblioref">1979</a>)</span> as seen in three dimensions using the PRIM-9 system. Labels for the clusters have been added, identifying the three groups of patients. <em>Source</em>: <span class="citation" data-cites="ReavenMiller:79">G. M. Reaven &amp; Miller (<a href="90-references.html#ref-ReavenMiller:79" role="doc-biblioref">1979</a>)</span>.</figcaption></figure>
</div>
</div>
</div>
<p>From this graphical insight, they were able to classify the participants into three groups, based on clinical levels of glucose and insulin. The people in the wing on the left in <a href="#fig-ReavenMiller-3d">Figure&nbsp;<span>7</span></a>, with high levels of fasting glucose, were considered to have overt diabetes. Those in the right wing were classified as chemical diabetics, and those in the central blob were classified as normal.</p>
</section></section><section id="what-i-assume" class="level2"><h2 class="anchored" data-anchor-id="what-i-assume">What I assume</h2>
<p>It is assumed that the reader has a background in intermediate statistics including material on univariate linear models including analysis of variance (ANOVA) and multiple regression. This means you should be familiar with …</p>
<p>There will also be some mathematics in the book where words and diagrams are not enough. The mathematical level will be intermediate, mostly consisting of simple algebra. No derivations, proofs, theorems here! For multivariate methods, it will be useful to express ideas using matrix notation to simplify presentation. I’m using math to express ideas, and all you will need is a reading-level of understanding.</p>
<p>I also assume the reader to have at least a basic familiarity with R. While R fundamentals are outside the scope of the book, I believe that this language provides a rich set of resources, far beyond that offered by other statistical software packages, and is well worth learning.</p>
<p>For those not familiar with R, I recommend <span class="citation" data-cites="Matloff-2011">Matloff (<a href="90-references.html#ref-Matloff-2011" role="doc-biblioref">2011</a>)</span>, <span class="citation" data-cites="Wickham2014">Wickham (<a href="90-references.html#ref-Wickham2014" role="doc-biblioref">2014</a>)</span>, and <span class="citation" data-cites="Cotton-2013">Cotton (<a href="90-references.html#ref-Cotton-2013" role="doc-biblioref">2013</a>)</span> for introductions to programming in the language, and <span class="citation" data-cites="FoxWeisberg:2018">Fox &amp; Weisberg (<a href="90-references.html#ref-FoxWeisberg:2018" role="doc-biblioref">2018</a>)</span> and <span class="citation" data-cites="Teetor2011">Teetor (<a href="90-references.html#ref-Teetor2011" role="doc-biblioref">2011</a>)</span> for learning about how to conduct basic statistical analyses. <strong>TODO</strong>: Revise this list.</p>
</section><section id="conventions-used-in-this-book" class="level2"><h2 class="anchored" data-anchor-id="conventions-used-in-this-book">Conventions used in this book</h2>
<p>The following typographic conventions are used in this book:</p>
<ul>
<li><p><em>italic</em> : indicates terms to be <em>emphasized</em> or defined in the text, …</p></li>
<li><p><strong>bold</strong> : is used for names of R packages</p></li>
<li><p><code>fixed-width</code> : is used in program listings as well as in text to refer to variable and function names, R statement elements and keywords.</p></li>
<li><p><em><code>fixed-width italic</code></em> : isn’t used yet, but probably should be.</p></li>
</ul>
<p>For R functions in packages, we use the notation <code>package::function()</code>, for example: <code><a href="https://rdrr.io/pkg/car/man/Anova.html">car::Anova()</a></code> to identify where those functions are defined</p>
<!-- ## References {.unnumbered} -->


<div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="list" style="display: none">
<div id="ref-Abbott:1884" class="csl-entry" role="listitem">
Abbott, E. A. (1884). <em>Flatland: A romance of many dimensions</em>. Buccaneer Books.
</div>
<div id="ref-R-rgl" class="csl-entry" role="listitem">
Adler, D., &amp; Murdoch, D. (2023). <em>Rgl: 3D visualization using OpenGL</em>. <a href="https://CRAN.R-project.org/package=rgl">https://CRAN.R-project.org/package=rgl</a>
</div>
<div id="ref-Cajori:1926" class="csl-entry" role="listitem">
Cajori, F. (1926). Origins of fourth dimension concepts. <em>The American Mathematical Monthly</em>, <em>33</em>(8), 397–406. <a href="https://doi.org/10.1080/00029890.1926.11986607">https://doi.org/10.1080/00029890.1926.11986607</a>
</div>
<div id="ref-Cotton-2013" class="csl-entry" role="listitem">
Cotton, R. (2013). <em><span>Learning R</span></em>. O’Reilly Media.
</div>
<div id="ref-Fishkeller-etal:1974b" class="csl-entry" role="listitem">
Fishkeller, M. A., Friedman, J. H., &amp; Tukey, J. W. (1974). <span>PRIM-9</span>, an interactive multidimensional data display and analysis system. <em>Proceedings of the Pacific ACM Regional Conference</em>.
</div>
<div id="ref-FoxWeisberg:2018" class="csl-entry" role="listitem">
Fox, J., &amp; Weisberg, S. (2018). <em>An r companion to applied regression</em> (Third). SAGE Publications. <a href="https://books.google.ca/books?id=uPNrDwAAQBAJ">https://books.google.ca/books?id=uPNrDwAAQBAJ</a>
</div>
<div id="ref-FriendlyWainer:2021:TOGS" class="csl-entry" role="listitem">
Friendly, M., &amp; Wainer, H. (2021). <em>A history of data visualization and graphic communication</em>. Harvard University Press. <a href="https://doi.org/10.4159/9780674259034">https://doi.org/10.4159/9780674259034</a>
</div>
<div id="ref-Galton:1863" class="csl-entry" role="listitem">
Galton, F. (1863). <em>Meteorographica, or methods of mapping the weather</em>. Macmillan. <a href="http://www.mugu.com/galton/books/meteorographica/index.htm">http://www.mugu.com/galton/books/meteorographica/index.htm</a>
</div>
<div id="ref-Matloff-2011" class="csl-entry" role="listitem">
Matloff, N. (2011). <em>The art of <span>R</span> programming: <span>A</span> tour of statistical software design</em>. No Starch Press.
</div>
<div id="ref-ReavenMiller:79" class="csl-entry" role="listitem">
Reaven, G. M., &amp; Miller, R. G. (1979). An attempt to define the nature of chemical diabetes using a multidimensional analysis. <em>Diabetologia</em>, <em>16</em>, 17–24.
</div>
<div id="ref-ReavenMiller:68" class="csl-entry" role="listitem">
Reaven, G., &amp; Miller, R. (1968). Study of the relationship between glucose and insulin responses to an oral glucose load in man. <em>Diabetes</em>, <em>17</em>(9), 560–569. <a href="https://doi.org/10.2337/diab.17.9.560">https://doi.org/10.2337/diab.17.9.560</a>
</div>
<div id="ref-Teetor2011" class="csl-entry" role="listitem">
Teetor, P. (2011). <em><span class="nocase">R cookbook</span></em>. <span>O’Reilly</span> Media.
</div>
<div id="ref-Wickham2014" class="csl-entry" role="listitem">
Wickham, H. (2014). <em><span>Advanced R</span></em>. <span>Chapman and Hall/CRC</span>.
</div>
<div id="ref-R-animation" class="csl-entry" role="listitem">
Xie, Y. (2021). <em>Animation: A gallery of animations in statistics and utilities to create animations</em>. <a href="https://yihui.org/animation/">https://yihui.org/animation/</a>
</div>
</div>
</section></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>In his famous TV series, <em>Cosmos</em>, Carl Sagan provides <a href="https://youtu.be/UnURElCzGc0">an intriguing video presentation</a> Flatland and the 4th dimension. However, as far back as 1754 <span class="citation" data-cites="Cajori:1926">(<a href="90-references.html#ref-Cajori:1926" role="doc-biblioref">Cajori, 1926</a>)</span>, the idea of adding a fourth dimension appears in Jean le Rond d’Alembert’s “Dimensions”, and one realization of a four-dimensional object is a <em>tesseract</em>, shown in <a href="#fig-1D-4D">Figure&nbsp;<span>2</span></a>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>PRIM-9 is an acronym for <strong>P</strong>icturing, <strong>R</strong>otation, <strong>I</strong>solation and <strong>M</strong>asking in up to <strong>9</strong> dimensions. These operations are fundamental to interactive and dynamic data visualization.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
  </div>
  <div class="nav-page nav-page-next">
      <a href="./01-intro.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<script src="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.js" defer="true"></script>
</body></html>