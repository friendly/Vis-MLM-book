## Animated tours

In the mid 17$^{th}$  to early 19$^{th}$-century the **Grand Tour**
became a coming-of-age custom for young Europeans 
(mainly British nobility and landed gentry)
of sufficient rank and means to undertake a journey to the principal sites of Europe
(Paris, Geneva, Rome, Athens, ...) to complete their education by learning something of
the cultural legacies in history, art, and music from antiquity to the Renaissance.
Thereby, they could gain a wider appreciation of history and be prepared to play
a role in polite society or in their chosen endeavors.

Travels in high-dimensional data space might be less thrilling than a journey
from Oxford through Paris and Turin to Rome. Yet, in both cases it is useful to
think of the path taken, and what might be seen along the way.
But there are different kinds of tours. We might simply take a meandering tour,
exploring all the way, or want to plan a tour to see the most interesting 
sites in travel or have a tour guided by an expert.
Similarly in data space, we might travel randomly to see what we can find
or be guided to find interesting features such as clusters, outliers or non-linear relations in data.

Following the demonstration in PRIM-9 (@sec-discoveries) of exploring multidimensional
data space by rotation @Asimov:85 developed the idea of the _grand tour_,
a computer method for viewing multivariate statistical data via orthogonal projections onto an animated
sequence of low-dimensional subspaces, like a movie.
In contrast to a scatterplot matrix which shows a static view of a data cloud projected onto
all pairwise variable axes, a statistical tour is like the view of an eye moving smoothly in high-dimensional
space, capturing what it sees from a given location onto the 2-d plane of the computer screen.

More generally, statistical tours are a type of dynamic projections onto orthogonal axes (called a _basis_)
that embed data in a
$p$−dimensional space into a $d$−dimensional viewing subspace. Typically, $d=2$, and 
the result is displayed as scatterplots, together with vectors representing the projections of the data variables in this space.
But the projected data can be rendered in 1-d as densities or histograms, or in other number of dimensions as glyphs,
or even as parallel coordinate plots.
The essential idea is that we can define, and animate, a _tour path_ as a smooth sequence of such projections
over small changes to the projection basis, which gives the orientation of the data in the viewing space.

Mathematically, a projection of an $(n \times p)$ data matrix $\mathbf{X}$ representing $n$ observations in $p$
dimensions onto a $d$-dimensional viewing space $\mathbf{Y}_{n \times d}$ is represented by a $p \times d$ projection matrix $\mathbf{P}$
as $\mathbf{Y} = \mathbf{X} \mathbf{P}$, where the columns of $\mathbf{P}$ are orthogonal and of unit length,i.e., 
$\mathbf{P}^T \mathbf{P} = \mathbf{I}_{(d \times d)}$.

The trick of statistical touring methods is to generate a smooth sequence of interpolated projections $\mathbf{P}_{(t)}$
indexed by time $t$, $\mathbf{P}_{(1)}, \mathbf{P}_{(2)}, \mathbf{P}_{(3)}, \dots$
giving a path of views $\mathbf{Y}_{(t)} = \mathbf{X} \mathbf{P}_{(t)}$ that can be animated in successive frames, as
shown in @fig-peng-tourr-diagram.

```{r}
#| label: fig-peng-tourr-diagram
#| echo: false
#| out-width: "90%"
#| fig-cap: "Illustration of a grand tour of interpolations of projection planes showing 2D scatterplots of the Penguin dataset"
knitr::include_graphics("images/peng-tourr-diagram.png")
```


**TODO** Include a schematic figure showing a path of projection planes, e.g., like Fig 1 in Buja et al (2005).

Asimov's [-@@Asimov:85] original idea of the grand tour was that of a random path ...

In the time since @Asimov:85, there have been many implementations of touring visualization methods ...
XGobi -> GGobi @CookSwayne:2007 ->
-> tourr @Wickham-etal-2011

The current state of art is best captured in the **tourr** package [@R-tourr]. 


```{r}
#| eval: false
load(here::here("data", "peng.RData"))
peng_scaled <- scale(peng[,3:6])
source("R/penguin/penguin-colors.R")
col <- peng.colors()[peng$species]

animate(peng_scaled, 
        guided_tour(lda_pp(peng$species)),
        display = display_xy(col = col,
                             cex = 1.5,
                             edges.width = 2))
```


::: {.content-visible unless-format="pdf"}
```{r}
#| label: fig-peng-tour-lda
#| out-width: "60%"
#| echo: false
#| fig-cap: "Animation of a grand tour of the Penguin data."
knitr::include_graphics("images/peng-tourr-lda-crop.gif")
```
:::
