## Elliptical insights: Outlier detection

The data ellipse (@sec-data-ellipse), or ellipsoid in more than 2D is fundamental in regression. But also,
as Pearson showed, it is key to understanding principal components analysis, where the principal component directions are simply
the axes of the ellipsoid of the data. As such, observations that are unusual in data space may not stand out
in univariate views of the variables, but will stand out in principal component space, usually on the _smallest_ dimension.

As an illustration, I created a dataset of $n = 100$ observations
with a linear relation, $y = x + \mathcal{N}(0, 1)$ and then
added two discrepant points at (1.5, -1.5), (-1.5, 1.5).

```{r}
set.seed(123345)
x <- c(rnorm(100),             1.5, -1.5)
y <- c(x[1:100] + rnorm(100), -1.5, 1.5)
```

When these are plotted with a data ellipse in @fig-outlier-demo (left), you can see
the discrepant points labeled 101 and 102, but they do not stand out as unusual on
either $x$ or $y$. The transformation to from data space to principal components space,
shown in @fig-outlier-demo (right),
is simply a rotation of $(x, y)$ to a space whose coordinate axes are the major and minor axes of the data ellipse, $(PC_1, PC_2)$. In this view, the additional points appear a univariate outliers on the smallest dimension, $PC_2$.

```{r}
#| label: fig-outlier-demo
#| echo: false
#| out-width: "100%"
#| fig-cap: "**Outlier demonstration**: The left panel shows the original data and highlights the two discrepant points, which do not appear to be unusual on either x or y. The right panel shows the data rotated to principal components, where the labeled points stand out on the smallest PCA dimension."
knitr::include_graphics("images/outlier-demo.png")
```

To see this more clearly, @fig-outlier-animation shows an animation of the rotation from data space to PCA space. This uses `heplots::interpPlot()` ...

::: {#fig-outlier-animation}
  <div align="center">
    <iframe width="480" height="480" src="images/outlier-demo.gif"></iframe>
      </div>
      Animation of rotation from data space to PCA space.
    :::
      
      