<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Visualizing Multivariate Data and Models in R - 9&nbsp; Case studies</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./summary.html" rel="next">
<link href="./mlm-review.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">
<span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Case studies</span>
</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Visualizing Multivariate Data and Models in R</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./getting_started.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Started</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multivariate_plots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Plots of Multivariate Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear_models.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Overview of Linear models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear_models-plots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Plots for univariate response models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hotelling.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Hotelling’s <span class="math inline">\(T^2\)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm-viz.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Visualizing Multivariate Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm-review.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Brief review of the multivariate linear model</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./case-studies.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Case studies</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Summary</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#neuro--and-social-cognitive-measures-in-psychiatric-groups" id="toc-neuro--and-social-cognitive-measures-in-psychiatric-groups" class="nav-link active" data-scroll-target="#neuro--and-social-cognitive-measures-in-psychiatric-groups"><span class="toc-section-number">9.1</span>  Neuro- and Social-cognitive measures in psychiatric groups</a>
  <ul class="collapse">
<li><a href="#research-questions" id="toc-research-questions" class="nav-link" data-scroll-target="#research-questions"><span class="toc-section-number">9.1.1</span>  Research questions</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="toc-section-number">9.1.2</span>  Data</a></li>
  <li><a href="#a-first-look" id="toc-a-first-look" class="nav-link" data-scroll-target="#a-first-look"><span class="toc-section-number">9.1.3</span>  A first look</a></li>
  <li><a href="#bivariate-views" id="toc-bivariate-views" class="nav-link" data-scroll-target="#bivariate-views"><span class="toc-section-number">9.1.4</span>  Bivariate views</a></li>
  </ul>
</li>
  <li><a href="#fitting-the-mlm" id="toc-fitting-the-mlm" class="nav-link" data-scroll-target="#fitting-the-mlm"><span class="toc-section-number">9.2</span>  Fitting the MLM</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title d-none d-lg-block">
<span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Case studies</span>
</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header><p><strong>Packages</strong> In this chapter we use the following packages. Load them now</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://friendly.github.io/heplots/">heplots</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://kwstat.github.io/corrgram/">corrgram</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This chapter presents some complete analyses of data sets that will be prominent in the book. Some of this material may later be moved to earlier chapters.</p>
<!-- **Packages** -->
<!-- In this chapter we use the following packages. Load them now -->
<!-- ```{r} -->
<!-- library(car) -->
<!-- library(heplots) -->
<!-- library(Hotelling) -->
<!-- library(ggplot2) -->
<!-- library(dplyr) -->
<!-- library(tidyr) -->
<!-- ``` -->
<section id="neuro--and-social-cognitive-measures-in-psychiatric-groups" class="level2" data-number="9.1"><h2 data-number="9.1" class="anchored" data-anchor-id="neuro--and-social-cognitive-measures-in-psychiatric-groups">
<span class="header-section-number">9.1</span> Neuro- and Social-cognitive measures in psychiatric groups</h2>
<p>A Ph.D.&nbsp;dissertation by Laura Hartman <span class="citation" data-cites="Hartman:2016">(<a href="#ref-Hartman:2016" role="doc-biblioref">2016</a>)</span> at York University was designed to evaluate whether and how clinical patients diagnosed (on the DSM-IV) as schizophrenic or with schizoaffective disorder could be distinguished from each other and from a normal, control sample on collections of standardized tests in the following domains:</p>
<ul>
<li><p><strong>Neuro-cognitive</strong>: processing speed, attention, verbal learning, visual learning and problem solving;</p></li>
<li><p><strong>Social-cognitive</strong>: managing emotions, theory of mind, externalizing, personalizing bias.</p></li>
</ul>
<p>The study is an important contribution to clinical research because the two diagnostic categories are subtly different and their symptoms often overlap. Yet, they’re very different and often require different treatments. A key difference between schizoaffective disorder and schizophrenia is the prominence of mood disorder involving bipolar, manic and depressive moods. With schizoaffective disorder, mood disorders are front and center. With schizophrenia, that is not a dominant part of the disorder, but psychotic ideation (hearing voices, seeing imaginary people) is.</p>
<section id="research-questions" class="level3" data-number="9.1.1"><h3 data-number="9.1.1" class="anchored" data-anchor-id="research-questions">
<span class="header-section-number">9.1.1</span> Research questions</h3>
<p>This example is concerned with the following substantitive questions:</p>
<ul>
<li><p>To what extent can patients diagnosed as schizophrenic or with schizoaffective disorder be distinguished from each other and from a normal control sample using a well-validated, comprehensive neurocognitive battery specifically designed for individuals with psychosis <span class="citation" data-cites="Heinrichs-etal:2015">(<a href="#ref-Heinrichs-etal:2015" role="doc-biblioref">Heinrichs et al. 2015</a>)</span> ?</p></li>
<li><p>If the groups differ, do any of the cognitive domains show particularly larger or smaller differences among these groups?</p></li>
<li><p>Do the neurocognitive discriminate among the in the same or different ways? If different, how many separate aspects or dimensions are distinguished?</p></li>
</ul>
<p>It could aid diagnosis and treatment if these similar mental disorders could be distinguished by tests in the cognitive domain.</p>
</section><section id="data" class="level3" data-number="9.1.2"><h3 data-number="9.1.2" class="anchored" data-anchor-id="data">
<span class="header-section-number">9.1.2</span> Data</h3>
<p>The clinical sample comprised 116 male and female patients who met the following criteria: 1) a diagnosis of schizophrenia (<span class="math inline">\(n\)</span> = 70) or schizoaffective disorder (<span class="math inline">\(n\)</span> = 46) confirmed by the Structured Clinical Interview for DSM-IV-TR Axis I Disorders; 2) were outpatients; 3) a history free of developmental or learning disability; 4) age 18-65; 5) a history free of neurological or endocrine disorder; and 6) no concurrent diagnosis of substance use disorder. Non-psychiatric control participants (<span class="math inline">\(n\)</span> = 146) were screened for medical and psychiatric illness and history of substance abuse and were recruited from three outpatient clinics.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">NeuroCog</span>, package<span class="op">=</span><span class="st">"heplots"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">NeuroCog</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 242</span></span>
<span><span class="co">#&gt; Columns: 10</span></span>
<span><span class="co">#&gt; $ Dx        &lt;fct&gt; Schizophrenia, Schizophrenia, Schizophrenia, Sch…</span></span>
<span><span class="co">#&gt; $ Speed     &lt;int&gt; 19, 8, 14, 7, 21, 31, -1, 17, 7, 37, 30, 26, 32,…</span></span>
<span><span class="co">#&gt; $ Attention &lt;int&gt; 9, 25, 23, 18, 9, 10, 8, 20, 30, 15, 27, 20, 23,…</span></span>
<span><span class="co">#&gt; $ Memory    &lt;int&gt; 19, 15, 15, 14, 35, 26, 3, 27, 26, 17, 28, 22, 2…</span></span>
<span><span class="co">#&gt; $ Verbal    &lt;int&gt; 33, 28, 20, 34, 28, 29, 20, 30, 26, 33, 34, 33, …</span></span>
<span><span class="co">#&gt; $ Visual    &lt;int&gt; 24, 24, 13, 16, 29, 21, 12, 32, 27, 21, 19, 18, …</span></span>
<span><span class="co">#&gt; $ ProbSolv  &lt;int&gt; 39, 40, 32, 31, 45, 33, 29, 29, 30, 33, 30, 39, …</span></span>
<span><span class="co">#&gt; $ SocialCog &lt;int&gt; 28, 37, 24, 36, 28, 28, 28, 44, 39, 24, 32, 36, …</span></span>
<span><span class="co">#&gt; $ Age       &lt;int&gt; 44, 26, 55, 53, 51, 21, 53, 56, 48, 46, 48, 31, …</span></span>
<span><span class="co">#&gt; $ Sex       &lt;fct&gt; Female, Male, Female, Male, Male, Male, Male, Fe…</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The diagnostic classification variable is called <code>Dx</code> in the data set. To facilitate answering questions regarding group differences, the following contrasts were applied: the first column compares the control group to the average of the diagnosed groups, the second compares the schizophrenia group against the schizoaffective group.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html">contrasts</a></span><span class="op">(</span><span class="va">NeuroCog</span><span class="op">$</span><span class="va">Dx</span><span class="op">)</span></span>
<span><span class="co">#&gt;                 [,1] [,2]</span></span>
<span><span class="co">#&gt; Schizophrenia   -0.5    1</span></span>
<span><span class="co">#&gt; Schizoaffective -0.5   -1</span></span>
<span><span class="co">#&gt; Control          1.0    0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this analysis, we ignore the <code>SocialCog</code> variable. The primary focus is on the variables <code>Attention : ProbSolv</code>.</p>
</section><section id="a-first-look" class="level3" data-number="9.1.3"><h3 data-number="9.1.3" class="anchored" data-anchor-id="a-first-look">
<span class="header-section-number">9.1.3</span> A first look</h3>
<p>As always, plot the data first! We want an overview of the distributions of the variables to see the centers, spread, shape and possible outliers for each group on each variable.</p>
<p>The plot below combines the use of boxplots and violin plots to give an informative display. As we saw earlier (Chapter XXX), doing this with `ggplot2 requires reshaping the data to long format.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Reshape from wide to long</span></span>
<span><span class="va">NC_long</span> <span class="op">&lt;-</span> <span class="va">NeuroCog</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">SocialCog</span>, <span class="op">-</span><span class="va">Age</span>, <span class="op">-</span><span class="va">Sex</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="va">response</span>, value <span class="op">=</span> <span class="st">"value"</span>, <span class="va">Speed</span><span class="op">:</span><span class="va">ProbSolv</span><span class="op">)</span></span>
<span><span class="co"># view 3 observations per group and measure</span></span>
<span><span class="va">NC_long</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Dx</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html">sample_n</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 9 × 3</span></span>
<span><span class="co">#&gt;   Dx              response  value</span></span>
<span><span class="co">#&gt;   &lt;fct&gt;           &lt;chr&gt;     &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 Schizophrenia   Attention    63</span></span>
<span><span class="co">#&gt; 2 Schizophrenia   ProbSolv     65</span></span>
<span><span class="co">#&gt; 3 Schizophrenia   Attention     8</span></span>
<span><span class="co">#&gt; 4 Schizoaffective Visual       24</span></span>
<span><span class="co">#&gt; 5 Schizoaffective Attention    47</span></span>
<span><span class="co">#&gt; 6 Schizoaffective ProbSolv     41</span></span>
<span><span class="co">#&gt; 7 Control         ProbSolv     55</span></span>
<span><span class="co">#&gt; 8 Control         Verbal       48</span></span>
<span><span class="co">#&gt; 9 Control         Verbal       53</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the plot, we take care to adjust the transparency (<code>alpha</code>) values for the points, violin plots and boxplots so that all can be seen. Options for <code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot()</a></code> are used to give these greater visual prominence. ::: {.cell layout-align=“center”}</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">NC_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Dx</span>, y<span class="op">=</span><span class="va">value</span>, fill<span class="op">=</span><span class="va">Dx</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>shape<span class="op">=</span><span class="fl">16</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, size<span class="op">=</span><span class="fl">1</span>, width<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.5</span>, alpha<span class="op">=</span><span class="fl">0.4</span>, </span>
<span>               outlier.alpha<span class="op">=</span><span class="fl">1</span>, outlier.size <span class="op">=</span> <span class="fl">3</span>, outlier.color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Schizo"</span>, <span class="st">"SchizAff"</span>, <span class="st">"Control"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">response</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, as.table <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"bottom"</span>,</span>
<span>        axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">rel</a></span><span class="op">(</span><span class="fl">1.2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        axis.text  <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">rel</a></span><span class="op">(</span><span class="fl">1.2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-NC-boxplot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/fig-NC-boxplot-1.png" class="img-fluid figure-img" style="width:120.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;9.1: Boxplots and violin plots of the <code>NeuroCog</code> data.</figcaption><p></p>
</figure>
</div>
</div>
<p>:::</p>
<p>We can see that the control participants score higher on all measures, but there is no consistent pattern of medians for the two patient groups. But these univariate summaries do not inform about the relations among variables.</p>
</section><section id="bivariate-views" class="level3" data-number="9.1.4"><h3 data-number="9.1.4" class="anchored" data-anchor-id="bivariate-views">
<span class="header-section-number">9.1.4</span> Bivariate views</h3>
<p>A corrgram <span class="citation" data-cites="Friendly:02:corrgram">(<a href="#ref-Friendly:02:corrgram" role="doc-biblioref">Friendly 2002</a>)</span> provides a useful reconnaisance plot of the bivariate correlations in the data set.It suppresses details, and allows focus on the overall pattern. The <code><a href="https://kwstat.github.io/corrgram/reference/corrgram.html">corrgram::corrgram()</a></code> function has the ability to enhance perception by permuting the variables in the order of their variable vectors in a biplot.</p>
<p>The plot below includes all variables except for <code>Dx</code> group. There are a number of <code>panel.*</code> functions for choosing how the correlation for each pair is rendered.</p>
<div class="cell" data-layout-align="center" data-fig.asp="1">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">NeuroCog</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Dx</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://kwstat.github.io/corrgram/reference/corrgram.html">corrgram</a></span><span class="op">(</span>order <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>           diag.panel <span class="op">=</span> <span class="va">panel.density</span>,</span>
<span>           upper.panel <span class="op">=</span> <span class="va">panel.pie</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-NC-corrgram" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/fig-NC-corrgram-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;9.2: Scatterplot matrix of the <code>NeuroCog</code> data. Points are suppressed here, focusing on the data ellipses and regression lines</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>A scatterplot matrix gives a more detailed overview of all pairwise relations. The plot below suppresses the data points and summarises the relation using data ellipses and regression lines. The model syntax, <code>~ Speed + ... |Dx</code>, treats <code>Dx</code> as a conditioning variable, giving a separate data ellipse and regression line for each group.</p>
<div class="cell" data-layout-align="center" data-fig.asp="1">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/scatterplotMatrix.html">scatterplotMatrix</a></span><span class="op">(</span><span class="op">~</span> <span class="va">Speed</span> <span class="op">+</span> <span class="va">Attention</span> <span class="op">+</span> <span class="va">Memory</span> <span class="op">+</span> <span class="va">Verbal</span> <span class="op">+</span> <span class="va">Visual</span> <span class="op">+</span> <span class="va">ProbSolv</span> <span class="op">|</span> <span class="va">Dx</span>,</span>
<span>  data<span class="op">=</span><span class="va">NeuroCog</span>,</span>
<span>  plot.points <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  smooth <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  col <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/hue_pal.html">hue_pal</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>  ellipse<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>levels<span class="op">=</span><span class="fl">0.68</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-NC-scatmat" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/fig-NC-scatmat-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;9.3: Scatterplot matrix of the <code>NeuroCog</code> data. Points are suppressed here, focusing on the data ellipses and regression lines</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><strong>TODO</strong>: Should we add biplot here?</p>
</section></section><section id="fitting-the-mlm" class="level2" data-number="9.2"><h2 data-number="9.2" class="anchored" data-anchor-id="fitting-the-mlm">
<span class="header-section-number">9.2</span> Fitting the MLM</h2>
<p>We proceed to fit the model … ::: {.cell}</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">NC.mlm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">Speed</span>, <span class="va">Attention</span>, <span class="va">Memory</span>, <span class="va">Verbal</span>, <span class="va">Visual</span>, <span class="va">ProbSolv</span><span class="op">)</span> <span class="op">~</span> <span class="va">Dx</span>,</span>
<span>             data<span class="op">=</span><span class="va">NeuroCog</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html">Anova</a></span><span class="op">(</span><span class="va">NC.mlm</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type II MANOVA Tests: Pillai test statistic</span></span>
<span><span class="co">#&gt;    Df test stat approx F num Df den Df  Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; Dx  2     0.299     6.89     12    470 1.6e-11 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>:::</p>
<p>The first research question is captured by the contrasts for the <code>Dx</code> factor shown above. We can test these with <code><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html">car::linearHypothesis()</a></code>. The contrast <code>Dx1</code> for control vs.&nbsp;diagnosed is highly significant, but the second contrast <code>Dx2</code> comparing the schizophrenic and schizoaffective group is not. ::: {.cell}</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># control vs. patients</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html">linearHypothesis</a></span><span class="op">(</span><span class="va">NC.mlm</span>, <span class="st">"Dx1"</span><span class="op">)</span>, SSP<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multivariate Tests: </span></span>
<span><span class="co">#&gt;                  Df test stat approx F num Df den Df  Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; Pillai            1     0.289     15.9      6    234 2.8e-15 ***</span></span>
<span><span class="co">#&gt; Wilks             1     0.711     15.9      6    234 2.8e-15 ***</span></span>
<span><span class="co">#&gt; Hotelling-Lawley  1     0.407     15.9      6    234 2.8e-15 ***</span></span>
<span><span class="co">#&gt; Roy               1     0.407     15.9      6    234 2.8e-15 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span></span>
<span><span class="co"># Schizo vs SchizAff</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html">linearHypothesis</a></span><span class="op">(</span><span class="va">NC.mlm</span>, <span class="st">"Dx2"</span><span class="op">)</span>, SSP<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multivariate Tests: </span></span>
<span><span class="co">#&gt;                  Df test stat approx F num Df den Df Pr(&gt;F)</span></span>
<span><span class="co">#&gt; Pillai            1     0.006    0.249      6    234   0.96</span></span>
<span><span class="co">#&gt; Wilks             1     0.994    0.249      6    234   0.96</span></span>
<span><span class="co">#&gt; Hotelling-Lawley  1     0.006    0.249      6    234   0.96</span></span>
<span><span class="co">#&gt; Roy               1     0.006    0.249      6    234   0.96</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>:::</p>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-Friendly:02:corrgram" class="csl-entry" role="doc-biblioentry">
Friendly, Michael. 2002. <span>“Corrgrams: Exploratory Displays for Correlation Matrices.”</span> <em>The American Statistician</em> 56 (4): 316–24. <a href="http://datavis.ca/papers/corrgram.pdf">http://datavis.ca/papers/corrgram.pdf</a>.
</div>
<div id="ref-Hartman:2016" class="csl-entry" role="doc-biblioentry">
Hartman, L. I. 2016. <span>“Schizophrenia and Schizoaffective Disorder: One Condition or Two?”</span> PhD dissertation, York University.
</div>
<div id="ref-Heinrichs-etal:2015" class="csl-entry" role="doc-biblioentry">
Heinrichs, R. Walter, Farena Pinnock, Eva Muharib, Leah Hartman, Joel Goldberg, and Stephanie McDermid Vaz. 2015. <span>“Neurocognitive Normality in Schizophrenia Revisited.”</span> <em>Schizophrenia Research: Cognition</em> 2 (4): 227–32. <a href="https://doi.org/10.1016/j.scog.2015.09.001">https://doi.org/10.1016/j.scog.2015.09.001</a>.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./mlm-review.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Brief review of the multivariate linear model</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./summary.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Summary</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>