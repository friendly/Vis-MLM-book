<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Visualizing Multivariate Data and Models in R - 3&nbsp; Plots of Multivariate Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./linear_models.html" rel="next">
<link href="./getting_started.html" rel="prev">
<link href="./images/favicon/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Plots of Multivariate Data</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Visualizing Multivariate Data and Models in R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/friendly/vis-MLM-quarto" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./getting_started.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Started</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multivariate_plots.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Plots of Multivariate Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear_models.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Overview of Linear models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear_models-plots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Plots for univariate response models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hotelling.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Hotelling’s <span class="math inline">\(T^2\)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm-viz.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Visualizing Multivariate Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm-review.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Brief review of the multivariate linear model</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./case-studies.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Case studies</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eqcov.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Visualizing Tests for Equality of Covariance Matrices</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Summary</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Package used</span></a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#sec-bivariate_summaries" id="toc-sec-bivariate_summaries" class="nav-link active" data-scroll-target="#sec-bivariate_summaries"><span class="toc-section-number">3.1</span>  Bivariate summaries</a>
  <ul class="collapse">
<li><a href="#the-data-ellipse" id="toc-the-data-ellipse" class="nav-link" data-scroll-target="#the-data-ellipse"><span class="toc-section-number">3.1.1</span>  The Data Ellipse</a></li>
  </ul>
</li>
  <li><a href="#r-functions-for-data-ellipses" id="toc-r-functions-for-data-ellipses" class="nav-link" data-scroll-target="#r-functions-for-data-ellipses"><span class="toc-section-number">3.2</span>  R functions for data ellipses</a></li>
  <li><a href="#sec-quantitative_data" id="toc-sec-quantitative_data" class="nav-link" data-scroll-target="#sec-quantitative_data"><span class="toc-section-number">3.3</span>  Quantitative data:</a></li>
  <li><a href="#categorical-data" id="toc-categorical-data" class="nav-link" data-scroll-target="#categorical-data"><span class="toc-section-number">3.4</span>  Categorical data:</a></li>
  <li><a href="#generalized-pair-plots" id="toc-generalized-pair-plots" class="nav-link" data-scroll-target="#generalized-pair-plots"><span class="toc-section-number">3.5</span>  Generalized pair plots</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-multivariate_plots" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Plots of Multivariate Data</span></span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header><ul>
<li>Bivariate summaries
<ul>
<li>smoothers</li>
<li>data ellipses</li>
</ul>
</li>
<li>Quantitative data:
<ul>
<li>scatterplot matrices</li>
<li>parallel coordinate plots</li>
</ul>
</li>
<li>Categorical data:
<ul>
<li>mosaic plots</li>
</ul>
</li>
<li>Generalized pair plots</li>
</ul>
<section id="sec-bivariate_summaries" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="sec-bivariate_summaries">
<span class="header-section-number">3.1</span> Bivariate summaries</h2>
<pre><code>+ smoothers
+ data ellipses
    </code></pre>
<section id="the-data-ellipse" class="level3" data-number="3.1.1"><h3 data-number="3.1.1" class="anchored" data-anchor-id="the-data-ellipse">
<span class="header-section-number">3.1.1</span> The Data Ellipse</h3>
<p>The <em>data ellipse</em> <span class="citation" data-cites="Monette:90">(<a href="#ref-Monette:90" role="doc-biblioref">Monette 1990</a>)</span>, or <em>concentration ellipse</em> <span class="citation" data-cites="Dempster:69">(<a href="#ref-Dempster:69" role="doc-biblioref">Dempster 1969</a>)</span> is a remarkably simple and effective display for viewing and understanding bivariate relationships in multivariate data. The data ellipse is typically used to add a visual summary to a scatterplot, that shows all together the means, standard deviations, correlation, and slope of the regression line for two variables. Under the classical assumption that the data are bivariate normally distributed, the data ellipse is also a <strong>sufficient</strong> visual summary, in the sense that it captures <strong>all</strong> relevant features of the data. See <span class="citation" data-cites="Friendly-etal:ellipses:2013">Friendly, Monette, and Fox (<a href="#ref-Friendly-etal:ellipses:2013" role="doc-biblioref">2013</a>)</span> for a complete discussion of the role of ellipsoids in statistical data visualization.</p>
<p>It is based on the idea that in a bivariate normal distribution, the contours of equal probability form a series of concentric ellipses. If the variables were uncorrelated and had the same variances, these would be circles, and Euclidean distance would measure the distance of each observation from the mean. When the variables are correlated, a different measure, <em>Mahalanobis distance</em> is the proper measure of how far a point is from the mean.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-mahalanobis" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/mahalanobis.png" class="img-fluid figure-img" style="width:50.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3.1: 2D data with curves of constant distance from the centroid. Which of the points A and B is further from the mean (X)? <em>Source</em>: <a href="https://ouzhang.rbind.io/2020/11/16/outliers-part4/">Ou Zhang</a></figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>To illustrate, <a href="#fig-mahalanobis">Figure&nbsp;<span class="quarto-unresolved-ref">fig-mahalanobis</span></a> shows a scatterplot with labels for two points, “A” and “B”. Which is further from the mean, “X”? A contour of constant Euclidean distance, shown by the red dashed circle, ignores the apparent negative correlation, so point “A” is further. The blue ellipse for Mahalanobis distance takes the correlation into account, so point “B” has a greater distance from the mean.</p>
<p>Mathematically, Euclidean (squared) distance for <span class="math inline">\(p\)</span> variables, <span class="math inline">\(j = 1, 2, \dots , p\)</span>, is just a generalization of the square of a univariate standardized (<span class="math inline">\(z\)</span>) score, <span class="math inline">\(z^2 = [(y - \bar{y}) / s]^2\)</span>,</p>
<p><span class="math display">\[
D_E^2 (\mathbf{y}) = \sum_j^p z_j^2 = \mathbf{z}^T  \mathbf{z} = (\mathbf{y} - \bar{\mathbf{y}})^T \operatorname{diag}(\mathbf{S})^{-1} (\mathbf{y} - \bar{\mathbf{y}}) \; ,
\]</span> where <span class="math inline">\(\mathbf{S}\)</span> is the sample variance-covariance matrix, <span class="math inline">\(\mathbf{S} = ({n-1})^{-1} \sum_{i=1}^n (\mathbf{y}_i - \bar{\mathbf{y}})^T (\mathbf{y}_i - \bar{\mathbf{y}})\)</span>.</p>
<p>Mahalanobis’ distance takes the correlations into account simply by using the covariances as well as the variances, <span class="math display">\[
D_M^2 (\mathbf{y}) = (\mathbf{y} - \bar{\mathbf{y}})^T S^{-1} (\mathbf{y} - \bar{\mathbf{y}}) \; .
\]</span> For <span class="math inline">\(p\)</span> variables, the data <em>ellipsoid</em> <span class="math inline">\(\mathcal{E}_c\)</span> of size <span class="math inline">\(c\)</span> is a <span class="math inline">\(p\)</span>-dimensional ellipse, defined as the set of points <span class="math inline">\(\mathbf{y} = (y_1, y_2, \dots y_p)\)</span> whose squared Mahalanobis distance, <span class="math inline">\(D_M^2 ( \mathbf{y} )\)</span> is less than or equal to <span class="math inline">\(c^2\)</span>.</p>
<p>When <span class="math inline">\(\mathbf{y}\)</span> is (at least approximately) bivariate normal, <span class="math inline">\(D_M^2(\mathbf{y})\)</span> has a large-sample <span class="math inline">\(\chi^2_2\)</span> distribution (<span class="math inline">\(\chi^2\)</span> with 2 df), so taking <span class="math inline">\(c^2 = \chi^2_2 (0.68) = 2.28\)</span> gives a “1 standard deviation bivariate ellipse,” an analog of the standard interval <span class="math inline">\(\bar{y} \pm 1 s\)</span>, while <span class="math inline">\(c^2 = \chi^2_2 (0.95) = 5.99 \approx 6\)</span> gives a data ellipse of 95% coverage.</p>
<section id="properties" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="properties">Properties</h4>
<p>The essential ideas of correlation and regression and their relation to ellipses go back to <span class="citation" data-cites="Galton:1886">Galton (<a href="#ref-Galton:1886" role="doc-biblioref">1886</a>)</span>. Galton’s goal was to to predict (or explain) how a heritable trait, <span class="math inline">\(Y\)</span>, (e.g., height) of children was related to that of their parents, <span class="math inline">\(X\)</span>. He made a semi-graphic table of the frequencies of 928 observations of the average height of father and mother versus the height of their child, shown in <a href="#fig-galton-corr">Figure&nbsp;<span class="quarto-unresolved-ref">fig-galton-corr</span></a>. He then drew smoothed contour lines of equal frequencies and had the wonderful visual insight that these formed concentric shapes that were tolerably close to ellipses. He then calculated summaries, <span class="math inline">\(\mathrm{Ave}(Y | X)\)</span>, and, for symmetry, <span class="math inline">\(\mathrm{Ave}(X | Y)\)</span>, and plotted these as lines of means on his diagram. Lo and behold, he had a second visual insight: the lines of means of (<span class="math inline">\(Y | X\)</span>) and (<span class="math inline">\(X | Y\)</span>) corresponded approximately to the loci of horizontal and vertical tangents to the concentric ellipses. To complete the picture, he added lines showing the major and minor axes of the family of ellipses, with the result shown in <a href="#fig-galton-corr">Figure&nbsp;<span class="quarto-unresolved-ref">fig-galton-corr</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-galton-corr" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/galton-corr.jpg" class="img-fluid figure-img" style="width:70.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3.2: Galton’s 1886 diagram, showing the relationship of height of children to the average of their parents’ height. The diagram is essentially an overlay of a geometrical interpretation on a bivariate grouped frequency distribution, shown as numbers.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>For two variables, <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, the remarkable properties of the data ellipse are illustrated in <a href="#fig-galton-ellipse-r">Figure&nbsp;<span class="quarto-unresolved-ref">fig-galton-ellipse-r</span></a>, a modern reconstruction of Galton’s diagram.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-galton-ellipse-r" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/galton-ellipse-r.jpg" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3.3: Sunflower plot of Galton’s data on heights of parents and their children (in.), with 40%, 68% and 95% data ellipses and the regression lines of <span class="math inline">\(y\)</span> on <span class="math inline">\(x\)</span> (black) and <span class="math inline">\(x\)</span> on <span class="math inline">\(y\)</span> (grey).</figcaption><p></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>The ellipses have the mean vector <span class="math inline">\((\bar{x}, \bar{y})\)</span> as their center.</p></li>
<li><p>The lengths of arms of the central cross show the standard deviations of the variables, which correspond to the shadows of the ellipse covering 40% of the data. These are the bivariate analogs of the standard intervals <span class="math inline">\(\bar{x} \pm 1 s_x\)</span> and <span class="math inline">\(\bar{y} \pm 1 s_y\)</span>.</p></li>
<li><p>More generally, shadows (projections) on the coordinate axes, or any linear combination of them, give any standard interval, <span class="math inline">\(\bar{x} \pm k s_x\)</span> and <span class="math inline">\(\bar{y} \pm k s_y\)</span>. Those with <span class="math inline">\(k=1, 1.5, 2.45\)</span>, have bivariate coverage 40%, 68% and 95%, corresponding to these quantiles of the <span class="math inline">\(\chi^2\)</span> distribution with 2 degrees of freedom, i.e., <span class="math inline">\(\chi^2_2 (.40) \approx 1^2\)</span>, <span class="math inline">\(\chi^2_2 (.68) \approx 1.5^2\)</span>, and <span class="math inline">\(\chi^2_2 (.95) \approx 2.45\)</span>. <!-- and univariate coverage 68\%, 87\% and 98.6\% respectively. --></p></li>
<li><p>The regression line predicting <span class="math inline">\(y\)</span> from <span class="math inline">\(x\)</span> goes through the points where the ellipses have vertical tangents. The <em>other</em> regression line, predicting <span class="math inline">\(x\)</span> from <span class="math inline">\(y\)</span> goes through the points of horizontal tangency.</p></li>
<li><p>The correlation <span class="math inline">\(r(x, y)\)</span> is the ratio of the vertical segment from the mean of <span class="math inline">\(y\)</span> to the regression line to the vertical segment going to the top of the ellipse as shown at the right of the figure. It is <span class="math inline">\(r = 0.46\)</span> in this example.</p></li>
<li><p>The residual standard deviation, <span class="math inline">\(s_e = \sqrt{MSE} = \sqrt{\Sigma (y - \bar{y})^2 / n-2}\)</span>, is the half-length of the ellipse at the mean <span class="math inline">\(\bar{x}\)</span></p></li>
</ul>
<p>Because Galton’s values of <code>parent</code> and <code>child</code> height were recorded in class intervals of 1 in., they are shown as sunflower symbols in <a href="#fig-galton-ellipse-r">Figure&nbsp;<span class="quarto-unresolved-ref">fig-galton-ellipse-r</span></a>, with multiple ‘petals’ reflecting the number of observations at each location. This plot is constructed using <code><a href="https://rdrr.io/r/graphics/sunflowerplot.html">sunflowerplot()</a></code> and <code><a href="https://rdrr.io/pkg/car/man/Ellipses.html">car::dataEllipse()</a></code> for the ellipses.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">Galton</span>, package <span class="op">=</span> <span class="st">"HistData"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/sunflowerplot.html">sunflowerplot</a></span><span class="op">(</span><span class="va">parent</span> <span class="op">~</span> <span class="va">child</span>, data<span class="op">=</span><span class="va">Galton</span>, </span>
<span>      xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">61</span>,<span class="fl">75</span><span class="op">)</span>, </span>
<span>      ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">61</span>,<span class="fl">75</span><span class="op">)</span>, </span>
<span>      seg.col<span class="op">=</span><span class="st">"black"</span>, </span>
<span>        xlab<span class="op">=</span><span class="st">"Child height"</span>, </span>
<span>      ylab<span class="op">=</span><span class="st">"Mid Parent height"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">y.x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">parent</span> <span class="op">~</span> <span class="va">child</span>, data<span class="op">=</span><span class="va">Galton</span><span class="op">)</span>     <span class="co"># regression of y on x</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="va">y.x</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">x.y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">child</span> <span class="op">~</span> <span class="va">parent</span>, data<span class="op">=</span><span class="va">Galton</span><span class="op">)</span>     <span class="co"># regression of x on y</span></span>
<span><span class="va">cc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">x.y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="op">-</span><span class="va">cc</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">cc</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">1</span><span class="op">/</span><span class="va">cc</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, lwd<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"gray"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">Galton</span>, </span>
<span>     <span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Ellipses.html">dataEllipse</a></span><span class="op">(</span><span class="va">child</span>, <span class="va">parent</span>, </span>
<span>         plot.points<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>         levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.40</span>, <span class="fl">0.68</span>, <span class="fl">0.95</span><span class="op">)</span>, </span>
<span>         lty<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section></section><section id="r-functions-for-data-ellipses" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="r-functions-for-data-ellipses">
<span class="header-section-number">3.2</span> R functions for data ellipses</h2>
<p>A number of packages provide functions for drawing data ellipses of data, with various features.</p>
<ul>
<li><code><a href="https://rdrr.io/pkg/car/man/scatterplot.html">car::scatterplot()</a></code></li>
<li><code><a href="https://rdrr.io/pkg/car/man/Ellipses.html">car::dataEllipse()</a></code></li>
<li><code><a href="http://friendly.github.io/heplots/reference/covEllipses.html">heplots::covEllipses()</a></code></li>
<li><code><a href="https://ggplot2.tidyverse.org/reference/stat_ellipse.html">ggplot2::stat_ellipse()</a></code></li>
</ul></section><section id="sec-quantitative_data" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="sec-quantitative_data">
<span class="header-section-number">3.3</span> Quantitative data:</h2>
<pre><code>+ scatterplot matrices
+ parallel coordinate plots</code></pre>
</section><section id="categorical-data" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="categorical-data">
<span class="header-section-number">3.4</span> Categorical data:</h2>
<pre><code>+ mosaic plots</code></pre>
</section><section id="generalized-pair-plots" class="level2" data-number="3.5"><h2 data-number="3.5" class="anchored" data-anchor-id="generalized-pair-plots">
<span class="header-section-number">3.5</span> Generalized pair plots</h2>
<div class="cell" data-layout-align="center">
<pre><code>#&gt; 7  packages used here:
#&gt;  base, datasets, graphics, grDevices, methods, stats, utils</code></pre>
</div>
</section><section id="references" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="references">References</h2>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-Dempster:69" class="csl-entry" role="doc-biblioentry">
Dempster, A. P. 1969. <em>Elements of Continuous Multivariate Analysis</em>. Reading, MA: Addison-Wesley.
</div>
<div id="ref-Friendly-etal:ellipses:2013" class="csl-entry" role="doc-biblioentry">
Friendly, Michael, Georges Monette, and John Fox. 2013. <span>“Elliptical Insights: Understanding Statistical Methods Through Elliptical Geometry.”</span> <em>Statistical Science</em> 28 (1): 1–39. <a href="https://doi.org/10.1214/12-STS402">https://doi.org/10.1214/12-STS402</a>.
</div>
<div id="ref-Galton:1886" class="csl-entry" role="doc-biblioentry">
Galton, Francis. 1886. <span>“Regression Towards Mediocrity in Hereditary Stature.”</span> <em>Journal of the Anthropological Institute</em> 15: 246–63. <a href="http://www.jstor.org/cgi-bin/jstor/viewitem/09595295/dm995266/99p0374f/0">http://www.jstor.org/cgi-bin/jstor/viewitem/09595295/dm995266/99p0374f/0</a>.
</div>
<div id="ref-Monette:90" class="csl-entry" role="doc-biblioentry">
Monette, Georges. 1990. <span>“Geometry of Multiple Regression and Interactive 3-<span>D</span> Graphics.”</span> In <em>Modern Methods of Data Analysis</em>, edited by J. Fox and S. Long, 209–56. Beverly Hills, CA: SAGE Publications.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./getting_started.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Started</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./linear_models.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Overview of Linear models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>