<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Visualizing Multivariate Data and Models in R - 6&nbsp; Hotelling’s \(T^2\)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./mlm-review.html" rel="next">
<link href="./linear_models-plots.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">
<span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Hotelling’s <span class="math inline">\(T^2\)</span></span>
</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Visualizing Multivariate Data and Models in R</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./getting_started.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Started</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multivariate_plots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Plots of Multivariate Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear_models.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Overview of Linear models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear_models-plots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Plots for univariate response models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hotelling.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Hotelling’s <span class="math inline">\(T^2\)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm-review.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Brief review of the multivariate linear model</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Summary</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#t2-as-a-generalized-t-test" id="toc-t2-as-a-generalized-t-test" class="nav-link active" data-scroll-target="#t2-as-a-generalized-t-test"><span class="toc-section-number">6.1</span>  <span class="math inline">\(T^2\)</span> as a generalized <span class="math inline">\(t\)</span>-test</a></li>
  <li>
<a href="#t2-properties" id="toc-t2-properties" class="nav-link" data-scroll-target="#t2-properties"><span class="toc-section-number">6.2</span>  <span class="math inline">\(T^2\)</span> properties</a>
  <ul class="collapse">
<li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  </ul>
</li>
  <li><a href="#he-plot-and-discriminant-axis" id="toc-he-plot-and-discriminant-axis" class="nav-link" data-scroll-target="#he-plot-and-discriminant-axis"><span class="toc-section-number">6.3</span>  HE plot and discriminant axis</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="toc-section-number">6.4</span>  Exercises</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title d-none d-lg-block">
<span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Hotelling’s <span class="math inline">\(T^2\)</span></span>
</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header><p><strong>Packages</strong> In this chapter we use the following packages. Load them now</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://friendly.github.io/heplots/">heplots</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jmcurran/Hotelling">Hotelling</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Just as the one- and two- sample univariate <span class="math inline">\(t\)</span>-test is the gateway drug for understanding analysis of variance, so to Hotelling’s <span class="math inline">\(T^2\)</span> test provides an entry point to multivariate analysis of variance.</p>
<p>The essential idea is that Hotelling’s <span class="math inline">\(T^2\)</span> provides a test of the difference in means between two groups on a collection of variables, <span class="math inline">\(\mathbf{x} = x_1, x_2, \dots x_p\)</span> <em>simultaneously</em>, rather than one by one. This has the advantages that it</p>
<ul>
<li>does not require correcting for multiple tests (e.g., Bonferroni)</li>
<li>combines the evidence from the multiple response variables, and <em>pools strength</em>,</li>
<li>shows how the multiple response are jointly related to the group effect along a single dimension, the <em>discriminant axis</em>.</li>
</ul>
<p>After describing it’s features, I use an example of a two-group <span class="math inline">\(T^2\)</span> test to illustrate the basic ideas behind multivariate tests and hypothesis error plots.</p>
<section id="t2-as-a-generalized-t-test" class="level2" data-number="6.1"><h2 data-number="6.1" class="anchored" data-anchor-id="t2-as-a-generalized-t-test">
<span class="header-section-number">6.1</span> <span class="math inline">\(T^2\)</span> as a generalized <span class="math inline">\(t\)</span>-test</h2>
<p>Hotelling’s <span class="math inline">\(T^2\)</span> <span class="citation" data-cites="Hotelling:1931">(<a href="#ref-Hotelling:1931" role="doc-biblioref">Hotelling 1931</a>)</span> is like the square of a univariate <span class="math inline">\(t\)</span> statistic. Consider the basic one-sample <span class="math inline">\(t\)</span>-test, where we wish to test the hypothesis that the mean <span class="math inline">\(\bar{x}\)</span> of a set of <span class="math inline">\(N\)</span> measures on a test of basic math, with standard deviation <span class="math inline">\(s\)</span> does not differ from an assumed mean <span class="math inline">\(\mu_0 = 150\)</span> for a population. The <span class="math inline">\(t\)</span> statistic for testing <span class="math inline">\(H_0 : \mu = \mu_0\)</span> against the two-sided alternative, <span class="math inline">\(H_0 : \mu \ne \mu_0\)</span> is <span class="math display">\[
t = \frac{(\bar{x} - \mu_0)}{s / \sqrt{N}} = \frac{(\bar{x} - \mu_0)\sqrt{N}}{s}
\]</span></p>
<p>Squaring this gives</p>
<p><span class="math display">\[
t^2 = \frac{N (\bar{x} - \mu_0)^2}{s} = N (\bar{x} - \mu_0)(s^2)^{-1} (\bar{x} - \mu_0)
\]</span></p>
<p>Now consider we also have measures on a test of solving word problems for the same sample. Then, a hypothesis test for the means on basic math (BM) and word problems (WP) is the test of the means of these two variables jointly equal their separate values, say, <span class="math inline">\((150, 100)\)</span>.</p>
<p><span class="math display">\[
H_0 : \mathbf{\mu} = \mathbf{\mu_0} =
  \begin{pmatrix}
    \mu_{0,BM} \\ \mu_{0,WP}
  \end{pmatrix}
  =
  \begin{pmatrix}
    150 \\ 100
  \end{pmatrix}
\]</span></p>
<!-- ![](equations/eqn-mathscore1.png){width=50% fig-align="center"} -->
<p>Hotelling’s <span class="math inline">\(T^2\)</span> is then the analog of <span class="math inline">\(t^2\)</span>, with the variance-covariance matrix <span class="math inline">\(\mathbf{S}\)</span> of the scores on (BM, WP) replacing the variance of a single score. This is nothing more than the squared Mahalanobis distance between the sample mean vector <span class="math inline">\((\bar{x}_{BM}, \bar{x}_{BM})^T\)</span> and the hypothesized means <span class="math inline">\(\mathbf{\mu}_0\)</span>, in the metric of <span class="math inline">\(\mathbf{S}\)</span>, as shown in <a href="#fig-T2-diagram">Figure&nbsp;<span class="quarto-unresolved-ref">fig-T2-diagram</span></a>.</p>
<p><span class="math display">\[\begin{align*}
T^2 &amp;= N (\bar{\mathbf{x}} - \mathbf{\mu}_0)^T \; \mathbf{S}^{-1} \; (\bar{\mathbf{x}} - \mathbf{\mu}_0) \\
    &amp;= N D^2_M (\bar{\mathbf{x}}, \mathbf{\mu}_0)
\end{align*}\]</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-T2-diagram" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/T2-diagram.png" class="img-fluid figure-img" style="width:50.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;6.1: Hotelling’s T^2 statistic as the squared distance between the sample means and hypothesized means relative to the variance-covariance matrix. <em>Source</em>: Author</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="t2-properties" class="level2" data-number="6.2"><h2 data-number="6.2" class="anchored" data-anchor-id="t2-properties">
<span class="header-section-number">6.2</span> <span class="math inline">\(T^2\)</span> properties</h2>
<p>Aside from it’s elegant geometric interpretation Hotelling’s <span class="math inline">\(T^2\)</span> has simple properties that aid in understanding the extension to more complex multivariate tests.</p>
<ul>
<li>
<strong>Maximum <span class="math inline">\(t^2\)</span></strong> : Consider a linear combination <span class="math inline">\(w\)</span> of the scores in a matrix <span class="math inline">\(\mathbf{X} = [ \mathbf{x_1}, \mathbf{x_2}, \dots, \mathbf{x_p}]\)</span> with weights <span class="math inline">\(\mathbf{a}\)</span>,</li>
</ul>
<p><span class="math display">\[
w = a_1 \mathbf{x_1} + a_2 \mathbf{x_2} + \dots + a_p \mathbf{x_p} = \mathbf{X} \mathbf{a}
\]</span> Hotelling’s <span class="math inline">\(T^2\)</span> is then the maximum value of a univariate <span class="math inline">\(t^2 (\mathbf{a})\)</span> for all choices of the weights in <span class="math inline">\(\mathbf{a}\)</span>.</p>
<ul>
<li><p><strong>Eigenvalue</strong> : Hotelling showed that <span class="math inline">\(T^2\)</span> is the one non-zero eigenvalue (latent root) <span class="math inline">\(\lambda\)</span> of the matrix <span class="math inline">\(\mathbf{Q}_H = N (\bar{\mathbf{x}} - \mathbf{\mu}_0)^T (\bar{\mathbf{x}} - \mathbf{\mu}_0)\)</span> relative to <span class="math inline">\(\mathbf{Q}_E = \mathbf{S}\)</span> that solves the equation <span id="eq-eigen"><span class="math display">\[
(\mathbf{Q}_H - \lambda \mathbf{Q}_E) \mathbf{a} = 0
\tag{6.1}\]</span></span></p></li>
<li><p><strong>Eigenvector</strong> : The corresponding eigenvector is <span class="math inline">\(\mathbf{a} = \mathbf{S}^{-1} (\bar{\mathbf{x}} - \mathbf{\mu}_0)\)</span>. These are the (raw) discriminant coefficients, giving the relative contribution of each variable to <span class="math inline">\(T^2\)</span>.</p></li>
<li><p><strong>Critical values</strong> : For a single response, the square of a <span class="math inline">\(t\)</span> statistic with <span class="math inline">\(N-1\)</span> degrees of freedom is an <span class="math inline">\(F (1, N-1)\)</span> statistic. Because we chose <span class="math inline">\(\mathbf{a}\)</span> to give the maximum <span class="math inline">\(t^2 (\mathbf{a})\)</span>, this can be taken into account with a transformation of <span class="math inline">\(T^2\)</span> to give a proper <span class="math inline">\(F\)</span> test, <span class="math display">\[
F^* = \frac{N - p}{p (N-1)} T^2 \; \sim \; F (p, N - p)
\]</span></p></li>
<li><p><strong>Invariance under linear transformation</strong> : Just as a univariate <span class="math inline">\(t\)</span>-test is unchanged if we apply a linear transformation to the variable, <span class="math inline">\(x \rightarrow a x + b\)</span>, <span class="math inline">\(T^2\)</span> is invariant under all linear (affine) transformations, <span class="math display">\[
\mathbf{x}_{p \times 1} \rightarrow \mathbf{C}_{p \times p} \mathbf{x} + \mathbf{b}
\]</span> The same is true for all MANOVA tests.</p></li>
<li><p><strong>Two-sample tests</strong> : With minor variations in notation, everything above applies to the more usual test of equality of multivariate means in a two sample test of <span class="math inline">\(H_0 : \mathbf{\mu}_1 = \mathbf{\mu}_2\)</span>. <span class="math display">\[
T^2 = N (\bar{\mathbf{x}}_1 - \bar{\mathbf{x}}_2)^T \; \mathbf{S}_p^{-1} \; (\bar{\mathbf{x}}_1 - \bar{\mathbf{x}}_2)
\]</span> where <span class="math inline">\(\mathbf{S}_p\)</span> is the pooled within-sample variance covariance matrix.</p></li>
</ul>
<section id="example" class="level3 unnumbered"><h3 class="unnumbered anchored" data-anchor-id="example">Example</h3>
<p>The data set <code>mathscore</code> gives (fictitious) scores on a test of basic math skills (BM) and solving word problems (WP) for two groups of <span class="math inline">\(N=6\)</span> students in an algebra course, each taught by different instructors.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">mathscore</span>, package <span class="op">=</span> <span class="st">"heplots"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">mathscore</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    12 obs. of  3 variables:</span></span>
<span><span class="co">#&gt;  $ group: Factor w/ 2 levels "1","2": 1 1 1 1 1 1 2 2 2 2 ...</span></span>
<span><span class="co">#&gt;  $ BM   : int  190 170 180 200 150 180 160 190 150 160 ...</span></span>
<span><span class="co">#&gt;  $ WP   : int  90 80 80 120 60 70 120 150 90 130 ...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can carry out the test that the means for both variables are equal using either <code><a href="https://rdrr.io/pkg/Hotelling/man/hotelling.test.html">Hotelling::hotelling.test</a></code> <span class="citation" data-cites="R-Hotelling">(<a href="#ref-R-Hotelling" role="doc-biblioref">Curran and Hersh 2021</a>)</span> or <code><a href="https://rdrr.io/pkg/car/man/Anova.html">car::Anova()</a></code>,</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/Hotelling/man/hotelling.test.html">hotelling.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">BM</span>, <span class="va">WP</span><span class="op">)</span> <span class="op">~</span> <span class="va">group</span>, data<span class="op">=</span><span class="va">mathscore</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Test stat:  64.174 </span></span>
<span><span class="co">#&gt; Numerator df:  2 </span></span>
<span><span class="co">#&gt; Denominator df:  9 </span></span>
<span><span class="co">#&gt; P-value:  0.0001213</span></span>
<span></span>
<span><span class="va">math.mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">BM</span>, <span class="va">WP</span><span class="op">)</span> <span class="op">~</span> <span class="va">group</span>, data<span class="op">=</span><span class="va">mathscore</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html">Anova</a></span><span class="op">(</span><span class="va">math.mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type II MANOVA Tests: Pillai test statistic</span></span>
<span><span class="co">#&gt;       Df test stat approx F num Df den Df  Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; group  1     0.865     28.9      2      9 0.00012 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What’s wrong with just doing the two <span class="math inline">\(t\)</span>-tests (or equivalent <span class="math inline">\(F\)</span>-test with <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>)?</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html">Anova</a></span><span class="op">(</span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">BM</span> <span class="op">~</span> <span class="va">group</span>, data<span class="op">=</span><span class="va">mathscore</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Anova Table (Type II tests)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: BM</span></span>
<span><span class="co">#&gt;           Sum Sq Df F value Pr(&gt;F)  </span></span>
<span><span class="co">#&gt; group       1302  1    4.24  0.066 .</span></span>
<span><span class="co">#&gt; Residuals   3071 10                 </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html">Anova</a></span><span class="op">(</span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">WP</span> <span class="op">~</span> <span class="va">group</span>, data<span class="op">=</span><span class="va">mathscore</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Anova Table (Type II tests)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: WP</span></span>
<span><span class="co">#&gt;           Sum Sq Df F value Pr(&gt;F)   </span></span>
<span><span class="co">#&gt; group       4408  1    10.4  0.009 **</span></span>
<span><span class="co">#&gt; Residuals   4217 10                  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>From this, we might conclude that the two groups do not differ significantly on Basic Math but strongly differ on Word problems. But the two univariate tests do not take the correlation among the mean differences into account.</p>
<p>To see the differences between the groups on both variables together, we draw their data ellipses, using <code>heplots::covEllpses()</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkgreen"</span>, <span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="http://friendly.github.io/heplots/reference/covEllipses.html">covEllipses</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">BM</span>, <span class="va">WP</span><span class="op">)</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">mathscore</span>,</span>
<span>            pooled<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>            col <span class="op">=</span> <span class="va">colors</span>,</span>
<span>            fill <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>            fill.alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>            cex <span class="op">=</span> <span class="fl">2</span>, cex.lab <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>            asp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>            xlab<span class="op">=</span><span class="st">"Basic math"</span>, ylab<span class="op">=</span><span class="st">"Word problems"</span><span class="op">)</span></span>
<span><span class="co"># plot points</span></span>
<span><span class="va">pch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">mathscore</span><span class="op">$</span><span class="va">group</span><span class="op">==</span><span class="fl">1</span>, <span class="fl">15</span>, <span class="fl">16</span><span class="op">)</span></span>
<span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">mathscore</span><span class="op">$</span><span class="va">group</span><span class="op">==</span><span class="fl">1</span>, <span class="va">colors</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">colors</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">mathscore</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, pch<span class="op">=</span><span class="va">pch</span>, col<span class="op">=</span><span class="va">col</span>, cex<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-mathscore-cov1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/fig-mathscore-cov1-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;6.2: Data ellipses for the <code>mathscore</code> data.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>We can see that:</p>
<ul>
<li>Group 1 &gt; Group 2 on Basic Math, but worse on Word Problems</li>
<li>Group 2 &gt; Group 1 on Word Problems, but worse on Basic Math</li>
<li>Within each group, those who do better on Basic Math also do better on Word Problems</li>
</ul>
<p>A relatively simple interpretation is that the groups don’t really differ in overall math ability, but perhaps the instructor in Group 1 put more focus on basic math skills, while the instructore for Group 2 placed greater emphasis on solving word problems.</p>
<p>In Hotelling’s <span class="math inline">\(T^2\)</span>, the “size” of the difference between the means (labeled “1” and “2”) is assessed relative to the pooled within-group covariance matrix <span class="math inline">\(\mathbf{S}_p\)</span>, which is just a weighted average to the two within-sample matrices, <span class="math inline">\(\mathbf{S}_1\)</span> and <span class="math inline">\(\mathbf{S}_2\)</span>,</p>
<p><span class="math display">\[
\mathbf{S}_p = [ (n_1 - 1) \mathbf{S}_1 + (n_2 - 1) \mathbf{S}_2 ] / (n_1 + n_2 - 2)
\]</span></p>
<p>Visually, imagine sliding the the separate data ellipses to the grand mean, <span class="math inline">\((\bar{x}_{\text{BM}}, \bar{x}_{\text{WP}})\)</span> and finding their combined data ellipse. This is just the data ellipse of the sample of deviations of the scores from their group means, or that of the residuals from the model <code>lm(cbind(BM, WP) ~ group, data=mathscore)</code></p>
<p>To see this, we plot <span class="math inline">\(\mathbf{S}_1\)</span>, <span class="math inline">\(\mathbf{S}_2\)</span> and <span class="math inline">\(\mathbf{S}_p\)</span> together,</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="http://friendly.github.io/heplots/reference/covEllipses.html">covEllipses</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">BM</span>, <span class="va">WP</span><span class="op">)</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">mathscore</span>,</span>
<span>            col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">colors</span>, <span class="st">"red"</span><span class="op">)</span>,</span>
<span>            fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>            fill.alpha <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>            cex <span class="op">=</span> <span class="fl">2</span>, cex.lab <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>            asp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>            xlab<span class="op">=</span><span class="st">"Basic math"</span>, ylab<span class="op">=</span><span class="st">"Word problems"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-mathscore-cov2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/fig-mathscore-cov2-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;6.3: Data ellipses and the pooled covariance matrix <code>mathscore</code> data.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>One of the assumptions of the <span class="math inline">\(T^2\)</span> test (and of MANOVA) is that the within-group variance covariance matrices, <span class="math inline">\(\mathbf{S}_1\)</span> and <span class="math inline">\(\mathbf{S}_2\)</span>, are the same. In <a href="#fig-mathscore-cov2">Figure&nbsp;<span class="quarto-unresolved-ref">fig-mathscore-cov2</span></a>, you can see how the shapes of <span class="math inline">\(\mathbf{S}_1\)</span> and <span class="math inline">\(\mathbf{S}_2\)</span> are very similar, differing in that the variance of word Problems is slightly greater for group 2. In Chapter XX we take of the topic of visualizing tests of this assumption, based on Box’s <span class="math inline">\(M\)</span>-test.</p>
</section></section><section id="he-plot-and-discriminant-axis" class="level2" data-number="6.3"><h2 data-number="6.3" class="anchored" data-anchor-id="he-plot-and-discriminant-axis">
<span class="header-section-number">6.3</span> HE plot and discriminant axis</h2>
<p>As we describe in detail in Chapter XX, all the information relevant to the <span class="math inline">\(T^2\)</span> test and MANOVA can be captured in the remarkably simple <em>Hypothesis Error</em> plot, which shows the relative size of two data ellipses,</p>
<ul>
<li><p><span class="math inline">\(\mathbf{H}\)</span>: the data ellipse of the <em>fitted</em> values, which are just the group means on the two variables, <span class="math inline">\(\bar{\mathbf{x}}\)</span>, corresponding to <span class="math inline">\(\mathbf{Q}_H\)</span> in <a href="#eq-eigen">Equation&nbsp;<span class="quarto-unresolved-ref">eq-eigen</span></a>. In case of <span class="math inline">\(T^2\)</span>, the <span class="math inline">\(\mathbf{H}\)</span> matrix is of rank 1, so the “ellipse” plots as a line.</p></li>
<li><p><span class="math inline">\(\mathbf{E}\)</span>: the data ellipse of the <em>residuals</em>, the deviations of the scores from the group means, <span class="math inline">\(\mathbf{x} - \bar{\mathbf{x}}\)</span>, corresponding to <span class="math inline">\(\mathbf{Q}_E\)</span>.</p></li>
</ul>
<p><code><a href="http://friendly.github.io/heplots/reference/heplot.html">heplots::heplot()</a></code> takes the model object, extracts the <span class="math inline">\(\mathbf{H}\)</span> and <span class="math inline">\(\mathbf{E}\)</span> matrices (from <code>summary(Anova(math.mod))</code>) and plots them. There are many options to control the details.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="http://friendly.github.io/heplots/reference/heplot.html">heplot</a></span><span class="op">(</span><span class="va">math.mod</span>, </span>
<span>       fill<span class="op">=</span><span class="cn">TRUE</span>, lwd <span class="op">=</span> <span class="fl">3</span>,</span>
<span>       asp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>       cex<span class="op">=</span><span class="fl">2</span>, cex.lab<span class="op">=</span><span class="fl">1.8</span>,</span>
<span>       xlab<span class="op">=</span><span class="st">"Basic math"</span>, ylab<span class="op">=</span><span class="st">"Word problems"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-mathscore-HE" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/fig-mathscore-HE-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;6.4: Hypothesis error plot of the <code>mathscore</code> data. The line through the group means is the H ellipse, which plots as a line here. The red ellipse labeled ‘Error’ represents the pooled within-group covariance matrix.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>But the HE plot offers more:</p>
<ul>
<li><p>A visual test of significance: the <span class="math inline">\(\mathbf{H}\)</span> ellipse is scaled so that it projects <em>anywhere</em> outside the <span class="math inline">\(\mathbf{E}\)</span> ellipse, if and only if the test is significant at a given <span class="math inline">\(\alpha\)</span> level (<span class="math inline">\(\alpha = 0.05\)</span> by default)</p></li>
<li><p>The <span class="math inline">\(\mathbf{H}\)</span> ellipse, which appears as a line, goes through the means of the two groups. This is also the <em>discriminant axis</em>, the direction in the space of the variables which maximally discriminates between the groups. That is, if we project the data points onto this line, we get the linear combination <span class="math inline">\(w\)</span> which has the maximum possible univariate <span class="math inline">\(t^2\)</span>.</p></li>
</ul>
<p>You can see how the HE plot relates to the plots of the separate data ellipses by overlaying them in a single figure. We also plot the scores on the discriminant axis, by using this small function to find the projection of a point <code>A</code> on the line joining two points, <code>L1</code> and <code>L2</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">project_on</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">A</span>, <span class="va">L1</span>, <span class="va">L2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span>    <span class="va">L1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">L1</span><span class="op">)</span></span>
<span>    <span class="va">L2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">L2</span><span class="op">)</span></span>
<span>    <span class="va">dot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span> <span class="va">x</span> <span class="op">*</span> <span class="va">y</span><span class="op">)</span>    </span>
<span>    <span class="va">t</span> <span class="op">&lt;-</span> <span class="fu">dot</span><span class="op">(</span><span class="va">L2</span><span class="op">-</span><span class="va">L1</span>, <span class="va">A</span><span class="op">-</span><span class="va">L1</span><span class="op">)</span> <span class="op">/</span> <span class="fu">dot</span><span class="op">(</span><span class="va">L2</span><span class="op">-</span><span class="va">L1</span>, <span class="va">L2</span><span class="op">-</span><span class="va">L1</span><span class="op">)</span></span>
<span>    <span class="va">C</span> <span class="op">&lt;-</span> <span class="va">L1</span> <span class="op">+</span> <span class="va">t</span><span class="op">*</span><span class="op">(</span><span class="va">L2</span><span class="op">-</span><span class="va">L1</span><span class="op">)</span></span>
<span>    <span class="va">C</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="http://friendly.github.io/heplots/reference/covEllipses.html">covEllipses</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">BM</span>, <span class="va">WP</span><span class="op">)</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">mathscore</span>,</span>
<span>            pooled<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>            col <span class="op">=</span> <span class="va">colors</span>,</span>
<span>            cex<span class="op">=</span><span class="fl">2</span>, cex.lab<span class="op">=</span><span class="fl">1.5</span>,</span>
<span>            asp<span class="op">=</span><span class="fl">1</span>, </span>
<span>            xlab<span class="op">=</span><span class="st">"Basic math"</span>, ylab<span class="op">=</span><span class="st">"Word problems"</span></span>
<span>            <span class="op">)</span></span>
<span><span class="va">pch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">mathscore</span><span class="op">$</span><span class="va">group</span><span class="op">==</span><span class="fl">1</span>, <span class="fl">15</span>, <span class="fl">16</span><span class="op">)</span></span>
<span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">mathscore</span><span class="op">$</span><span class="va">group</span><span class="op">==</span><span class="fl">1</span>, <span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">mathscore</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, pch<span class="op">=</span><span class="va">pch</span>, col<span class="op">=</span><span class="va">col</span>, cex<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># overlay with HEplot (add = TRUE)</span></span>
<span><span class="fu"><a href="http://friendly.github.io/heplots/reference/heplot.html">heplot</a></span><span class="op">(</span><span class="va">math.mod</span>, </span>
<span>       fill<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>       cex<span class="op">=</span><span class="fl">2</span>, cex.lab<span class="op">=</span><span class="fl">1.8</span>, </span>
<span>       fill.alpha<span class="op">=</span><span class="fl">0.2</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>         add <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>       error.ellipse<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># find group means</span></span>
<span><span class="va">means</span> <span class="op">&lt;-</span> <span class="va">mathscore</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>BM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">BM</span><span class="op">)</span>, WP <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">WP</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">mathscore</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">gp</span> <span class="op">&lt;-</span> <span class="va">mathscore</span><span class="op">$</span><span class="va">group</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="va">pt</span> <span class="op">&lt;-</span> <span class="fu">project_on</span><span class="op">(</span> <span class="va">mathscore</span><span class="op">[</span><span class="va">i</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="va">means</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="va">means</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span><span class="va">mathscore</span><span class="op">[</span><span class="va">i</span>, <span class="st">"BM"</span><span class="op">]</span>, <span class="va">mathscore</span><span class="op">[</span><span class="va">i</span>, <span class="st">"WP"</span><span class="op">]</span>, <span class="va">pt</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">pt</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-mathscore-HE-overlay" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/fig-mathscore-HE-overlay-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;6.5: HE plot overlaid on top of the within-group data ellipses, with lines showing the projection of each point on the discriminant axis.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="exercises" class="level2" data-number="6.4"><h2 data-number="6.4" class="anchored" data-anchor-id="exercises">
<span class="header-section-number">6.4</span> Exercises</h2>
</section><section id="references" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="references">References</h2>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-R-Hotelling" class="csl-entry" role="doc-biblioentry">
Curran, James, and Taylor Hersh. 2021. <em>Hotelling: Hotelling’s t^2 Test and Variants</em>. <a href="https://CRAN.R-project.org/package=Hotelling">https://CRAN.R-project.org/package=Hotelling</a>.
</div>
<div id="ref-Hotelling:1931" class="csl-entry" role="doc-biblioentry">
Hotelling, Harold. 1931. <span>“The Generalization of <span class="nocase">Student’s</span> Ratio.”</span> <em>The Annals of Mathematical Statistics</em> 2 (3): 360–78. <a href="https://doi.org/10.1214/aoms/1177732979">https://doi.org/10.1214/aoms/1177732979</a>.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./linear_models-plots.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Plots for univariate response models</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./mlm-review.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Brief review of the multivariate linear model</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>