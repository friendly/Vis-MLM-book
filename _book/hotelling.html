<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Visualizing Multivariate Data and Models in R - 8&nbsp; Hotelling’s \(T^2\)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./mlm-viz.html" rel="next">
<link href="./collinearity-ridge.html" rel="prev">
<link href="./images/favicon/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./hotelling.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Hotelling's $T^2$</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Visualizing Multivariate Data and Models in R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/friendly/vis-MLM-quarto" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./getting_started.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Started</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multivariate_plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Plots of Multivariate Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pca-biplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">PCA and Biplots</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Overview of Linear models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear_models-plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Plots for univariate response models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./collinearity-ridge.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Collinearity &amp; Ridge Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hotelling.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Hotelling’s <span class="math inline">\(T^2\)</span></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm-viz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Visualizing Multivariate Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm-review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Brief review of the multivariate linear model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./case-studies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Case studies</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eqcov.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Visualizing Tests for Equality of Covariance Matrices</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#t2-as-a-generalized-t-test" id="toc-t2-as-a-generalized-t-test" class="nav-link active" data-scroll-target="#t2-as-a-generalized-t-test"><span class="header-section-number">8.1</span> <span class="math inline">\(T^2\)</span> as a generalized <span class="math inline">\(t\)</span>-test</a></li>
  <li>
<a href="#t2-properties" id="toc-t2-properties" class="nav-link" data-scroll-target="#t2-properties"><span class="header-section-number">8.2</span> <span class="math inline">\(T^2\)</span> properties</a>
  <ul class="collapse">
<li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  </ul>
</li>
  <li>
<a href="#he-plot-and-discriminant-axis" id="toc-he-plot-and-discriminant-axis" class="nav-link" data-scroll-target="#he-plot-and-discriminant-axis"><span class="header-section-number">8.3</span> HE plot and discriminant axis</a>
  <ul class="collapse">
<li><a href="#heplot" id="toc-heplot" class="nav-link" data-scroll-target="#heplot"><span class="header-section-number">8.3.1</span> <code>heplot()</code></a></li>
  </ul>
</li>
  <li><a href="#discriminant-analysis" id="toc-discriminant-analysis" class="nav-link" data-scroll-target="#discriminant-analysis"><span class="header-section-number">8.4</span> Discriminant analysis</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">8.5</span> Exercises</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-Hotelling" class="quarto-section-identifier"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Hotelling’s <span class="math inline">\(T^2\)</span></span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>Just as the one- and two- sample univariate <span class="math inline">\(t\)</span>-test is the gateway drug for understanding analysis of variance, so too Hotelling’s <span class="math inline">\(T^2\)</span> test provides an entry point to multivariate analysis of variance. This simple case provides an entry point to understanding the collection of methods I call the <strong>HE plot framework</strong> for visualizing effects in multivariate linear models, which are a main focus of this book.</p>
<p>The essential idea is that Hotelling’s <span class="math inline">\(T^2\)</span> provides a test of the difference in means between two groups on a <em>collection</em> of variables, <span class="math inline">\(\mathbf{x} = x_1, x_2, \dots x_p\)</span> <em>simultaneously</em>, rather than one by one. This has the advantages that it:</p>
<ul>
<li>does not require <span class="math inline">\(p\)</span>-value corrections for multiple tests (e.g., Bonferroni);</li>
<li>combines the evidence from the multiple response variables, and <em>pools strength</em>, accumulating support across measures;</li>
<li>clarifies how the multiple response are <em>jointly</em> related to the group effect along a single dimension, the <em>discriminant axis</em>;</li>
<li>in so doing, it reduces the problem of testing differences for two (and potentially more) response variables to testing the difference on a single variable that best captures the multivariable relations.</li>
</ul>
<p>After describing it’s features, I use an example of a two-group <span class="math inline">\(T^2\)</span> test to illustrate the basic ideas behind multivariate tests and hypothesis error plots.</p>
<p><strong>Packages</strong></p>
<p>In this chapter we use the following packages. Load them now.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://friendly.github.io/heplots/">heplots</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jmcurran/Hotelling">Hotelling</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="t2-as-a-generalized-t-test" class="level2" data-number="8.1"><h2 data-number="8.1" class="anchored" data-anchor-id="t2-as-a-generalized-t-test">
<span class="header-section-number">8.1</span> <span class="math inline">\(T^2\)</span> as a generalized <span class="math inline">\(t\)</span>-test</h2>
<p>Hotelling’s <span class="math inline">\(T^2\)</span> <span class="citation" data-cites="Hotelling:1931">(<a href="references.html#ref-Hotelling:1931" role="doc-biblioref">Hotelling 1931</a>)</span> is an analog the square of a univariate <span class="math inline">\(t\)</span> statistic, extended to the Consider the basic one-sample <span class="math inline">\(t\)</span>-test, where we wish to test the hypothesis that the mean <span class="math inline">\(\bar{x}\)</span> of a set of <span class="math inline">\(N\)</span> measures on a test of basic math, with standard deviation <span class="math inline">\(s\)</span> does not differ from an assumed mean <span class="math inline">\(\mu_0 = 150\)</span> for a population. The <span class="math inline">\(t\)</span> statistic for testing <span class="math inline">\(H_0 : \mu = \mu_0\)</span> against the two-sided alternative, <span class="math inline">\(H_0 : \mu \ne \mu_0\)</span> is <span class="math display">\[
t = \frac{(\bar{x} - \mu_0)}{s / \sqrt{N}} = \frac{(\bar{x} - \mu_0)\sqrt{N}}{s}
\]</span></p>
<p>Squaring this gives</p>
<p><span class="math display">\[
t^2 = \frac{N (\bar{x} - \mu_0)^2}{s} = N (\bar{x} - \mu_0)(s^2)^{-1} (\bar{x} - \mu_0)
\]</span></p>
<p>Now consider we also have measures on a test of solving word problems for the same sample. Then, a hypothesis test for the means on basic math (BM) and word problems (WP) is the test of the means of these two variables jointly equal their separate values, say, <span class="math inline">\((150, 100)\)</span>.</p>
<p><span class="math display">\[
H_0 : \mathbf{\mu} = \mathbf{\mu_0} =
  \begin{pmatrix}
    \mu_{0,BM} \\ \mu_{0,WP}
  \end{pmatrix}
  =
  \begin{pmatrix}
    150 \\ 100
  \end{pmatrix}
\]</span></p>
<!-- ![](equations/eqn-mathscore1.png){width=50% fig-align="center"} -->
<p>Hotelling’s <span class="math inline">\(T^2\)</span> is then the analog of <span class="math inline">\(t^2\)</span>, with the variance-covariance matrix <span class="math inline">\(\mathbf{S}\)</span> of the scores on (BM, WP) replacing the variance of a single score. This is nothing more than the squared Mahalanobis distance between the sample mean vector <span class="math inline">\((\bar{x}_{BM}, \bar{x}_{WP})^T\)</span> and the hypothesized means <span class="math inline">\(\mathbf{\mu}_0\)</span>, in the metric of <span class="math inline">\(\mathbf{S}\)</span>, as shown in <a href="#fig-T2-diagram">Figure&nbsp;<span>8.1</span></a>.</p>
<p><span class="math display">\[\begin{align*}
T^2 &amp;= N (\bar{\mathbf{x}} - \mathbf{\mu}_0)^T \; \mathbf{S}^{-1} \; (\bar{\mathbf{x}} - \mathbf{\mu}_0) \\
    &amp;= N D^2_M (\bar{\mathbf{x}}, \mathbf{\mu}_0)
\end{align*}\]</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-T2-diagram" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/T2-diagram.png" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;8.1: Hotelling’s T^2 statistic as the squared distance between the sample means and hypothesized means relative to the variance-covariance matrix. <em>Source</em>: Author</figcaption></figure>
</div>
</div>
</div>
</section><section id="t2-properties" class="level2" data-number="8.2"><h2 data-number="8.2" class="anchored" data-anchor-id="t2-properties">
<span class="header-section-number">8.2</span> <span class="math inline">\(T^2\)</span> properties</h2>
<p>Aside from it’s elegant geometric interpretation Hotelling’s <span class="math inline">\(T^2\)</span> has simple properties that aid in understanding the extension to more complex multivariate tests.</p>
<ul>
<li><p><strong>Maximum <span class="math inline">\(t^2\)</span></strong> : Consider constructing a new variable <span class="math inline">\(w\)</span> as a linear combination of the scores in a matrix <span class="math inline">\(\mathbf{X} = [ \mathbf{x_1}, \mathbf{x_2}, \dots, \mathbf{x_p}]\)</span> with weights <span class="math inline">\(\mathbf{a}\)</span>, <span class="math display">\[
w = a_1 \mathbf{x_1} + a_2 \mathbf{x_2} + \dots + a_p \mathbf{x_p} = \mathbf{X} \mathbf{a}
\]</span> Hotelling’s <span class="math inline">\(T^2\)</span> is then the maximum value of a univariate <span class="math inline">\(t^2 (\mathbf{a})\)</span> over all possible choices of the weights in <span class="math inline">\(\mathbf{a}\)</span>. In this way, Hotellings test reduces a multivariate problem to a univariate one.</p></li>
<li><p><strong>Eigenvalue</strong> : Hotelling showed that <span class="math inline">\(T^2\)</span> is the one non-zero eigenvalue (latent root) <span class="math inline">\(\lambda\)</span> of the matrix <span class="math inline">\(\mathbf{Q}_H = N (\bar{\mathbf{x}} - \mathbf{\mu}_0)^T (\bar{\mathbf{x}} - \mathbf{\mu}_0)\)</span> relative to <span class="math inline">\(\mathbf{Q}_E = \mathbf{S}\)</span> that solves the equation <span id="eq-eigen"><span class="math display">\[
(\mathbf{Q}_H - \lambda \mathbf{Q}_E) \mathbf{a} = 0
\tag{8.1}\]</span></span> In more complex MANOVA problems, there are more than one non-zero latent roots, <span class="math inline">\(\lambda_1, \lambda_2, \dots \lambda_s\)</span>, and test statistics are functions of these.</p></li>
<li><p><strong>Eigenvector</strong> : The corresponding eigenvector is <span class="math inline">\(\mathbf{a} = \mathbf{S}^{-1} (\bar{\mathbf{x}} - \mathbf{\mu}_0)\)</span>. These are the (raw) <em>discriminant coefficients</em>, giving the relative contribution of each variable to <span class="math inline">\(T^2\)</span>.</p></li>
<li><p><strong>Critical values</strong> : For a single response, the square of a <span class="math inline">\(t\)</span> statistic with <span class="math inline">\(N-1\)</span> degrees of freedom is an <span class="math inline">\(F (1, N-1)\)</span> statistic. But we chose <span class="math inline">\(\mathbf{a}\)</span> to give the <em>maximum</em> <span class="math inline">\(t^2 (\mathbf{a})\)</span>; this can be taken into account with a transformation of <span class="math inline">\(T^2\)</span> to give an <strong>exact</strong> <span class="math inline">\(F\)</span> test with the correct sampling distribution: <span id="eq-Fstat"><span class="math display">\[
F^* = \frac{N - p}{p (N-1)} T^2 \; \sim \; F (p, N - p)
\tag{8.2}\]</span></span></p></li>
<li><p><strong>Invariance under linear transformation</strong> : Just as a univariate <span class="math inline">\(t\)</span>-test is unchanged if we apply a linear transformation to the variable, <span class="math inline">\(x \rightarrow a x + b\)</span>, <span class="math inline">\(T^2\)</span> is invariant under all linear (<em>affine</em>) transformations, <span class="math display">\[
\mathbf{x}_{p \times 1} \rightarrow \mathbf{C}_{p \times p} \mathbf{x} + \mathbf{b}
\]</span> So, you get the same results if you convert penguins flipper lengths from millimeters to centimeters or inches. The same is true for all MANOVA tests.</p></li>
<li><p><strong>Two-sample tests</strong> : With minor variations in notation, everything above applies to the more usual test of equality of multivariate means in a two sample test of <span class="math inline">\(H_0 : \mathbf{\mu}_1 = \mathbf{\mu}_2\)</span>. <span class="math display">\[
T^2 = N (\bar{\mathbf{x}}_1 - \bar{\mathbf{x}}_2)^T \; \mathbf{S}_p^{-1} \; (\bar{\mathbf{x}}_1 - \bar{\mathbf{x}}_2)
\]</span> where <span class="math inline">\(\mathbf{S}_p\)</span> is the pooled within-sample variance covariance matrix.</p></li>
</ul>
<section id="example" class="level3 unnumbered"><h3 class="unnumbered anchored" data-anchor-id="example">Example</h3>
<p>The data set <code><a href="https://friendly.github.io/heplots/reference/mathscore.html">heplots::mathscore</a></code> gives (fictitious) scores on a test of basic math skills (BM) and solving word problems (WP) for two groups of <span class="math inline">\(N=6\)</span> students in an algebra course, each taught by different instructors.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">mathscore</span>, package <span class="op">=</span> <span class="st">"heplots"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">mathscore</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    12 obs. of  3 variables:</span></span>
<span><span class="co">#&gt;  $ group: Factor w/ 2 levels "1","2": 1 1 1 1 1 1 2 2 2 2 ...</span></span>
<span><span class="co">#&gt;  $ BM   : int  190 170 180 200 150 180 160 190 150 160 ...</span></span>
<span><span class="co">#&gt;  $ WP   : int  90 80 80 120 60 70 120 150 90 130 ...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can carry out the test that the means for both variables are jointly equal using either <code><a href="https://rdrr.io/pkg/Hotelling/man/hotelling.test.html">Hotelling::hotelling.test()</a></code> <span class="citation" data-cites="R-Hotelling">(<a href="references.html#ref-R-Hotelling" role="doc-biblioref">Curran and Hersh 2021</a>)</span> or <code><a href="https://rdrr.io/pkg/car/man/Anova.html">car::Anova()</a></code>,</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/Hotelling/man/hotelling.test.html">hotelling.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">BM</span>, <span class="va">WP</span><span class="op">)</span> <span class="op">~</span> <span class="va">group</span>, data<span class="op">=</span><span class="va">mathscore</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Test stat:  64.174 </span></span>
<span><span class="co">#&gt; Numerator df:  2 </span></span>
<span><span class="co">#&gt; Denominator df:  9 </span></span>
<span><span class="co">#&gt; P-value:  0.0001213</span></span>
<span></span>
<span><span class="va">math.mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">BM</span>, <span class="va">WP</span><span class="op">)</span> <span class="op">~</span> <span class="va">group</span>, data<span class="op">=</span><span class="va">mathscore</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html">Anova</a></span><span class="op">(</span><span class="va">math.mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type II MANOVA Tests: Pillai test statistic</span></span>
<span><span class="co">#&gt;       Df test stat approx F num Df den Df  Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; group  1     0.865     28.9      2      9 0.00012 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What’s wrong with just doing the two <span class="math inline">\(t\)</span>-tests (or equivalent <span class="math inline">\(F\)</span>-test with <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>)?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html">Anova</a></span><span class="op">(</span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">BM</span> <span class="op">~</span> <span class="va">group</span>, data<span class="op">=</span><span class="va">mathscore</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Anova Table (Type II tests)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: BM</span></span>
<span><span class="co">#&gt;           Sum Sq Df F value Pr(&gt;F)  </span></span>
<span><span class="co">#&gt; group       1302  1    4.24  0.066 .</span></span>
<span><span class="co">#&gt; Residuals   3071 10                 </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html">Anova</a></span><span class="op">(</span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">WP</span> <span class="op">~</span> <span class="va">group</span>, data<span class="op">=</span><span class="va">mathscore</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Anova Table (Type II tests)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: WP</span></span>
<span><span class="co">#&gt;           Sum Sq Df F value Pr(&gt;F)   </span></span>
<span><span class="co">#&gt; group       4408  1    10.4  0.009 **</span></span>
<span><span class="co">#&gt; Residuals   4217 10                  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>From this, we might conclude that the two groups do <em>not</em> differ significantly on Basic Math but strongly differ on Word problems. But the two univariate tests do not take the correlation among the mean differences into account.</p>
<p>To see the differences between the groups on both variables together, we draw their data (68%) ellipses, using <code>heplots::covEllpses()</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkgreen"</span>, <span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://friendly.github.io/heplots/reference/covEllipses.html">covEllipses</a></span><span class="op">(</span><span class="va">mathscore</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BM"</span>, <span class="st">"WP"</span><span class="op">)</span><span class="op">]</span>, <span class="va">mathscore</span><span class="op">$</span><span class="va">group</span>,</span>
<span>            pooled<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>            col <span class="op">=</span> <span class="va">colors</span>,</span>
<span>            fill <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>            fill.alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>            cex <span class="op">=</span> <span class="fl">2</span>, cex.lab <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>            asp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>            xlab<span class="op">=</span><span class="st">"Basic math"</span>, ylab<span class="op">=</span><span class="st">"Word problems"</span><span class="op">)</span></span>
<span><span class="co"># plot points</span></span>
<span><span class="va">pch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">mathscore</span><span class="op">$</span><span class="va">group</span><span class="op">==</span><span class="fl">1</span>, <span class="fl">15</span>, <span class="fl">16</span><span class="op">)</span></span>
<span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">mathscore</span><span class="op">$</span><span class="va">group</span><span class="op">==</span><span class="fl">1</span>, <span class="va">colors</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">colors</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">mathscore</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, pch<span class="op">=</span><span class="va">pch</span>, col<span class="op">=</span><span class="va">col</span>, cex<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-mathscore-cov1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/fig-mathscore-cov1-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;8.2: Data ellipses for the <code>mathscore</code> data, enclosing approximately 68% of the observations in each group</figcaption></figure>
</div>
</div>
</div>
<p>We can see that:</p>
<ul>
<li>Group 1 &gt; Group 2 on Basic Math, but worse on Word Problems</li>
<li>Group 2 &gt; Group 1 on Word Problems, but worse on Basic Math</li>
<li>Within each group, those who do better on Basic Math also do better on Word Problems</li>
</ul>
<p>We can also see why the univariate test, at least for Basic math is non-significant: the scores for the two groups overlap considerably on the horizontal axis. They are slightly better separated along the vertical axis for word problems. The plot also reveals why Hotelling’s <span class="math inline">\(T^2\)</span> reveals such a strongly significant result: the two groups are very widely separated along an approximately 45<span class="math inline">\(^o\)</span> line between them.</p>
<p>A relatively simple interpretation is that the groups don’t really differ in overall math ability, but perhaps the instructor in Group 1 put more focus on basic math skills, while the instructor for Group 2 placed greater emphasis on solving word problems.</p>
<p>In Hotelling’s <span class="math inline">\(T^2\)</span>, the “size” of the difference between the means (labeled “1” and “2”) is assessed relative to the pooled within-group covariance matrix <span class="math inline">\(\mathbf{S}_p\)</span>, which is just a size-weighted average of the two within-sample matrices, <span class="math inline">\(\mathbf{S}_1\)</span> and <span class="math inline">\(\mathbf{S}_2\)</span>,</p>
<p><span class="math display">\[
\mathbf{S}_p = [ (n_1 - 1) \mathbf{S}_1 + (n_2 - 1) \mathbf{S}_2 ] / (n_1 + n_2 - 2)
\]</span></p>
<p>Visually, imagine sliding the the separate data ellipses to the grand mean, <span class="math inline">\((\bar{x}_{\text{BM}}, \bar{x}_{\text{WP}})\)</span> and finding their combined data ellipse. This is just the data ellipse of the sample of deviations of the scores from their group means, or that of the residuals from the model <code>lm(cbind(BM, WP) ~ group, data=mathscore)</code></p>
<p>To see this, we plot <span class="math inline">\(\mathbf{S}_1\)</span>, <span class="math inline">\(\mathbf{S}_2\)</span> and <span class="math inline">\(\mathbf{S}_p\)</span> together,</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://friendly.github.io/heplots/reference/covEllipses.html">covEllipses</a></span><span class="op">(</span><span class="va">mathscore</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BM"</span>, <span class="st">"WP"</span><span class="op">)</span><span class="op">]</span>, <span class="va">mathscore</span><span class="op">$</span><span class="va">group</span>,</span>
<span>            col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">colors</span>, <span class="st">"red"</span><span class="op">)</span>,</span>
<span>            fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>            fill.alpha <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>            cex <span class="op">=</span> <span class="fl">2</span>, cex.lab <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>            asp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>            xlab<span class="op">=</span><span class="st">"Basic math"</span>, ylab<span class="op">=</span><span class="st">"Word problems"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-mathscore-cov2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/fig-mathscore-cov2-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;8.3: Data ellipses and the pooled covariance matrix <code>mathscore</code> data.</figcaption></figure>
</div>
</div>
</div>
<p>One of the assumptions of the <span class="math inline">\(T^2\)</span> test (and of MANOVA) is that the within-group variance covariance matrices, <span class="math inline">\(\mathbf{S}_1\)</span> and <span class="math inline">\(\mathbf{S}_2\)</span>, are the same. In <a href="#fig-mathscore-cov2">Figure&nbsp;<span>8.3</span></a>, you can see how the shapes of <span class="math inline">\(\mathbf{S}_1\)</span> and <span class="math inline">\(\mathbf{S}_2\)</span> are very similar, differing in that the variance of word Problems is slightly greater for group 2. In Chapter XX we take of the topic of visualizing tests of this assumption, based on Box’s <span class="math inline">\(M\)</span>-test.</p>
</section></section><section id="he-plot-and-discriminant-axis" class="level2" data-number="8.3"><h2 data-number="8.3" class="anchored" data-anchor-id="he-plot-and-discriminant-axis">
<span class="header-section-number">8.3</span> HE plot and discriminant axis</h2>
<p>As we describe in detail in Chapter XX, all the information relevant to the <span class="math inline">\(T^2\)</span> test and MANOVA can be captured in the remarkably simple <em>Hypothesis Error</em> plot, which shows the relative size of two data ellipses,</p>
<ul>
<li>
<span class="math inline">\(\mathbf{H}\)</span>: the data ellipse of the <em>fitted</em> values, which are just the group means on the two variables, <span class="math inline">\(\bar{\mathbf{x}}\)</span>, corresponding to <span class="math inline">\(\mathbf{Q}_H\)</span> in <a href="#eq-eigen">Equation&nbsp;<span>8.1</span></a>. In case of <span class="math inline">\(T^2\)</span>, the <span class="math inline">\(\mathbf{H}\)</span> matrix is of rank 1, so the “ellipse” plots as a line.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># calculate H directly</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">math.mod</span><span class="op">)</span></span>
<span><span class="va">xbar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span><span class="op">(</span><span class="va">mathscore</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">mathscore</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/crossprod.html">crossprod</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op">-</span> <span class="va">N</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html">outer</a></span><span class="op">(</span><span class="va">xbar</span>, <span class="va">xbar</span><span class="op">)</span></span>
<span><span class="co">#&gt;       BM    WP</span></span>
<span><span class="co">#&gt; BM  1302 -2396</span></span>
<span><span class="co">#&gt; WP -2396  4408</span></span>
<span></span>
<span><span class="co"># same as: SSP for group effect from Anova</span></span>
<span><span class="va">math.aov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html">Anova</a></span><span class="op">(</span><span class="va">math.mod</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">H</span> <span class="op">&lt;-</span> <span class="va">math.aov</span><span class="op">$</span><span class="va">SSP</span><span class="op">)</span></span>
<span><span class="co">#&gt; $group</span></span>
<span><span class="co">#&gt;       BM    WP</span></span>
<span><span class="co">#&gt; BM  1302 -2396</span></span>
<span><span class="co">#&gt; WP -2396  4408</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>
<span class="math inline">\(\mathbf{E}\)</span>: the data ellipse of the <em>residuals</em>, the deviations of the scores from the group means, <span class="math inline">\(\mathbf{x} - \bar{\mathbf{x}}\)</span>, corresponding to <span class="math inline">\(\mathbf{Q}_E\)</span>.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># calculate E directly</span></span>
<span><span class="va">resids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">math.mod</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/crossprod.html">crossprod</a></span><span class="op">(</span><span class="va">resids</span><span class="op">)</span></span>
<span><span class="co">#&gt;      BM   WP</span></span>
<span><span class="co">#&gt; BM 3071 2808</span></span>
<span><span class="co">#&gt; WP 2808 4217</span></span>
<span></span>
<span><span class="co"># same as: SSPE from Anova</span></span>
<span><span class="op">(</span><span class="va">E</span> <span class="op">&lt;-</span> <span class="va">math.aov</span><span class="op">$</span><span class="va">SSPE</span><span class="op">)</span></span>
<span><span class="co">#&gt;      BM   WP</span></span>
<span><span class="co">#&gt; BM 3071 2808</span></span>
<span><span class="co">#&gt; WP 2808 4217</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="heplot" class="level3" data-number="8.3.1"><h3 data-number="8.3.1" class="anchored" data-anchor-id="heplot">
<span class="header-section-number">8.3.1</span> <code>heplot()</code>
</h3>
<p><code><a href="https://friendly.github.io/heplots/reference/heplot.html">heplots::heplot()</a></code> takes the model object, extracts the <span class="math inline">\(\mathbf{H}\)</span> and <span class="math inline">\(\mathbf{E}\)</span> matrices (from <code>summary(Anova(math.mod))</code>) and plots them. There are many options to control the details.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://friendly.github.io/heplots/reference/heplot.html">heplot</a></span><span class="op">(</span><span class="va">math.mod</span>, </span>
<span>       fill<span class="op">=</span><span class="cn">TRUE</span>, lwd <span class="op">=</span> <span class="fl">3</span>,</span>
<span>       asp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>       cex<span class="op">=</span><span class="fl">2</span>, cex.lab<span class="op">=</span><span class="fl">1.8</span>,</span>
<span>       xlab<span class="op">=</span><span class="st">"Basic math"</span>, ylab<span class="op">=</span><span class="st">"Word problems"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-mathscore-HE" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/fig-mathscore-HE-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;8.4: Hypothesis error plot of the <code>mathscore</code> data. The line through the group means is the H ellipse, which plots as a line here. The red ellipse labeled ‘Error’ represents the pooled within-group covariance matrix.</figcaption></figure>
</div>
</div>
</div>
<p>But the HE plot offers more:</p>
<ul>
<li><p>A visual test of significance: the <span class="math inline">\(\mathbf{H}\)</span> ellipse is scaled so that it projects <em>anywhere</em> outside the <span class="math inline">\(\mathbf{E}\)</span> ellipse, if and only if the test is significant at a given <span class="math inline">\(\alpha\)</span> level (<span class="math inline">\(\alpha = 0.05\)</span> by default)</p></li>
<li><p>The <span class="math inline">\(\mathbf{H}\)</span> ellipse, which appears as a line, goes through the means of the two groups. This is also the <em>discriminant axis</em>, the direction in the space of the variables which maximally discriminates between the groups. That is, if we project the data points onto this line, we get the linear combination <span class="math inline">\(w\)</span> which has the maximum possible univariate <span class="math inline">\(t^2\)</span>.</p></li>
</ul>
<p>You can see how the HE plot relates to the plots of the separate data ellipses by overlaying them in a single figure. We also plot the scores on the discriminant axis, by using this small function to find the orthogonal projection of a point <span class="math inline">\(\mathbf{a}\)</span> on the line joining two points, <span class="math inline">\(\mathbf{p}_1\)</span> and <span class="math inline">\(\mathbf{p}_2\)</span>, which in math is <span class="math inline">\(\mathbf{p}_1 + \frac{\mathbf{d}^T (\mathbf{a} - \mathbf{p}_1)} {\mathbf{d}^T \mathbf{d}}\)</span>, letting <span class="math inline">\(\mathbf{d} = \mathbf{p}_1 - \mathbf{p}_2\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">*</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="va">project_on</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span>, <span class="va">p1</span>, <span class="va">p2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span>
<span>    <span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></span>
<span>    <span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></span>
<span>    <span class="va">dot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span> <span class="va">x</span> <span class="op">*</span> <span class="va">y</span><span class="op">)</span>    </span>
<span>    <span class="va">t</span> <span class="op">&lt;-</span> <span class="fu">dot</span><span class="op">(</span><span class="va">p2</span><span class="op">-</span><span class="va">p1</span>, <span class="va">a</span><span class="op">-</span><span class="va">p1</span><span class="op">)</span> <span class="op">/</span> <span class="fu">dot</span><span class="op">(</span><span class="va">p2</span><span class="op">-</span><span class="va">p1</span>, <span class="va">p2</span><span class="op">-</span><span class="va">p1</span><span class="op">)</span></span>
<span>    <span class="va">C</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">+</span> <span class="va">t</span><span class="op">*</span><span class="op">(</span><span class="va">p2</span><span class="op">-</span><span class="va">p1</span><span class="op">)</span></span>
<span>    <span class="va">C</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, we run the same code as before to plot the data ellipses, and follow this with a call to <code><a href="https://friendly.github.io/heplots/reference/heplot.html">heplot()</a></code> using the option <code>add=TRUE</code> which adds to an existing plot. Following this, we find the group means and draw lines projecting the points on the line between them.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://friendly.github.io/heplots/reference/covEllipses.html">covEllipses</a></span><span class="op">(</span><span class="va">mathscore</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BM"</span>, <span class="st">"WP"</span><span class="op">)</span><span class="op">]</span>, <span class="va">mathscore</span><span class="op">$</span><span class="va">group</span>,</span>
<span>            pooled<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>            col <span class="op">=</span> <span class="va">colors</span>,</span>
<span>            cex<span class="op">=</span><span class="fl">2</span>, cex.lab<span class="op">=</span><span class="fl">1.5</span>,</span>
<span>            asp<span class="op">=</span><span class="fl">1</span>, </span>
<span>            xlab<span class="op">=</span><span class="st">"Basic math"</span>, ylab<span class="op">=</span><span class="st">"Word problems"</span></span>
<span>            <span class="op">)</span></span>
<span><span class="va">pch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">mathscore</span><span class="op">$</span><span class="va">group</span><span class="op">==</span><span class="fl">1</span>, <span class="fl">15</span>, <span class="fl">16</span><span class="op">)</span></span>
<span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">mathscore</span><span class="op">$</span><span class="va">group</span><span class="op">==</span><span class="fl">1</span>, <span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">mathscore</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, pch<span class="op">=</span><span class="va">pch</span>, col<span class="op">=</span><span class="va">col</span>, cex<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># overlay with HEplot (add = TRUE)</span></span>
<span><span class="fu"><a href="https://friendly.github.io/heplots/reference/heplot.html">heplot</a></span><span class="op">(</span><span class="va">math.mod</span>, </span>
<span>       fill<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>       cex<span class="op">=</span><span class="fl">2</span>, cex.lab<span class="op">=</span><span class="fl">1.8</span>, </span>
<span>       fill.alpha<span class="op">=</span><span class="fl">0.2</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>       add <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>       error.ellipse<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># find group means</span></span>
<span><span class="va">means</span> <span class="op">&lt;-</span> <span class="va">mathscore</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>BM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">BM</span><span class="op">)</span>, WP <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">WP</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">mathscore</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">gp</span> <span class="op">&lt;-</span> <span class="va">mathscore</span><span class="op">$</span><span class="va">group</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="va">pt</span> <span class="op">&lt;-</span> <span class="fu">project_on</span><span class="op">(</span> <span class="va">mathscore</span><span class="op">[</span><span class="va">i</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="va">means</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="va">means</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span><span class="va">mathscore</span><span class="op">[</span><span class="va">i</span>, <span class="st">"BM"</span><span class="op">]</span>, <span class="va">mathscore</span><span class="op">[</span><span class="va">i</span>, <span class="st">"WP"</span><span class="op">]</span>, <span class="va">pt</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">pt</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, lwd <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-mathscore-HE-overlay" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/fig-mathscore-HE-overlay-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;8.5: HE plot overlaid on top of the within-group data ellipses, with lines showing the projection of each point on the discriminant axis.</figcaption></figure>
</div>
</div>
</div>
</section></section><section id="discriminant-analysis" class="level2" data-number="8.4"><h2 data-number="8.4" class="anchored" data-anchor-id="discriminant-analysis">
<span class="header-section-number">8.4</span> Discriminant analysis</h2>
<p>Discriminant analysis for two-group designs or for one-way MANOVA essentially turns the problem around: Instead of asking whether the mean vectors for two or more groups are equal, discriminant analysis tries to find the linear combination <span class="math inline">\(w\)</span> of the response variables that has the greatest separation among the groups, allowing cases to be best classified. It was developed by <span class="citation" data-cites="Fisher:1936">Fisher (<a href="references.html#ref-Fisher:1936" role="doc-biblioref">1936</a>)</span> as a solution to the biological taxonomy problem of developing a rule to classify instances of flowers—in his famous case, Iris flowers—into known species (<em>I. setosa</em>, <em>I. versicolor</em>, <em>I. virginica</em>) on the basis of multiple measurements (length and width of their sepals and petals).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">math.lda</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/lda.html">lda</a></span><span class="op">(</span><span class="va">group</span> <span class="op">~</span> <span class="va">.</span>, data<span class="op">=</span><span class="va">mathscore</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lda(group ~ ., data = mathscore)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Prior probabilities of groups:</span></span>
<span><span class="co">#&gt;   1   2 </span></span>
<span><span class="co">#&gt; 0.5 0.5 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Group means:</span></span>
<span><span class="co">#&gt;    BM    WP</span></span>
<span><span class="co">#&gt; 1 178  83.3</span></span>
<span><span class="co">#&gt; 2 158 121.7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients of linear discriminants:</span></span>
<span><span class="co">#&gt;        LD1</span></span>
<span><span class="co">#&gt; BM -0.0835</span></span>
<span><span class="co">#&gt; WP  0.0753</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The coefficients give <span class="math inline">\(w = -0.84 \text{BM} + 0.75 \text{WP}\)</span>. This is exactly the direction given by the line for the <span class="math inline">\(\mathbf{H}\)</span> ellipse in <a href="#fig-mathscore-HE-overlay">Figure&nbsp;<span>8.5</span></a>.</p>
<p>To round this out, we can calculate the discriminant scores by multiplying the matrix <span class="math inline">\(\mathbf{X}\)</span> by the vector <span class="math inline">\(\mathbf{a} = \mathbf{S}^{-1} (\bar{\mathbf{x}}_1 - \bar{\mathbf{x}}_2)\)</span> of the discriminant weights.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">math.lda</span><span class="op">$</span><span class="va">scaling</span></span>
<span><span class="co">#&gt;        LD1</span></span>
<span><span class="co">#&gt; BM -0.0835</span></span>
<span><span class="co">#&gt; WP  0.0753</span></span>
<span></span>
<span><span class="va">scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">mathscore</span><span class="op">$</span><span class="va">group</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">mathscore</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">math.lda</span><span class="op">$</span><span class="va">scaling</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">scores</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span><span class="co">#&gt; # Groups:   group [2]</span></span>
<span><span class="co">#&gt;   group   LD1</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1     1 -9.09</span></span>
<span><span class="co">#&gt; 2     1 -8.17</span></span>
<span><span class="co">#&gt; 3     1 -9.01</span></span>
<span><span class="co">#&gt; 4     2 -4.33</span></span>
<span><span class="co">#&gt; 5     2 -4.58</span></span>
<span><span class="co">#&gt; 6     2 -5.75</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then a <span class="math inline">\(t\)</span>-test on these scores gives Hotelling’s <span class="math inline">\(T\)</span>, accessed via the <code>statistic</code> component of <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">LD1</span> <span class="op">~</span> <span class="va">group</span>, data<span class="op">=</span><span class="va">scores</span><span class="op">)</span><span class="op">$</span><span class="va">statistic</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">t</span>, T2 <span class="op">=</span><span class="va">t</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;     t  T2.t </span></span>
<span><span class="co">#&gt; -8.01 64.17</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, it is instructive to compare violin plots for the three measures, <code>BM</code>, <code>WP</code> and <code>LD1</code>. To do this with <code>ggplot2</code> requires reshaping the data from wide to long format so the plots can be faceted.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">scores</span> <span class="op">&lt;-</span> <span class="va">mathscore</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span>LD1 <span class="op">=</span> <span class="va">scores</span><span class="op">[</span>, <span class="st">"LD1"</span><span class="op">]</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">scores</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="st">"measure"</span>, value <span class="op">=</span><span class="st">"Score"</span>, <span class="va">BM</span><span class="op">:</span><span class="va">LD1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>measure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">measure</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BM"</span>, <span class="st">"WP"</span>, <span class="st">"LD1"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">Score</span>, color <span class="op">=</span> <span class="va">group</span>, fill <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.2</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">measure</span>, scales <span class="op">=</span> <span class="st">"free"</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkgreen"</span>, <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkgreen"</span>, <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-mathscore-violins" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/fig-mathscore-violins-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;8.6: Violin plots comparing group 1 and 2 for the two observed measures and the linear discriminant score.</figcaption></figure>
</div>
</div>
</div>
<p>You can readily see how well the groups are separated on the discriminant axes, relative to the two individual variables.</p>
<!-- ## Canonical analysis  -->
</section><section id="exercises" class="level2" data-number="8.5"><h2 data-number="8.5" class="anchored" data-anchor-id="exercises">
<span class="header-section-number">8.5</span> Exercises</h2>
<ol type="1">
<li>The value of Hotelling’s <span class="math inline">\(T^2\)</span> found by <code><a href="https://rdrr.io/pkg/Hotelling/man/hotelling.test.html">hotelling.test()</a></code> is 64.17. The value of the equivalent <span class="math inline">\(F\)</span> statistic found by <code><a href="https://rdrr.io/pkg/car/man/Anova.html">Anova()</a></code> is 28.9. Verify that <a href="#eq-Fstat">Equation&nbsp;<span>8.2</span></a> gives this result.</li>
</ol>
<div class="cell" data-layout-align="center">
<pre><code>#&gt; Writing packages to  C:/R/Projects/Vis-MLM-quarto/bib/pkgs.txt
#&gt; 16  packages used here:
#&gt;  base, broom, car, carData, corpcor, datasets, dplyr, ggplot2, graphics, grDevices, heplots, Hotelling, methods, stats, tidyr, utils</code></pre>
</div>
</section><section id="references" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="references">References</h2>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-R-Hotelling" class="csl-entry" role="listitem">
Curran, James, and Taylor Hersh. 2021. <em>Hotelling: Hotelling’s t^2 Test and Variants</em>. <a href="https://CRAN.R-project.org/package=Hotelling">https://CRAN.R-project.org/package=Hotelling</a>.
</div>
<div id="ref-Fisher:1936" class="csl-entry" role="listitem">
Fisher, R. A. 1936. <span>“The Use of Multiple Measurements in Taxonomic Problems.”</span> <em>Annals of Eugenics</em> 7 (2): 179–88. <a href="https://doi.org/10.1111/j.1469-1809.1936.tb02137.x">https://doi.org/10.1111/j.1469-1809.1936.tb02137.x</a>.
</div>
<div id="ref-Hotelling:1931" class="csl-entry" role="listitem">
Hotelling, Harold. 1931. <span>“The Generalization of <span class="nocase">Student’s</span> Ratio.”</span> <em>The Annals of Mathematical Statistics</em> 2 (3): 360–78. <a href="https://doi.org/10.1214/aoms/1177732979">https://doi.org/10.1214/aoms/1177732979</a>.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./collinearity-ridge.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Collinearity &amp; Ridge Regression</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./mlm-viz.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Visualizing Multivariate Models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>